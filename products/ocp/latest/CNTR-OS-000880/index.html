<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="x-ua-compatible" content="ie=edge"/>
  <title>CNTR-OS-000880 - V1R1 - STIG-A-View</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Online STIG viewer"/>
  <meta name="generator" content="STIG-A-View Static - 594a585"/>
  <link href="/static/css/style.css" rel="stylesheet" />
  <link href="/favicon.png" rel="shortcut icon" />
</head>
<body>
<nav class="navbar">
  <a class="navbar-brand" href="/">STIG-A-View</a>
  <ul>
    <li><a href="/">Home</a></li>
    <li><a class="nav-link" href="/stigs">STIGs</a></li>
    <li><a class="nav-link" href="/products">Products</a></li>
  </ul>
</nav>
<div class="container">

  <h2>OpenShift must remove old components after updated versions have been installed.</h2>
  <p>
  <b>STIG ID:</b> CNTR-OS-000880 &nbsp;|&nbsp;
  <b>SRG: </b><a href="/srgs/SRG-APP-000454-CTR-001110">SRG-APP-000454-CTR-001110</a> |
  <b>Severity: </b>medium&nbsp;|&nbsp;
  <b>CCI: </b>CCI-002617
  </p>
  <div class="container-fluid">
   <div class="row">
     <div class="span1">
       <h3>Vulnerability Discussion</h3>
       Previous versions of OpenShift components that are not removed from the container platform after updates have been installed may be exploited by adversaries by causing older components to execute which contain vulnerabilities. When these components are deleted, the likelihood of this happening is removed.<br /><br />Satisfies: SRG-APP-000454-CTR-001110, SRG-APP-000454-CTR-001115
     </div>
     <div class="span1">
       <h3>Check</h3>
       Ensure the imagepruner is configured and is not in a suspended state by executing the following:<br /><br />oc get imagepruners.imageregistry.operator.openshift.io/cluster -o jsonpath='{.spec}{"\n"}'<br /><br />Review the settings. If "suspend" is set to "true", this is a finding.
     </div>
     <div class="span1">
       <h3>Fix</h3>
       Enable the image pruner to automate the pruning of images from the cluster by executing the following:<br /><br />oc patch imagepruners.imageregistry.operator.openshift.io/cluster --type=merge -p '{"spec":{"suspend":false}}'<br /><br />For additional details on configuring the image pruner operator, refer to the following document:<br />https://docs.openshift.com/container-platform/4.8/applications/pruning-objects.html#pruning-images_pruning-objects
     </div>
   </div>
  </div>

</div>
<div class="footer">
  <hr/>
  This website is not created by, run, approved, or endorsed by the U.S. Department of Defense.
  Use at your own risk. This website is created by
  <a href="https://github.com/Mab879/stigaview-static" target="_blank">open-source</a> software.
</div>
</body>
</html>