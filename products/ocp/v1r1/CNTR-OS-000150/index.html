<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="x-ua-compatible" content="ie=edge"/>
  <title>CNTR-OS-000150 - STIG-A-View</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Online STIG viewer"/>
  <meta name="generator" content="STIG-A-View Static - 0ce1fa5"/>
  <link href="/static/css/style.css" rel="stylesheet" />
  <link href="/favicon.png" rel="shortcut icon" />
</head>
<body>
<nav class="navbar">
  <a class="navbar-brand" href="/">STIG-A-View</a>
  <ul>
    <li><a class="nav-link" href="/stigs">STIGs</a></li>
    <li><a class="nav-link" href="/products">Products</a></li>
  </ul>
</nav>
<div class="container">

  <h2>OpenShift must generate audit records for all DOD-defined auditable events within all components in the platform.</h2>
  <p>
  <b>STIG ID:</b> CNTR-OS-000150 &nbsp;|&nbsp;
  <b>CCI: </b>CCI-000135&nbsp;|&nbsp;
  <b>SRG: </b><a href="/srgs/SRG-APP-000089-CTR-000150">SRG-APP-000089-CTR-000150</a> |
  <b>Severity: </b>medium
  </p>
  <div class="container-fluid">
   <div class="row">
     <div class="span1">
       <h3>Vulnerability Discussion</h3>
       The OpenShift Platform supports three audit levels: Default, WriteRequestBodies, and AllRequestBodies. The identities of the users are logged for all three audit levels log level. The WriteRequestBodies will log the metadata and the request body for any create, update, or patch request. The AllRequestBodies will log the metadata and the request body for all read and write requests. As this generates a significant number of logs, this level is only to be used as needed. To capture sufficient data to investigate an issue, it is required to set the audit level to WriteRequestBodies.<br /><br />For more detailed documentation on what is being logged, refer to https://docs.openshift.com/container-platform/4.8/security/audit-log-view.html.<br /><br />Satisfies: SRG-APP-000089-CTR-000150, SRG-APP-000090-CTR-000155, SRG-APP-000101-CTR-000205, SRG-APP-000510-CTR-001310, SRG-APP-000516-CTR-000790
     </div>
     <div class="span1">
       <h3>Check</h3>
       To determine at what level the OpenShift audit policy logging verbosity is configured, as a cluster-administrator:execute the following command:<br /><br />oc get apiserver.config.openshift.io/cluster -ojsonpath='{.spec.audit.profile}'<br /><br />If the output from the options does not return WriteRequestBodies or AllRequestBodies, this is a finding.
     </div>
     <div class="span1">
       <h3>Fix</h3>
       As the cluster administrator, update the APIServer.config.openshift.io/cluster object to set the profile to the defined level of detail. For example, to configure the profile to WriteRequestBodies, meaning that all write requests to any API server object are logged in their entirety, by executing the following:<br /><br />oc patch apiserver.config.openshift.io/cluster --type=merge -p '{"spec": {"audit": {"profile": "WriteRequestBodies"}}}'
     </div>
   </div>
  </div>

</div>
<div class="footer">
  <hr/>
  This website is not created by, run, approved, or endorsed by the U.S. Department of Defense.
  Use at your own risk. This website is created by
  <a href="https://github.com/Mab879/stigaview-static" target="_blank">open-source</a> software.
</div>
</body>
</html>