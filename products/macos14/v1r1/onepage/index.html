<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="x-ua-compatible" content="ie=edge"/>
  <title>macOS 14 - Sonoma STIG V1R1 - STIG-A-View</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Online STIG viewer"/>
  <meta name="generator" content="STIG-A-View Static - a04ee84"/>
  <link href="/static/css/style.css" rel="stylesheet" />
  <link href="/favicon.png" rel="shortcut icon" />
</head>
<body>
<nav class="navbar">
  <a class="navbar-brand" href="/">STIG-A-View</a>
  <ul>
    <li><a href="/">Home</a></li>
    <li><a class="nav-link" href="/stigs">STIGs</a></li>
    <li><a class="nav-link" href="/products">Products</a></li>
  </ul>
</nav>
<div class="container">

    <h2>macOS 14 - Sonoma STIG V1R1</h2>
  <a href="/products/macos14/v1r1">View as table</a>
  
    <hr>
    <h2 id="APPL-14-000001">The macOS system must prevent Apple Watch from terminating a session lock.</h2>
    <p>
    <b><a href="#APPL-14-000001">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000001">APPL-14-000001</a> |
      <b>CCI: </b>CCI-000056&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000028-GPOS-00009">SRG-OS-000028-GPOS-00009</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Disabling Apple watches is a necessary step to ensuring that the<br />                information system retains a session lock until the user reestablishes access using authorized<br />                identification and authentication procedures.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to prevent Apple Watch from terminating a session<br />                    lock with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowAutoUnlock').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to prevent Apple Watch from terminating a<br />                session lock by installing the "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000002">The macOS system must enforce screen saver password.</h2>
    <p>
    <b><a href="#APPL-14-000002">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000002">APPL-14-000002</a> |
      <b>CCI: </b>CCI-000056&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000028-GPOS-00009">SRG-OS-000028-GPOS-00009</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Users must authenticate when unlocking the screen saver.<br /><br />                The screen saver acts as a session lock and prevents unauthorized users from accessing the current<br />                user's account.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to prompt users to enter a password to unlock the<br />                    screen saver with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\<br />                    .objectForKey('askForPassword').js<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to prompt users to enter a password to<br />                unlock the screen saver by installing the "com.apple.screensaver" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000003">The macOS system must enforce session lock no more than five seconds after screen saver is started.
            </h2>
    <p>
    <b><a href="#APPL-14-000003">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000003">APPL-14-000003</a> |
      <b>CCI: </b>CCI-000056&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000028-GPOS-00009">SRG-OS-000028-GPOS-00009</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          A screen saver must be enabled and the system must be configured to<br />                require a password to unlock once the screensaver has been on for a maximum of five seconds.<br /><br />                An unattended system with an excessive grace period is vulnerable to a malicious user.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to initiate a session lock within five seconds of<br />                    the screen saver starting with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    function run() {<br />                    let delay = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\<br />                    .objectForKey('askForPasswordDelay'))<br />                    if ( delay <= 5 ) {<br />                    return("true")<br />                    } else {<br />                    return("false")<br />                    }<br />                    }<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to initiate a session lock within five<br />                seconds of the screen saver starting by installing the "com.apple.screensaver" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000005">The macOS system must configure user session lock when a smart token is removed.</h2>
    <p>
    <b><a href="#APPL-14-000005">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000005">APPL-14-000005</a> |
      <b>CCI: </b>CCI-000058&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000030-GPOS-00011">SRG-OS-000030-GPOS-00011</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The screen lock must be configured to initiate automatically when the<br />                smart token is removed from the system.<br /><br />                Session locks are temporary actions taken when users stop work and move away from the immediate vicinity<br />                of the information system but do not want to log out because of the temporary nature of their absence.<br />                While a session lock is not an acceptable substitute for logging out of an information system for longer<br />                periods of time, they prevent a malicious user from accessing the information system when a user has<br />                removed their smart token.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to lock the user session when a smart token is<br />                    removed with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.security.smartcard')\<br />                    .objectForKey('tokenRemovalAction').js<br />                    EOS<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to lock the user session when a smart token<br />                is removed by installing the "com.apple.security.smartcard" configuration profile.<br /><br />                Note: To ensure continued access to the operating system, consult the supplemental guidance provided<br />                with the STIG before applying the configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000007">The macOS system must disable hot corners.</h2>
    <p>
    <b><a href="#APPL-14-000007">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000007">APPL-14-000007</a> |
      <b>CCI: </b>CCI-000060&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000031-GPOS-00012">SRG-OS-000031-GPOS-00012</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Hot corners must be disabled.<br /><br />                The information system conceals, via the session lock, information previously visible on the display<br />                with a publicly viewable image. Although hot corners can be used to initiate a session lock or to launch<br />                useful applications, they can also be configured to disable an automatic session lock from initiating.<br />                Such a configuration introduces the risk that a user might forget to manually lock the screen before<br />                stepping away from the computer.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable hot corners with the following command:<br /><br />                    /usr/bin/profiles -P -o stdout | /usr/bin/grep -Ec '"wvous-bl-corner" = 0|"wvous-br-corner" =<br />                    0|"wvous-tl-corner" = 0|"wvous-tr-corner" = 0'<br /><br />                    If the result is not "4", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable hot corners by installing the<br />                "com.apple.ManagedClient.preferences" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000009">The macOS system must prevent AdminHostInfo from being available at LoginWindow.</h2>
    <p>
    <b><a href="#APPL-14-000009">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000009">APPL-14-000009</a> |
      <b>CCI: </b>CCI-000057&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000029-GPOS-00010">SRG-OS-000029-GPOS-00010</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The system must be configured to not display sensitive information at the<br />                LoginWindow. The key AdminHostInfo when configured will allow the HostName, IP Address, and operating<br />                system version and build to be displayed.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to prevent AdminHostInfo from being available at<br />                    LoginWindow with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\<br />                    .objectIsForcedForKey('AdminHostInfo')<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to prevent AdminHostInfo from being<br />                available at LoginWindow by installing the "com.apple.loginwindow" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000012">The macOS system must automatically remove or disable temporary or emergency user accounts within 72
                hours.
            </h2>
    <p>
    <b><a href="#APPL-14-000012">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000012">APPL-14-000012</a> |
      <b>CCI: </b>CCI-000016&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000002-GPOS-00002">SRG-OS-000002-GPOS-00002</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS is able to be configured to set an automated termination for 72<br />                hours or less for all temporary or emergency accounts upon account creation.<br /><br />                Emergency administrator accounts are privileged accounts established in response to crisis situations<br />                where the need for rapid account activation is required. Therefore, emergency account activation may<br />                bypass normal account authorization processes. If these accounts are disabled, system maintenance during<br />                emergencies may not be possible, thus adversely affecting system availability.<br /><br />                Although the ability to create and use emergency administrator accounts is necessary for performing<br />                system maintenance during emergencies, these accounts present vulnerabilities to the system if they are<br />                not disabled and removed when they are no longer needed. Configuring the macOS to automatically remove<br />                or disable emergency accounts within 72 hours of creation mitigates the risks posed if one were to be<br />                created and accidentally left active once the crisis is resolved.<br /><br />                Emergency administrator accounts are different from infrequently used accounts (i.e., local logon<br />                accounts used by system administrators when network or normal logon is not available). Infrequently used<br />                accounts also remain available and are not subject to automatic termination dates. However, an emergency<br />                administrator account is normally a different account created for use by vendors or system maintainers.<br /><br />                To address access requirements, many operating systems can be integrated with enterprise-level<br />                authentication/access mechanisms that meet or exceed access control policy requirements.<br /><br />                If temporary or emergency user accounts remain active when no longer needed or for an excessive period,<br />                these accounts may be targeted by attackers to gain unauthorized access. To mitigate this risk,<br />                automated termination of all temporary or emergency accounts must be set to 72 hours (or less) when the<br />                temporary or emergency account is created.<br /><br />                If no policy is enforced by a directory service, a password policy can be set with the "pwpolicy"<br />                utility. The variable names may vary depending on how the policy was set.<br /><br />                If there are no temporary or emergency accounts defined on the system, this is Not Applicable.<br /><br />                Satisfies: SRG-OS-000002-GPOS-00002,SRG-OS-000123-GPOS-00064
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify if a password policy is enforced by a directory service by asking the system<br />                    administrator (SA) or information system security officer (ISSO).<br /><br />                    If no policy is enforced by a directory service, a password policy can be set with the "pwpolicy"<br />                    utility. The variable names may vary depending on how the policy was set.<br /><br />                    If there are no temporary or emergency accounts defined on the system, this is Not Applicable.<br /><br />                    To check if the password policy is configured to disable a temporary or emergency account after 72<br />                    hours, run the following command to output the password policy to the screen, substituting the<br />                    correct user name in place of username:<br /><br />                    /usr/bin/pwpolicy -u username getaccountpolicies | tail -n +2<br /><br />                    If there is no output, and password policy is not controlled by a directory service, this is a<br />                    finding.<br /><br />                    Otherwise, look for the line "<key>policyCategoryAuthentication</key>".<br /><br />                    In the array that follows, there should be a <dict> section that contains a check <string><br />                    that allows users to log in if "policyAttributeCurrentTime" is less than the result of adding<br />                    "policyAttributeCreationTime" to 72 hours (259299 seconds). The check might use a variable defined<br />                    in its "policyParameters" section.<br /><br />                    If the check does not exist or if the check adds too great an amount of time to<br />                    "policyAttributeCreationTime", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          This setting may be enforced using local policy or by a directory<br />                service.<br /><br />                To set local policy to disable a temporary or emergency user, create a plain text file containing the<br />                following:<br /><br />                <dict><br />                <key>policyCategoryAuthentication</key><br />                <array><br />                <dict><br />                <key>policyContent</key><br />                <string>policyAttributeCurrentTime &lt; policyAttributeCreationTime+259299</string><br />                <key>policyIdentifier</key><br />                <string>Disable Tmp Accounts </string><br />                </dict><br />                </array><br />                </dict><br /><br />                After saving the file and exiting to the command prompt, run the following command to load the new<br />                policy file, substituting the correct user name in place of "username" and the path to the file in place<br />                of "/path/to/file".<br /><br />                /usr/bin/pwpolicy -u username setaccountpolicies /path/to/file<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000014">The macOS system must enforce time synchronization.</h2>
    <p>
    <b><a href="#APPL-14-000014">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000014">APPL-14-000014</a> |
      <b>CCI: </b>CCI-001891&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000355-GPOS-00143">SRG-OS-000355-GPOS-00143</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Time synchronization must be enforced on all networked systems.<br /><br />                This rule ensures the uniformity of time stamps for information systems with multiple system clocks and<br />                systems connected over a network.<br /><br />                Satisfies: SRG-OS-000355-GPOS-00143,SRG-OS-000356-GPOS-00144
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to enforce time synchronization with the following<br />                    command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.timed')\<br />                    .objectForKey('TMAutomaticTimeOnlyEnabled').js<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to enforce time synchronization by<br />                installing the "com.apple.timed" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000015">The macOS system must employ automated mechanisms to determine the state of system components.
            </h2>
    <p>
    <b><a href="#APPL-14-000015">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000015">APPL-14-000015</a> |
      <b>CCI: </b>CCI-001233&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000191-GPOS-00080">SRG-OS-000191-GPOS-00080</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS system must employ automated mechanisms to determine the state<br />                of system components. The DOD requires the installation and use of an approved endpoint security<br />                solution to be implemented on the operating system. For additional information, reference all applicable<br />                OPORDs and FRAGOs on SIPRNet.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured with automated mechanisms to determine the state of<br />                    system components.<br /><br />                    Ask the system administrator (SA) or information system security officer (ISSO) if the approved<br />                    endpoint security solution is loaded on the system.<br /><br />                    If the installed components of the endpoint security solution are not at the DOD-approved minimal<br />                    versions, this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Install the approved endpoint security solution onto the system.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000016">The macOS system must be integrated into a directory services infrastructure.</h2>
    <p>
    <b><a href="#APPL-14-000016">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000016">APPL-14-000016</a> |
      <b>CCI: </b>CCI-000366&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000480-GPOS-00227">SRG-OS-000480-GPOS-00227</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          A directory service infrastructure enables centralized user and rights<br />                management, as well as centralized control over computer and user configurations. Integrating the macOS<br />                systems used throughout an organization into a directory services infrastructure ensures more<br />                administrator oversight and security than allowing distinct user account databases to exist on each<br />                separate system.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to integrate into a directory service with the<br />                    following command:<br /><br />                    /usr/bin/dscl localhost -list . \| /usr/bin/grep -qvE '(Contact\|Search\|Local\|^$)'; /bin/echo $?<br /><br />                    If the result is not "0", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to integrate into an existing directory<br />                services infrastructure.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000022">The macOS system must limit consecutive failed log on attempts to three.</h2>
    <p>
    <b><a href="#APPL-14-000022">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000022">APPL-14-000022</a> |
      <b>CCI: </b>CCI-000044&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000021-GPOS-00005">SRG-OS-000021-GPOS-00005</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS must be configured to limit the number of failed log on<br />                attempts to a maximum of three. When the maximum number of failed attempts is reached, the account must<br />                be locked for a period of time after.<br /><br />                This rule protects against malicious users attempting to gain access to the system via brute-force<br />                hacking methods.<br /><br />                Satisfies: SRG-OS-000021-GPOS-00005,SRG-OS-000329-GPOS-00128
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to limit consecutive failed log on attempts to<br />                    three with the following command:<br /><br />                    /usr/bin/pwpolicy -getaccountpolicies 2> /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath<br />                    '//dict/key[text()="policyAttributeMaximumFailedAuthentications"]/following-sibling::integer[1]/text()'<br />                    - | /usr/bin/awk '{ if ($1 <= 3) {print "yes"} else {print "no"}}'<br /><br />                    If the result is not "yes", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to limit consecutive failed log on attempts<br />                to three by installing the "com.apple.mobiledevice.passwordpolicy" configuration profile or by a<br />                directory service.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000023">The macOS system must display the Standard Mandatory DOD Notice and Consent Banner at remote log
                on.
            </h2>
    <p>
    <b><a href="#APPL-14-000023">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000023">APPL-14-000023</a> |
      <b>CCI: </b>CCI-000048&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000023-GPOS-00006">SRG-OS-000023-GPOS-00006</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Displaying a standardized and approved use notification before granting<br />                access to the operating system ensures that users are provided with privacy and security notification<br />                verbiage that is consistent with applicable federal laws, Executive Orders, directives, policies,<br />                regulations, standards, and guidance.<br /><br />                System use notifications are required only for access via logon interfaces with human users and are not<br />                required when such human interfaces do not exist.<br /><br />                The banner must be formatted in accordance with DTM-08-060.<br /><br />                Satisfies: SRG-OS-000023-GPOS-00006,SRG-OS-000024-GPOS-00007
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to display the Standard Mandatory DOD Notice and<br />                    Consent Banner before granting remote access to the operating system.<br /><br />                    Verify the operating system has the correct text listed in the "/etc/banner" file with the following<br />                    command:<br /><br />                    /usr/bin/more /etc/banner<br /><br />                    The command must return the following text:<br /><br />                    "You are accessing a U.S. Government (USG) Information System (IS) that is provided for<br />                    USG-authorized use only.<br /><br />                    By using this IS (which includes any device attached to this IS), you consent to the following<br />                    conditions:<br /><br />                    -The USG routinely intercepts and monitors communications on this IS for purposes including, but not<br />                    limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel<br />                    misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.<br /><br />                    -At any time, the USG may inspect and seize data stored on this IS.<br /><br />                    -Communications using, or data stored on, this IS are not private, are subject to routine<br />                    monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.<br /><br />                    -This IS includes security measures (e.g., authentication and access controls) to protect USG<br />                    interests--not for your personal benefit or privacy.<br /><br />                    -Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative<br />                    searching or monitoring of the content of privileged communications, or work product, related to<br />                    personal representation or services by attorneys, psychotherapists, or clergy, and their assistants.<br />                    Such communications and work product are private and confidential. See User Agreement for details."<br /><br />                    If the operating system does not display a logon banner before granting remote access or the banner<br />                    does not match the Standard Mandatory DOD Notice and Consent Banner, this is a finding.<br /><br />                    If the text in the "/etc/banner" file does not match the Standard Mandatory DOD Notice and Consent<br />                    Banner, this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to display the Standard Mandatory DOD Notice<br />                and Consent Banner before granting remote access to the operating system by creating a text file<br />                containing the required DOD text.<br /><br />                Name the file "banner" and place it in "/etc/".<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000024">The macOS system must enforce SSH to display the Standard Mandatory DOD Notice and Consent Banner.
            </h2>
    <p>
    <b><a href="#APPL-14-000024">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000024">APPL-14-000024</a> |
      <b>CCI: </b>CCI-000048&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000023-GPOS-00006">SRG-OS-000023-GPOS-00006</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Displaying a standardized and approved use notification before granting<br />                access to the operating system ensures that users are provided with privacy and security notification<br />                verbiage that is consistent with applicable federal laws, Executive Orders, directives, policies,<br />                regulations, standards, and guidance.<br /><br />                System use notifications are required only for access via logon interfaces with human users and are not<br />                required when such human interfaces do not exist.<br /><br />                The banner must be formatted in accordance with DTM-08-060.<br /><br />                Note: /etc/ssh/sshd_config will be automatically modified to its original state following any update or<br />                major upgrade to the operating system.<br /><br />                Satisfies: SRG-OS-000023-GPOS-00006,SRG-OS-000024-GPOS-00007
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to display the contents of "/etc/banner" before<br />                    granting access to the system with the following command:<br /><br />                    /usr/sbin/sshd -G | /usr/bin/grep -c "^banner /etc/banner"<br /><br />                    If the command does not return "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to display the contents of "/etc/banner"<br />                before granting access to the system by creating a plain text file in the<br />                /private/etc/ssh/sshd_config.d/ directory containing the following:<br /><br />                banner /etc/banner<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000025">The macOS system must display the Standard Mandatory DOD Notice and Consent Banner at the login
                window.
            </h2>
    <p>
    <b><a href="#APPL-14-000025">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000025">APPL-14-000025</a> |
      <b>CCI: </b>CCI-000048&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000023-GPOS-00006">SRG-OS-000023-GPOS-00006</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Displaying a standardized and approved use notification before granting<br />                access to the operating system ensures that users are provided with privacy and security notification<br />                verbiage that is consistent with applicable federal laws, Executive Orders, directives, policies,<br />                regulations, standards, and guidance.<br /><br />                System use notifications are required only for access via logon interfaces with human users and are not<br />                required when such human interfaces do not exist.<br /><br />                The policy banner will show if a "PolicyBanner.rtf" or "PolicyBanner.rtfd" exists in the<br />                "/Library/Security" folder.<br /><br />                The banner must be formatted in accordance with DTM-08-060.<br /><br />                Satisfies: SRG-OS-000023-GPOS-00006,SRG-OS-000024-GPOS-00007,SRG-OS-000228-GPOS-00088
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to display a policy banner with the following<br />                    command:<br /><br />                    /bin/ls -ld /Library/Security/PolicyBanner.rtf* | /usr/bin/wc -l | /usr/bin/tr -d ' '<br /><br />                    If "PolicyBanner.rtfd" does not exist, this is a finding.<br /><br />                    If the permissions for "PolicyBanner.rtfd" are not "644", this is a finding.<br /><br />                    The banner text of the document must read:<br /><br />                    "You are accessing a U.S. Government (USG) Information System (IS) that is provided for<br />                    USG-authorized use only. By using this IS (which includes any device attached to this IS), you<br />                    consent to the following conditions:<br /><br />                    -The USG routinely intercepts and monitors communications on this IS for purposes including, but not<br />                    limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel<br />                    misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.<br /><br />                    -At any time, the USG may inspect and seize data stored on this IS.<br /><br />                    -Communications using, or data stored on, this IS are not private, are subject to routine<br />                    monitoring, interception, and search, and may be disclosed or used for any USG authorized purpose.<br /><br />                    -This IS includes security measures (e.g., authentication and access controls) to protect USG<br />                    interests--not for your personal benefit or privacy.<br /><br />                    -Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative<br />                    searching or monitoring of the content of privileged communications, or work product, related to<br />                    personal representation or services by attorneys, psychotherapists, or clergy, and their assistants.<br />                    Such communications and work product are private and confidential. See User Agreement for details."<br /><br />                    If the text is not worded exactly this way, this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to display a policy banner by creating an<br />                RTF file containing the required text. Name the file "PolicyBanner.rtfd" and place it in<br />                "/Library/Security/".<br /><br />                Update the permissions of the "/Library/Security/PolicyBanner.rtfd" file with the following command:<br /><br />                /usr/bin/sudo /bin/chmod 644 /Library/Security/PolicyBanner.rtfd<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000030">The macOS system must configure audit log files to not contain access control lists.</h2>
    <p>
    <b><a href="#APPL-14-000030">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000030">APPL-14-000030</a> |
      <b>CCI: </b>CCI-000162&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000057-GPOS-00027">SRG-OS-000057-GPOS-00027</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The audit log files must not contain access control lists (ACLs).<br /><br />                This rule ensures that audit information and audit files are configured to be readable and writable only<br />                by system administrators, thereby preventing unauthorized access, modification, and deletion of files.<br /><br />                Satisfies:<br />                SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured without ACLs applied to log files with the<br />                    following command:<br /><br />                    /bin/ls -le $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') |<br />                    /usr/bin/awk '{print $1}' | /usr/bin/grep -c ":"<br /><br />                    If the result is not "0", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system without ACLs applied to log files with the<br />                following command:<br /><br />                /bin/chmod -RN /var/audit<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000031">The macOS system must configure audit log folders to not contain access control lists.</h2>
    <p>
    <b><a href="#APPL-14-000031">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000031">APPL-14-000031</a> |
      <b>CCI: </b>CCI-000162&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000057-GPOS-00027">SRG-OS-000057-GPOS-00027</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The audit log folder must not contain access control lists (ACLs).<br /><br />                Audit logs contain sensitive data about the system and users. This rule ensures that the audit service<br />                is configured to create log folders that are readable and writable only by system administrators in<br />                order to prevent normal users from reading audit logs.<br /><br />                Satisfies:<br />                SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured without ACLs applied to log folders with the<br />                    following command:<br /><br />                    /bin/ls -lde /var/audit | /usr/bin/awk '{print $1}' | /usr/bin/grep -c ":"<br /><br />                    If the result is not "0", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system without ACLs applied to log folders with the<br />                following command:<br /><br />                /bin/chmod -N /var/audit<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000033">The macOS system must disable FileVault automatic log on.</h2>
    <p>
    <b><a href="#APPL-14-000033">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000033">APPL-14-000033</a> |
      <b>CCI: </b>CCI-000213&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000080-GPOS-00048">SRG-OS-000080-GPOS-00048</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          If FileVault is enabled, automatic log on must be disabled, so that both<br />                FileVault and login window authentication are required.<br /><br />                The default behavior of macOS when FileVault is enabled is to automatically log on to the computer once<br />                successfully passing user's FileVault credentials.<br /><br />                Note: DisableFDEAutoLogin does not have to be set on Apple Silicon-based macOS systems that are<br />                smartcard enforced, as smartcards are available at preboot.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable filevault automatic login with the<br />                    following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\<br />                    .objectForKey('DisableFDEAutoLogin').js<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable filevault automatic login by<br />                installing the "com.apple.loginwindow" configuration profile.<br /><br />                Note: To ensure continued access to the operating system, consult the supplemental guidance provided<br />                with the STIG before applying the configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000051">The macOS system must configure SSHD ClientAliveInterval to 900.</h2>
    <p>
    <b><a href="#APPL-14-000051">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000051">APPL-14-000051</a> |
      <b>CCI: </b>CCI-001133&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000163-GPOS-00072">SRG-OS-000163-GPOS-00072</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          If SSHD is enabled, then it must be configured with the Client Alive<br />                Interval set to 900.<br /><br />                Sets a timeout interval in seconds after which if no data has been received from the client, sshd(8)<br />                will send a message through the encrypted channel to request a response from the client.<br /><br />                This setting works in conjunction with ClientAliveCountMax to determine the termination of the<br />                connection after the threshold has been reached.<br /><br />                Note: This setting is not intended to manage idle user sessions where there is no input from the client.<br />                Its purpose is to monitor for interruptions in network connectivity and force the session to terminate<br />                after the connection appears to be broken.<br /><br />                Note: /etc/ssh/sshd_config will be automatically modified to its original state following any update or<br />                major upgrade to the operating system.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to set the SSHD ClientAliveInterval to 900 with the<br />                    following command:<br /><br />                    /usr/sbin/sshd -G | /usr/bin/awk '/clientaliveinterval/{print $2}'<br /><br />                    If the result is not "900", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to set the SSHD ClientAliveInterval to 900<br />                with the following command:<br /><br />                include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')<br /><br />                if [[ -z $include_dir ]]; then<br />                /usr/bin/sed -i.bk "1s/.*/Include \/etc\/ssh\/sshd_config.d\/\*/" /etc/ssh/sshd_config<br />                fi<br /><br />                /usr/bin/grep -qxF 'clientaliveinterval 900' "${include_dir}01-mscp-sshd.conf" 2>/dev/null || echo<br />                "clientaliveinterval 900" >> "${include_dir}01-mscp-sshd.conf"<br /><br />                for file in $(ls ${include_dir}); do<br />                if [[ "$file" == "100-macos.conf" ]]; then<br />                continue<br />                fi<br />                if [[ "$file" == "01-mscp-sshd.conf" ]]; then<br />                break<br />                fi<br />                /bin/mv ${include_dir}${file} ${include_dir}20-${file}<br />                done<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000052">The macOS system must configure SSHD ClientAliveCountMax to 1.</h2>
    <p>
    <b><a href="#APPL-14-000052">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000052">APPL-14-000052</a> |
      <b>CCI: </b>CCI-001133&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000163-GPOS-00072">SRG-OS-000163-GPOS-00072</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          If SSHD is enabled it must be configured with the Client Alive Maximum<br />                Count set to 1.<br /><br />                This will set the number of client alive messages which may be sent without the SSH server receiving any<br />                messages back from the client. If this threshold is reached while client alive messages are being sent,<br />                the SSH server will disconnect the client, terminating the session. The client alive messages are sent<br />                through the encrypted channel and therefore will not be spoofable. The client alive mechanism is<br />                valuable when the client or server depend on knowing when a connection has become unresponsive.<br /><br />                Note: This setting is not intended to manage idle user sessions where there is no input from the client.<br />                Its purpose is to monitor for interruptions in network connectivity and force the session to terminate<br />                after the connection appears to be broken.<br /><br />                Note: /etc/ssh/sshd_config will be automatically modified to its original state following any update or<br />                major upgrade to the operating system.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to set the SSHD ClientAliveCountMax to 1 with the<br />                    following command:<br /><br />                    /usr/sbin/sshd -G | /usr/bin/awk '/clientalivecountmax/{print $2}'<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to set the SSHD ClientAliveCountMax to 1<br />                with the following command:<br /><br />                include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')<br /><br />                if [[ -z $include_dir ]]; then<br />                /usr/bin/sed -i.bk "1s/.*/Include \/etc\/ssh\/sshd_config.d\/\*/" /etc/ssh/sshd_config<br />                fi<br /><br />                /usr/bin/grep -qxF 'clientalivecountmax 1' "${include_dir}01-mscp-sshd.conf" 2>/dev/null || echo<br />                "clientalivecountmax 1" >> "${include_dir}01-mscp-sshd.conf"<br /><br />                for file in $(ls ${include_dir}); do<br />                if [[ "$file" == "100-macos.conf" ]]; then<br />                continue<br />                fi<br />                if [[ "$file" == "01-mscp-sshd.conf" ]]; then<br />                break<br />                fi<br />                /bin/mv ${include_dir}${file} ${include_dir}20-${file}<br />                done<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000053">The macOS system must set Login Grace Time to 30.</h2>
    <p>
    <b><a href="#APPL-14-000053">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000053">APPL-14-000053</a> |
      <b>CCI: </b>CCI-001133&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000163-GPOS-00072">SRG-OS-000163-GPOS-00072</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          If SSHD is enabled, then it must be configured to wait only 30 seconds<br />                before timing out logon attempts.<br /><br />                Note: /etc/ssh/sshd_config will be automatically modified to its original state following any update or<br />                major upgrade to the operating system.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to set Login Grace Time to 30 with the following<br />                    command:<br /><br />                    /usr/sbin/sshd -G | /usr/bin/awk '/logingracetime/{print $2}'<br /><br />                    If the result is not "30", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to set Login Grace Time to 30 with the<br />                following command:<br /><br />                include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')<br /><br />                if [[ -z $include_dir ]]; then<br />                /usr/bin/sed -i.bk "1s/.*/Include \/etc\/ssh\/sshd_config.d\/\*/" /etc/ssh/sshd_config<br />                fi<br /><br />                /usr/bin/grep -qxF 'logingracetime 30' "${include_dir}01-mscp-sshd.conf" 2>/dev/null || echo<br />                "logingracetime 30" >> "${include_dir}01-mscp-sshd.conf"<br /><br />                for file in $(ls ${include_dir}); do<br />                if [[ "$file" == "100-macos.conf" ]]; then<br />                continue<br />                fi<br />                if [[ "$file" == "01-mscp-sshd.conf" ]]; then<br />                break<br />                fi<br />                /bin/mv ${include_dir}${file} ${include_dir}20-${file}<br />                done<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000054">The macOS system must limit SSHD to FIPS-compliant connections.</h2>
    <p>
    <b><a href="#APPL-14-000054">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000054">APPL-14-000054</a> |
      <b>CCI: </b>CCI-000068&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000033-GPOS-00014">SRG-OS-000033-GPOS-00014</a> |
      <b>Severity: </b>high
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          If SSHD is enabled then it must be configured to limit the Ciphers,<br />                HostbasedAcceptedAlgorithms, HostKeyAlgorithms, KexAlgorithms, MACs, PubkeyAcceptedAlgorithms,<br />                CASignatureAlgorithms to algorithms that are FIPS 140 validated.<br /><br />                FIPS 140-2 is the current standard for validating that mechanisms used to access cryptographic modules<br />                utilize authentication that meet federal requirements.<br /><br />                Operating systems utilizing encryption must use FIPS validated mechanisms for authenticating to<br />                cryptographic modules.<br /><br />                Note: For more information on FIPS compliance with the version of SSHD included in the macOS, the manual<br />                page apple_ssh_and_fips has additional information.<br /><br />                Satisfies:<br />                SRG-OS-000033-GPOS-00014,SRG-OS-000120-GPOS-00061,SRG-OS-000250-GPOS-00093,SRG-OS-000393-GPOS-00173,SRG-OS-000394-GPOS-00174,SRG-OS-000396-GPOS-00176,SRG-OS-000424-GPOS-00188,SRG-OS-000478-GPOS-00223
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to limit SSHD to FIPS-compliant connections with<br />                    the following command:<br /><br />                    fips_sshd_config=("Ciphers aes128-gcm@openssh.com" "HostbasedAcceptedAlgorithms<br />                    ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com" "HostKeyAlgorithms<br />                    ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com" "KexAlgorithms ecdh-sha2-nistp256"<br />                    "MACs hmac-sha2-256" "PubkeyAcceptedAlgorithms<br />                    ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com" "CASignatureAlgorithms<br />                    ecdsa-sha2-nistp256")<br />                    total=0<br />                    for config in $fips_sshd_config; do<br />                    total=$(expr $(/usr/sbin/sshd -G | /usr/bin/grep -i -c "$config") + $total)<br />                    done<br /><br />                    echo $total<br /><br />                    If the result is not "7", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to limit SSHD to FIPS-compliant connections<br />                with the following command:<br /><br />                fips_sshd_config="Ciphers aes128-gcm@openssh.com<br />                HostbasedAcceptedAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com<br />                HostKeyAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com<br />                KexAlgorithms ecdh-sha2-nistp256<br />                MACs hmac-sha2-256<br />                PubkeyAcceptedAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com<br />                CASignatureAlgorithms ecdsa-sha2-nistp256"<br />                /bin/echo "${fips_sshd_config}" > /etc/ssh/sshd_config.d/fips_sshd_config<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000057">The macOS system must limit SSH to FIPS-compliant connections.</h2>
    <p>
    <b><a href="#APPL-14-000057">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000057">APPL-14-000057</a> |
      <b>CCI: </b>CCI-000068&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000033-GPOS-00014">SRG-OS-000033-GPOS-00014</a> |
      <b>Severity: </b>high
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          SSH must be configured to limit the Ciphers, HostbasedAcceptedAlgorithms,<br />                HostKeyAlgorithms, KexAlgorithms, MACs, PubkeyAcceptedAlgorithms, CASignatureAlgorithms to algorithms<br />                that are FIPS 140 validated.<br /><br />                FIPS 140-2 is the current standard for validating that mechanisms used to access cryptographic modules<br />                utilize authentication that meet federal requirements.<br /><br />                Operating systems utilizing encryption must use FIPS-validated mechanisms for authenticating to<br />                cryptographic modules.<br /><br />                Note: For more information on FIPS compliance with the version of SSH included in the macOS, the manual<br />                page apple_ssh_and_fips has additional information.<br /><br />                Satisfies:<br />                SRG-OS-000033-GPOS-00014,SRG-OS-000120-GPOS-00061,SRG-OS-000250-GPOS-00093,SRG-OS-000396-GPOS-00176,SRG-OS-000424-GPOS-00188,SRG-OS-000478-GPOS-00223
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to limit SSH to FIPS-compliant connections with the<br />                    following command:<br /><br />                    fips_ssh_config="Host *<br />                    Ciphers aes128-gcm@openssh.com<br />                    HostbasedAcceptedAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com<br />                    HostKeyAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com<br />                    KexAlgorithms ecdh-sha2-nistp256<br />                    MACs hmac-sha2-256<br />                    PubkeyAcceptedAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com<br />                    CASignatureAlgorithms ecdsa-sha2-nistp256"<br />                    /usr/bin/grep -c "$fips_ssh_config" /etc/ssh/ssh_config.d/fips_ssh_config<br /><br />                    If the result is not "8", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to limit SSH to FIPS-compliant connections<br />                with the following command:<br /><br />                fips_ssh_config="Host *<br />                Ciphers aes128-gcm@openssh.com<br />                HostbasedAcceptedAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com<br />                HostKeyAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com<br />                KexAlgorithms ecdh-sha2-nistp256<br />                MACs hmac-sha2-256<br />                PubkeyAcceptedAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com<br />                CASignatureAlgorithms ecdsa-sha2-nistp256"<br />                /bin/echo "${fips_ssh_config}" > /etc/ssh/ssh_config.d/fips_ssh_config<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000060">The macOS system must set account lockout time to 15 minutes.</h2>
    <p>
    <b><a href="#APPL-14-000060">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000060">APPL-14-000060</a> |
      <b>CCI: </b>CCI-000044&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000021-GPOS-00005">SRG-OS-000021-GPOS-00005</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS must be configured to enforce a lockout time period of at least<br />                15 minutes when the maximum number of failed logon attempts is reached.<br /><br />                This rule protects against malicious users attempting to gain access to the system via brute-force<br />                hacking methods.<br /><br />                Satisfies: SRG-OS-000021-GPOS-00005,SRG-OS-000329-GPOS-00128
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to set account lockout time to 15 minutes with the<br />                    following command:<br /><br />                    /usr/bin/pwpolicy -getaccountpolicies 2> /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath<br />                    '//dict/key[text()="autoEnableInSeconds"]/following-sibling::integer[1]/text()' - | /usr/bin/awk '{<br />                    if ($1/60 >= 15 ) {print "yes"} else {print "no"}}'<br /><br />                    If the result is not "yes", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to set account lockout time to 15 minutes by<br />                installing the "com.apple.mobiledevice.passwordpolicy" configuration profile or by a directory service.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000070">The macOS system must enforce screen saver timeout.</h2>
    <p>
    <b><a href="#APPL-14-000070">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000070">APPL-14-000070</a> |
      <b>CCI: </b>CCI-000057&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000029-GPOS-00010">SRG-OS-000029-GPOS-00010</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The screen saver timeout must be set to 900 seconds or a shorter length<br />                of time.<br /><br />                This rule ensures that a full session lock is triggered within no more than 900 seconds of inactivity.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to initiate the screen saver timeout after 15<br />                    minutes of inactivity with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    function run() {<br />                    let timeout = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\<br />                    .objectForKey('idleTime'))<br />                    if ( timeout <= 900 ) {<br />                    return("true")<br />                    } else {<br />                    return("false")<br />                    }<br />                    }<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to initiate the screen saver after 15<br />                minutes of inactivity by installing the "com.apple.screensaver" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000080">The macOS system must enable SSH server for remote access sessions.</h2>
    <p>
    <b><a href="#APPL-14-000080">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000080">APPL-14-000080</a> |
      <b>CCI: </b>CCI-000213&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000080-GPOS-00048">SRG-OS-000080-GPOS-00048</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Remote access sessions must use encrypted methods to protect unauthorized<br />                individuals from gaining access.<br /><br />                Satisfies:<br />                SRG-OS-000080-GPOS-00048,SRG-OS-000113-GPOS-00058,SRG-OS-000425-GPOS-00189,SRG-OS-000426-GPOS-00190
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to enable SSH server for remote access sessions<br />                    with the following command:<br /><br />                    /bin/launchctl print-disabled system | /usr/bin/grep -c '"com.openssh.sshd" => enabled'<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to enable SSH server for remote access<br />                sessions with the following command:<br /><br />                /bin/launchctl enable system/com.openssh.sshd<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000090">The macOS system must disable logon to other user's active and locked sessions.</h2>
    <p>
    <b><a href="#APPL-14-000090">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000090">APPL-14-000090</a> |
      <b>CCI: </b>CCI-000764&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000104-GPOS-00051">SRG-OS-000104-GPOS-00051</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The ability to log in to another user's active or locked session must be<br />                disabled.<br /><br />                macOS has a privilege that can be granted to any user that will allow that user to unlock active user's<br />                sessions. Disabling the admins and/or user's ability to log into another user's active and locked<br />                session prevents unauthorized persons from viewing potentially sensitive and/or personal information.<br /><br />                Note: Configuring this setting will disable TouchID from unlocking the screensaver.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable login to other user's active and locked<br />                    sessions with the following command:<br /><br />                    /usr/bin/security authorizationdb read system.login.screensaver 2>&1 | /usr/bin/grep -c '<string>authenticate-session-owner</string>'<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable login to other user's active and<br />                locked sessions with the following command:<br /><br />                /usr/bin/security authorizationdb write system.login.screensaver "authenticate-session-owner"<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000100">The macOS system must disable root logon.</h2>
    <p>
    <b><a href="#APPL-14-000100">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000100">APPL-14-000100</a> |
      <b>CCI: </b>CCI-000764&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000104-GPOS-00051">SRG-OS-000104-GPOS-00051</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          To ensure individual accountability and prevent unauthorized access,<br />                logging in as root at the login window must be disabled.<br /><br />                The macOS system must require individuals to be authenticated with an individual authenticator prior to<br />                using a group authenticator, and administrator users must never log in directly as root.<br /><br />                Satisfies: SRG-OS-000104-GPOS-00051,SRG-OS-000109-GPOS-00056,SRG-OS-000364-GPOS-00151
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable root login with the following command:<br /><br />                    /usr/bin/dscl . -read /Users/root UserShell 2>&1 | /usr/bin/grep -c "/usr/bin/false"<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable root login with the following<br />                command:<br /><br />                /usr/bin/dscl . -create /Users/root UserShell /usr/bin/false<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000110">The macOS system must configure SSH ServerAliveInterval option set to 900.</h2>
    <p>
    <b><a href="#APPL-14-000110">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000110">APPL-14-000110</a> |
      <b>CCI: </b>CCI-001133&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000163-GPOS-00072">SRG-OS-000163-GPOS-00072</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          SSH must be configured with an Active Server Alive Maximum Count set to<br />                900.<br /><br />                Setting the Active Server Alive Maximum Count to 900 will log users out after a 900-second interval of<br />                inactivity.<br /><br />                Note: /etc/ssh/ssh_config will be automatically modified to its original state following any update or<br />                major upgrade to the operating system.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to set the SSH ServerAliveInterval option set to<br />                    900 with the following command:<br /><br />                    ret="pass"<br />                    for u in $(/usr/bin/dscl . -list /Users UniqueID | /usr/bin/awk '$2 > 500 {print $1}'); do<br />                    sshCheck=$(/usr/bin/sudo -u $u /usr/bin/ssh -G . | /usr/bin/grep -c "^serveraliveinterval 900")<br />                    if [[ "$sshCheck" == "0" ]]; then<br />                    ret="fail"<br />                    break<br />                    fi<br />                    done<br />                    /bin/echo $ret<br /><br />                    If the result is not "pass", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to set the SSH ServerAliveInterval option<br />                set to 900 with the following command:<br /><br />                for u in $(/usr/bin/dscl . -list /Users UniqueID | /usr/bin/awk '$2 > 500 {print $1}'); do<br />                config=$(/usr/bin/sudo -u $u /usr/bin/ssh -Gv . 2>&1 | /usr/bin/awk '/Reading configuration data/<br />                {print $NF}'| /usr/bin/tr -d '\r')<br />                configarray=( ${(f)config} )<br />                for c in $configarray; do<br />                /usr/bin/sudo -u $u /usr/bin/grep -q '^ServerAliveInterval' "$c" && /usr/bin/sed -i ''<br />                's/.*ServerAliveInterval.*/ServerAliveInterval 900/' "$c" || /bin/echo 'ServerAliveInterval 900' >><br />                "$c"<br />                done<br />                done<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000120">The macOS system must configure SSHD Channel Timeout to 900.</h2>
    <p>
    <b><a href="#APPL-14-000120">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000120">APPL-14-000120</a> |
      <b>CCI: </b>CCI-001133&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000163-GPOS-00072">SRG-OS-000163-GPOS-00072</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          If SSHD is enabled it must be configured with session Channel Timeout set<br />                to 900.<br /><br />                This will set the time out when the session is inactive.<br /><br />                Note: /etc/ssh/sshd_config will be automatically modified to its original state following any update or<br />                major upgrade to the operating system.<br /><br />                Satisfies: SRG-OS-000163-GPOS-00072,SRG-OS-000279-GPOS-00109
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to set the SSHD Channel Timeout to 900 with the<br />                    following command:<br /><br />                    /usr/sbin/sshd -G | /usr/bin/awk -F "=" '/channeltimeout session:*/{print $2}'<br /><br />                    If the result is not "900", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to set the SSHD Channel Timeout to 900 with<br />                the following command:<br /><br />                include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')<br /><br />                if [[ -z $include_dir ]]; then<br />                /usr/bin/sed -i.bk "1s/.*/Include \/etc\/ssh\/sshd_config.d\/\*/" /etc/ssh/sshd_config<br />                fi<br /><br />                /usr/bin/grep -qxF 'channeltimeout session:*=900' "${include_dir}01-mscp-sshd.conf" 2>/dev/null ||<br />                echo "channeltimeout session:*=900" >> "${include_dir}01-mscp-sshd.conf"<br /><br />                for file in $(ls ${include_dir}); do<br />                if [[ "$file" == "100-macos.conf" ]]; then<br />                continue<br />                fi<br />                if [[ "$file" == "01-mscp-sshd.conf" ]]; then<br />                break<br />                fi<br />                /bin/mv ${include_dir}${file} ${include_dir}20-${file}<br />                done<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000130">The macOS system must configure SSHD unused connection timeout to 900.</h2>
    <p>
    <b><a href="#APPL-14-000130">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000130">APPL-14-000130</a> |
      <b>CCI: </b>CCI-001133&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000163-GPOS-00072">SRG-OS-000163-GPOS-00072</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          If SSHD is enabled, it must be configured with unused connection timeout<br />                set to 900.<br /><br />                This will set the timeout when there are no open channels within a session.<br /><br />                Note: /etc/ssh/sshd_config will be automatically modified to its original state following any update or<br />                major upgrade to the operating system.<br /><br />                Satisfies: SRG-OS-000163-GPOS-00072,SRG-OS-000279-GPOS-00109
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to set the SSHD unused connection timeout to 900<br />                    with the following command:<br /><br />                    /usr/sbin/sshd -G | /usr/bin/awk '/unusedconnectionetimeout/{print $2}'<br /><br />                    If the result is not "900", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to set the SSHD unused connection timeout to<br />                900 with the following command:<br /><br />                include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')<br /><br />                if [[ -z $include_dir ]]; then<br />                /usr/bin/sed -i.bk "1s/.*/Include \/etc\/ssh\/sshd_config.d\/\*/" /etc/ssh/sshd_config<br />                fi<br /><br />                /usr/bin/grep -qxF 'unusedconnectionetimeout 900' "${include_dir}01-mscp-sshd.conf" 2>/dev/null ||<br />                echo "unusedconnectionetimeout 900" >> "${include_dir}01-mscp-sshd.conf"<br /><br />                for file in $(ls ${include_dir}); do<br />                if [[ "$file" == "100-macos.conf" ]]; then<br />                continue<br />                fi<br />                if [[ "$file" == "01-mscp-sshd.conf" ]]; then<br />                break<br />                fi<br />                /bin/mv ${include_dir}${file} ${include_dir}20-${file}<br />                done<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000140">The macOS system must set SSH Active Server Alive Maximum to 0.</h2>
    <p>
    <b><a href="#APPL-14-000140">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000140">APPL-14-000140</a> |
      <b>CCI: </b>CCI-001133&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000163-GPOS-00072">SRG-OS-000163-GPOS-00072</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          SSH must be configured with an Active Server Alive Maximum Count set to<br />                0. Terminating an idle session within a short time period reduces the window of opportunity for<br />                unauthorized personnel to take control of a management session enabled on the console or console port<br />                that has been left unattended. In addition, quickly terminating an idle session or an incomplete login<br />                attempt will also free up resources committed by the managed network element.<br /><br />                Note: /etc/ssh/ssh_config will be automatically modified to its original state following any update or<br />                major upgrade to the operating system.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to set SSH Active Server Alive Maximum to 0 with<br />                    the following command:<br /><br />                    ret="pass"<br />                    for u in $(/usr/bin/dscl . -list /Users UniqueID | /usr/bin/awk '$2 > 500 {print $1}'); do<br />                    sshCheck=$(/usr/bin/sudo -u $u /usr/bin/ssh -G . | /usr/bin/grep -c "^serveralivecountmax 0")<br />                    if [[ "$sshCheck" == "0" ]]; then<br />                    ret="fail"<br />                    break<br />                    fi<br />                    done<br />                    /bin/echo $ret<br /><br />                    If the result is not "pass", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to set SSH Active Server Alive Maximum to 0<br />                with the following command:<br /><br />                for u in $(/usr/bin/dscl . -list /Users UniqueID | /usr/bin/awk '$2 > 500 {print $1}'); do<br />                config=$(/usr/bin/sudo -u $u /usr/bin/ssh -Gv . 2>&1 | /usr/bin/awk '/Reading configuration data/<br />                {print $NF}'| /usr/bin/tr -d '\r')<br />                configarray=( ${(f)config} )<br />                for c in $configarray; do<br />                /usr/bin/sudo -u $u /usr/bin/grep -q '^ServerAliveCountMax' "$c" && /usr/bin/sed -i ''<br />                's/.*ServerAliveCountMax.*/ServerAliveCountMax 0/' "$c" || /bin/echo 'ServerAliveCountMax 0' >><br />                "$c"<br />                done<br />                done<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000160">The macOS system must enforce auto logout after 86400 seconds of inactivity.</h2>
    <p>
    <b><a href="#APPL-14-000160">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000160">APPL-14-000160</a> |
      <b>CCI: </b>CCI-002361&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000279-GPOS-00109">SRG-OS-000279-GPOS-00109</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Auto logout must be configured to automatically terminate a user session<br />                and log out the after 86400 seconds of inactivity.<br /><br />                Note: The maximum that macOS can be configured for autologoff is 86400 seconds.<br /><br />                [IMPORTANT]<br />                ====<br />                The automatic logout may cause disruptions to an organization's workflow and/or loss of data.<br />                Information system security officers (ISSOs) are advised to first fully weigh the potential risks posed<br />                to their organization before opting to disable the automatic logout setting.<br />                ====
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to enforce auto logout after 86400 seconds of<br />                    inactivity with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('.GlobalPreferences')\<br />                    .objectForKey('com.apple.autologout.AutoLogOutDelay').js<br />                    EOS<br /><br />                    If the result is not "86400", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to enforce auto logout after 86400 seconds<br />                of inactivity by installing the "com.apple.GlobalPreferences" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000170">The macOS system must be configured to use an authorized time server.</h2>
    <p>
    <b><a href="#APPL-14-000170">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000170">APPL-14-000170</a> |
      <b>CCI: </b>CCI-001891&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000355-GPOS-00143">SRG-OS-000355-GPOS-00143</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Approved time servers must be the only servers configured for use.<br /><br />                This rule ensures the uniformity of time stamps for information systems with multiple system clocks and<br />                systems connected over a network.<br /><br />                An authoritative time server is synchronized with redundant United States Naval Observatory (USNO) time<br />                servers as designated for the appropriate DOD network.<br /><br />                Satisfies: SRG-OS-000355-GPOS-00143,SRG-OS-000356-GPOS-00144
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to use an authorized time server with the following<br />                    command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX')\<br />                    .objectForKey('timeServer').js<br />                    EOS<br /><br />                    If the result is not an authoritative time server which is synchronized with redundant United States<br />                    Naval Observatory (USNO) time servers as designated for the appropriate DoD network, this is a<br />                    finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to use an authorized time server by<br />                installing the "com.apple.MCX" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-000180">The macOS system must enable time synchronization daemon.</h2>
    <p>
    <b><a href="#APPL-14-000180">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-000180">APPL-14-000180</a> |
      <b>CCI: </b>CCI-001891&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000355-GPOS-00143">SRG-OS-000355-GPOS-00143</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS time synchronization daemon (timed) must be enabled for proper<br />                time synchronization to an authorized time server.<br /><br />                Note: The time synchronization daemon is enabled by default on macOS.<br /><br />                Satisfies: SRG-OS-000355-GPOS-00143,SRG-OS-000356-GPOS-00144
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to enable time synchronization daemon with the<br />                    following command:<br /><br />                    /bin/launchctl list | /usr/bin/grep -c com.apple.timed<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to enable time synchronization daemon with<br />                the following command:<br /><br />                /bin/launchctl load -w /System/Library/LaunchDaemons/com.apple.timed.plist<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-001001">The macOS system must be configured to audit all administrative action events.</h2>
    <p>
    <b><a href="#APPL-14-001001">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-001001">APPL-14-001001</a> |
      <b>CCI: </b>CCI-000018&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000004-GPOS-00004">SRG-OS-000004-GPOS-00004</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Administrative action events include changes made to the system (e.g.,<br />                modifying authentication policies). If audit records do not include "ad" events, it is difficult to<br />                identify incidents and to correlate incidents to subsequent events. Audit records can be generated from<br />                various components within the information system (e.g., via a module or policy filter).<br /><br />                Administrative and privileged access, including administrative use of the command line tools "kextload"<br />                and "kextunload" and changes to configuration settings, are logged by way of the "ad" flag.<br /><br />                Satisfies:<br />                SRG-OS-000004-GPOS-00004,SRG-OS-000239-GPOS-00089,SRG-OS-000240-GPOS-00090,SRG-OS-000241-GPOS-00091,SRG-OS-000327-GPOS-00127,SRG-OS-000365-GPOS-00152,SRG-OS-000392-GPOS-00172,SRG-OS-000458-GPOS-00203,SRG-OS-000471-GPOS-00215,SRG-OS-000471-GPOS-00216,SRG-OS-000476-GPOS-00221
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to audit privileged access with the following<br />                    command:<br /><br />                    /usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' |<br />                    /usr/bin/grep -Ec 'ad'<br /><br />                    If "ad" is not listed in the output, this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to audit privileged access with the<br />                following command:<br /><br />                /usr/bin/grep -qE "^flags.*[^-]ad" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/<br />                s/$/,ad/' /etc/security/audit_control; /usr/sbin/audit -s<br /><br />                A text editor may also be used to implement the required updates to the "/etc/security/audit_control"<br />                file.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-001002">The macOS system must be configured to audit all log on and log out events.</h2>
    <p>
    <b><a href="#APPL-14-001002">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-001002">APPL-14-001002</a> |
      <b>CCI: </b>CCI-000067&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000032-GPOS-00013">SRG-OS-000032-GPOS-00013</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The audit system must be configured to record all attempts to log in and<br />                out of the system (lo).<br /><br />                Frequently, an attacker that successfully gains access to a system has only gained access to an account<br />                with limited privileges, such as a guest account or a service account. The attacker must attempt to<br />                change to another user account with normal or elevated privileges in order to proceed. Auditing both<br />                successful and unsuccessful attempts to switch to another user account (by way of monitoring log on and<br />                log out events) mitigates this risk.<br /><br />                The information system monitors log on and log out events.<br /><br />                Satisfies:<br />                SRG-OS-000032-GPOS-00013,SRG-OS-000064-GPOS-00033,SRG-OS-000392-GPOS-00172,SRG-OS-000458-GPOS-00203,SRG-OS-000470-GPOS-00214,SRG-OS-000471-GPOS-00215,SRG-OS-000471-GPOS-00216,SRG-OS-000472-GPOS-00217,SRG-OS-000473-GPOS-00218
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to audit all log on and log out events with the<br />                    following command:<br /><br />                    /usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' |<br />                    /usr/bin/grep -Ec '^lo'<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to audit all log on and log out events with<br />                the following command:<br /><br />                /usr/bin/grep -qE "^flags.*[^-]lo" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/<br />                s/$/,lo/' /etc/security/audit_control; /usr/sbin/audit -s<br /><br />                A text editor may also be used to implement the required updates to the "/etc/security/audit_control"<br />                file.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-001003">The macOS system must enable security auditing.</h2>
    <p>
    <b><a href="#APPL-14-001003">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-001003">APPL-14-001003</a> |
      <b>CCI: </b>CCI-000130&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000037-GPOS-00015">SRG-OS-000037-GPOS-00015</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Audit records establish what types of events have occurred, when they<br />                occurred, and which users were involved. These records aid an organization in their efforts to<br />                establish, correlate, and investigate the events leading up to an outage or attack.<br /><br />                The content required to be captured in an audit record varies based on the impact level of an<br />                organization's system. Content that may be necessary to satisfy this requirement includes, for example,<br />                time stamps, source addresses, destination addresses, user identifiers, event descriptions, success/fail<br />                indications, filenames involved, and access or flow control rules invoked.<br /><br />                The information system initiates session audits at system startup.<br /><br />                Note: Security auditing is enabled by default on macOS.<br /><br />                Satisfies:<br />                SRG-OS-000037-GPOS-00015,SRG-OS-000038-GPOS-00016,SRG-OS-000039-GPOS-00017,SRG-OS-000040-GPOS-00018,SRG-OS-000041-GPOS-00019,SRG-OS-000042-GPOS-00020,SRG-OS-000042-GPOS-00021,SRG-OS-000055-GPOS-00026,SRG-OS-000254-GPOS-00095,SRG-OS-000255-GPOS-00096,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099,SRG-OS-000303-GPOS-00120,SRG-OS-000337-GPOS-00129,SRG-OS-000358-GPOS-00145,SRG-OS-000359-GPOS-00146,SRG-OS-000365-GPOS-00152,SRG-OS-000392-GPOS-00172,SRG-OS-000458-GPOS-00203,SRG-OS-000461-GPOS-00205,SRG-OS-000462-GPOS-00206,SRG-OS-000463-GPOS-00207,SRG-OS-000465-GPOS-00209,SRG-OS-000466-GPOS-00210,SRG-OS-000467-GPOS-00211,SRG-OS-000468-GPOS-00212,SRG-OS-000470-GPOS-00214,SRG-OS-000471-GPOS-00215,SRG-OS-000471-GPOS-00216,SRG-OS-000472-GPOS-00217,SRG-OS-000473-GPOS-00218,SRG-OS-000474-GPOS-00219,SRG-OS-000475-GPOS-00220,SRG-OS-000476-GPOS-00221,SRG-OS-000477-GPOS-00222
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to enable the auditd service with the following<br />                    command:<br /><br />                    LAUNCHD_RUNNING=$(/bin/launchctl list | /usr/bin/grep -c com.apple.auditd)<br />                    if [[ $LAUNCHD_RUNNING == 1 ]] && [[ -e /etc/security/audit_control ]]; then<br />                    echo "pass"<br />                    else<br />                    echo "fail"<br />                    fi<br /><br />                    If the result is not "pass", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to enable the auditd service with the<br />                following command:<br /><br />                LAUNCHD_RUNNING=$(/bin/launchctl list | /usr/bin/grep -c com.apple.auditd)<br /><br />                if [[ ! $LAUNCHD_RUNNING == 1 ]]; then<br />                /bin/launchctl load -w /System/Library/LaunchDaemons/com.apple.auditd.plist<br />                fi<br /><br />                if [[ ! -e /etc/security/audit_control ]] && [[ -e /etc/security/audit_control.example ]];then<br />                /bin/cp /etc/security/audit_control.example /etc/security/audit_control<br />                else<br />                /usr/bin/touch /etc/security/audit_control<br />                fi<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-001010">The macOS system must configure system to shut down upon audit failure.</h2>
    <p>
    <b><a href="#APPL-14-001010">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-001010">APPL-14-001010</a> |
      <b>CCI: </b>CCI-000140&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000047-GPOS-00023">SRG-OS-000047-GPOS-00023</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The audit service must be configured to shut down the computer if it is<br />                unable to audit system events.<br /><br />                Once audit failure occurs, user and system activity are no longer recorded, and malicious activity could<br />                go undetected. Audit processing failures can occur due to software/hardware errors, failures in the<br />                audit capturing mechanisms, and audit storage capacity being reached or exceeded.<br /><br />                When availability is an overriding concern, other approved actions in response to an audit failure are<br />                as follows:<br /><br />                (i) If the failure was caused by the lack of audit record storage capacity, the operating system must<br />                continue generating audit records if possible (automatically restarting the audit service if necessary),<br />                overwriting the oldest audit records in a first-in-first-out manner.<br /><br />                (ii) If audit records are sent to a centralized collection server and communication with this server is<br />                lost or the server fails, the operating system must queue audit records locally until communication is<br />                restored or until the audit records are retrieved manually. Upon restoration of the connection to the<br />                centralized collection server, action should be taken to synchronize the local audit data with the<br />                collection server.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to shut down upon audit failure with the following<br />                    command:<br /><br />                    /usr/bin/awk -F':' '/^policy/ {print $NF}' /etc/security/audit_control | /usr/bin/tr ',' '\n' |<br />                    /usr/bin/grep -Ec 'ahlt'<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to shut down upon audit failure with the<br />                following command:<br /><br />                /usr/bin/sed -i.bak 's/^policy.*/policy: ahlt,argv/' /etc/security/audit_control; /usr/sbin/audit -s<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-001012">The macOS system must configure audit log files to be owned by root.</h2>
    <p>
    <b><a href="#APPL-14-001012">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-001012">APPL-14-001012</a> |
      <b>CCI: </b>CCI-000162&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000057-GPOS-00027">SRG-OS-000057-GPOS-00027</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Audit log files must be owned by root.<br /><br />                The audit service must be configured to create log files with the correct ownership to prevent normal<br />                users from reading audit logs.<br /><br />                Audit logs contain sensitive data about the system and users. If log files are set to only be readable<br />                and writable by system administrators, the risk is mitigated.<br /><br />                Satisfies:<br />                SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured with audit log files owned by root with the<br />                    following command:<br /><br />                    /bin/ls -n $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') |<br />                    /usr/bin/awk '{s+=$3} END {print s}'<br /><br />                    If the result is not "0", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system with audit log files owned by root with the<br />                following command:<br /><br />                /usr/sbin/chown -R root /var/audit/*<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-001013">The macOS system must configure audit log folders to be owned by root.</h2>
    <p>
    <b><a href="#APPL-14-001013">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-001013">APPL-14-001013</a> |
      <b>CCI: </b>CCI-000162&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000057-GPOS-00027">SRG-OS-000057-GPOS-00027</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Audit log folders must be owned by root.<br /><br />                The audit service must be configured to create log folders with the correct ownership to prevent normal<br />                users from reading audit logs.<br /><br />                Audit logs contain sensitive data about the system and users. If log folders are set to only be readable<br />                and writable by system administrators, the risk is mitigated.<br /><br />                Satisfies:<br />                SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured with audit log folders owned by root with the<br />                    following command:<br /><br />                    /bin/ls -dn $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') |<br />                    /usr/bin/awk '{print $3}'<br /><br />                    If the result is not "0", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system with audit log folders owned by root with<br />                the following command:<br /><br />                /usr/sbin/chown root /var/audit<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-001014">The macOS system must configure audit log files group to wheel.</h2>
    <p>
    <b><a href="#APPL-14-001014">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-001014">APPL-14-001014</a> |
      <b>CCI: </b>CCI-000162&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000057-GPOS-00027">SRG-OS-000057-GPOS-00027</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Audit log files must have the group set to wheel.<br /><br />                The audit service must be configured to create log files with the correct group ownership to prevent<br />                normal users from reading audit logs.<br /><br />                Audit logs contain sensitive data about the system and users. If log files are set to be readable and<br />                writable only by system administrators, the risk is mitigated.<br /><br />                Satisfies:<br />                SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured with audit log files group-owned by wheel with the<br />                    following command:<br /><br />                    /bin/ls -n $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') |<br />                    /usr/bin/awk '{s+=$4} END {print s}'<br /><br />                    If the result is not "0", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system with audit log files group-owned by wheel<br />                with the following command:<br /><br />                /usr/bin/chgrp -R wheel /var/audit/*<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-001015">The macOS system must configure audit log folders group to wheel.</h2>
    <p>
    <b><a href="#APPL-14-001015">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-001015">APPL-14-001015</a> |
      <b>CCI: </b>CCI-000162&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000057-GPOS-00027">SRG-OS-000057-GPOS-00027</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Audit log folders must have the group set to wheel.<br /><br />                The audit service must be configured to create log files with the correct group ownership to prevent<br />                normal users from reading audit logs.<br /><br />                Audit logs contain sensitive data about the system and users. If log files are set to be readable and<br />                writable only by system administrators, the risk is mitigated.<br /><br />                Satisfies:<br />                SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured with audit log folders group-owned by wheel with<br />                    the following command:<br /><br />                    /bin/ls -dn $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') |<br />                    /usr/bin/awk '{print $4}'<br /><br />                    If the result is not "0", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system with audit log folders group-owned by wheel<br />                with the following command:<br /><br />                /usr/bin/chgrp wheel /var/audit<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-001016">The macOS system must configure audit log files to mode 440 or less permissive.</h2>
    <p>
    <b><a href="#APPL-14-001016">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-001016">APPL-14-001016</a> |
      <b>CCI: </b>CCI-000162&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000057-GPOS-00027">SRG-OS-000057-GPOS-00027</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The audit service must be configured to create log files that are<br />                readable only by the root user and group wheel. To achieve this, audit log files must be configured to<br />                mode 440 or less permissive; thereby preventing normal users from reading, modifying, or deleting audit<br />                logs.<br /><br />                Satisfies:<br />                SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured with audit log files set to mode 440 or less with<br />                    the following command:<br /><br />                    /bin/ls -l $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') |<br />                    /usr/bin/awk '!/-r--r-----|current|total/{print $1}' | /usr/bin/wc -l | /usr/bin/tr -d ' '<br /><br />                    If the result is not "0", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system with audit log files set to mode 440 with<br />                the following command:<br /><br />                /bin/chmod 440 /var/audit/*<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-001017">The macOS system must configure audit log folders to mode 700 or less permissive.</h2>
    <p>
    <b><a href="#APPL-14-001017">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-001017">APPL-14-001017</a> |
      <b>CCI: </b>CCI-000162&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000057-GPOS-00027">SRG-OS-000057-GPOS-00027</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The audit log folder must be configured to mode 700 or less permissive so<br />                that only the root user is able to read, write, and execute changes to folders.<br /><br />                Because audit logs contain sensitive data about the system and users, the audit service must be<br />                configured to mode 700 or less permissive; thereby preventing normal users from reading, modifying, or<br />                deleting audit logs.<br /><br />                Satisfies:<br />                SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured with audit log folders set to mode 700 or less<br />                    permissive with the following command:<br /><br />                    /usr/bin/stat -f %A $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print<br />                    $2}')<br /><br />                    If the result is not a mode of 700 or less permissive, this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system with audit log folders set to mode 700 with<br />                the following command:<br /><br />                /bin/chmod 700 /var/audit<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-001020">The macOS system must be configured to audit all deletions of object attributes.</h2>
    <p>
    <b><a href="#APPL-14-001020">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-001020">APPL-14-001020</a> |
      <b>CCI: </b>CCI-000162&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000057-GPOS-00027">SRG-OS-000057-GPOS-00027</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The audit system must be configured to record enforcement actions of<br />                attempts to delete file attributes (fd).<br /><br />                ***Enforcement actions are the methods or mechanisms used to prevent unauthorized changes to<br />                configuration settings. One common and effective enforcement action method is using access restrictions<br />                (i.e., denying modifications to a file by applying file permissions).<br /><br />                This configuration ensures that audit lists include events in which enforcement actions prevent attempts<br />                to delete a file.<br /><br />                Without auditing the enforcement of access restrictions, it is difficult to identify attempted attacks,<br />                as there is no audit trail available for forensic investigation.<br /><br />                Satisfies:<br />                SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000064-GPOS-00033,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099,SRG-OS-000365-GPOS-00152,SRG-OS-000392-GPOS-00172,SRG-OS-000458-GPOS-00203,SRG-OS-000463-GPOS-00207,SRG-OS-000465-GPOS-00209,SRG-OS-000466-GPOS-00210,SRG-OS-000467-GPOS-00211,SRG-OS-000468-GPOS-00212
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to audit all deletions of object attributes with<br />                    the following command:<br /><br />                    /usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' |<br />                    /usr/bin/grep -Ec '\-fd'<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to audit all deletions of object attributes<br />                with the following command:<br /><br />                /usr/bin/grep -qE "^flags.*-fd" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,-fd/'<br />                /etc/security/audit_control;/usr/sbin/audit -s<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-001021">The macOS system must be configured to audit all changes of object attributes.</h2>
    <p>
    <b><a href="#APPL-14-001021">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-001021">APPL-14-001021</a> |
      <b>CCI: </b>CCI-000162&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000057-GPOS-00027">SRG-OS-000057-GPOS-00027</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The audit system must be configured to record enforcement actions of<br />                attempts to modify file attributes (fm).<br /><br />                Enforcement actions are the methods or mechanisms used to prevent unauthorized changes to configuration<br />                settings. One common and effective enforcement action method is using access restrictions (i.e.,<br />                modifications to a file by applying file permissions).<br /><br />                This configuration ensures that audit lists include events in which enforcement actions attempts to<br />                modify a file.<br /><br />                Without auditing the enforcement of access restrictions, it is difficult to identify attempted attacks,<br />                as there is no audit trail available for forensic investigation.<br /><br />                Satisfies:<br />                SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000064-GPOS-00033,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099,SRG-OS-000365-GPOS-00152,SRG-OS-000392-GPOS-00172,SRG-OS-000458-GPOS-00203,SRG-OS-000462-GPOS-00206,SRG-OS-000463-GPOS-00207,SRG-OS-000465-GPOS-00209,SRG-OS-000466-GPOS-00210,SRG-OS-000467-GPOS-00211,SRG-OS-000468-GPOS-00212
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to audit all changes of object attributes with the<br />                    following command:<br /><br />                    /usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' |<br />                    /usr/bin/grep -Ec '^fm'<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to audit all changes of object attributes<br />                with the following command:<br /><br />                /usr/bin/grep -qE "^flags.*fm" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,fm/'<br />                /etc/security/audit_control;/usr/sbin/audit -s<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-001022">The macOS system must be configured to audit all failed read actions on the system.</h2>
    <p>
    <b><a href="#APPL-14-001022">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-001022">APPL-14-001022</a> |
      <b>CCI: </b>CCI-000162&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000463-GPOS-00207">SRG-OS-000463-GPOS-00207</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The audit system must be configured to record enforcement actions of<br />                access restrictions, including failed file read (-fr) attempts.<br /><br />                Enforcement actions are the methods or mechanisms used to prevent unauthorized access and/or changes to<br />                configuration settings. One common and effective enforcement action method is using access restrictions<br />                (e.g., denying access to a file by applying file permissions).<br /><br />                This configuration ensures that audit lists include events in which enforcement actions prevent attempts<br />                to read a file.<br /><br />                Without auditing the enforcement of access restrictions, it is difficult to identify attempted attacks,<br />                as there is no audit trail available for forensic investigation.<br /><br />                Satisfies:<br />                SRG-OS-000463-GPOS-00207,SRG-OS-000057-GPOS-00027,SRG-OS-000465-GPOS-00209,SRG-OS-000474-GPOS-00219
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to audit all failed read actions on the system with<br />                    the following command:<br /><br />                    /usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' |<br />                    /usr/bin/grep -Ec '\-fr'<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to audit all failed read actions on the<br />                system with the following command:<br /><br />                /usr/bin/grep -qE "^flags.*-fr" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,-fr/'<br />                /etc/security/audit_control;/usr/sbin/audit -s<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-001023">The macOS system must be configured to audit all failed write actions on the system.</h2>
    <p>
    <b><a href="#APPL-14-001023">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-001023">APPL-14-001023</a> |
      <b>CCI: </b>CCI-000162&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000463-GPOS-00207">SRG-OS-000463-GPOS-00207</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The audit system must be configured to record enforcement actions of<br />                access restrictions, including failed file write (-fw) attempts.<br /><br />                Enforcement actions are the methods or mechanisms used to prevent unauthorized access and/or changes to<br />                configuration settings. One common and effective enforcement action method is using access restrictions<br />                (e.g., denying users access to edit a file by applying file permissions).<br /><br />                This configuration ensures that audit lists include events in which enforcement actions prevent attempts<br />                to change a file.<br /><br />                Without auditing the enforcement of access restrictions, it is difficult to identify attempted attacks,<br />                as there is no audit trail available for forensic investigation.<br /><br />                Satisfies:<br />                SRG-OS-000463-GPOS-00207,SRG-OS-000057-GPOS-00027,SRG-OS-000465-GPOS-00209,SRG-OS-000466-GPOS-00210,SRG-OS-000467-GPOS-00211,SRG-OS-000468-GPOS-00212
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to audit all failed write actions on the system<br />                    with the following command:<br /><br />                    /usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' |<br />                    /usr/bin/grep -Ec '\-fw'<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to audit all failed write actions on the<br />                system with the following command:<br /><br />                /usr/bin/grep -qE "^flags.*-fw" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,-fw/'<br />                /etc/security/audit_control;/usr/sbin/audit -s<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-001024">The macOS system must be configured to audit all failed program execution on the system.</h2>
    <p>
    <b><a href="#APPL-14-001024">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-001024">APPL-14-001024</a> |
      <b>CCI: </b>CCI-000172&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000463-GPOS-00207">SRG-OS-000463-GPOS-00207</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The audit system must be configured to record enforcement actions of<br />                access restrictions, including failed program execute (-ex) attempts.<br /><br />                Enforcement actions are the methods or mechanisms used to prevent unauthorized access and/or changes to<br />                configuration settings. One common and effective enforcement action method is using program execution<br />                restrictions (e.g., denying users access to execute certain processes).<br /><br />                This configuration ensures that audit lists include events in which program execution has failed.<br /><br />                Without auditing the enforcement of program execution, it is difficult to identify attempted attacks, as<br />                there is no audit trail available for forensic investigation.<br /><br />                Satisfies:<br />                SRG-OS-000463-GPOS-00207,SRG-OS-000365-GPOS-00152,SRG-OS-000458-GPOS-00203,SRG-OS-000465-GPOS-00209
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to audit all failed program execution on the system<br />                    with the following command:<br /><br />                    /usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' |<br />                    /usr/bin/grep -Ec '\-ex'<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to audit all failed program execution on the<br />                system with the following command:<br /><br />                /usr/bin/grep -qE "^flags.*-ex" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,-ex/'<br />                /etc/security/audit_control; /usr/sbin/audit -s<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-001029">The macOS system must configure audit retention to seven days.</h2>
    <p>
    <b><a href="#APPL-14-001029">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-001029">APPL-14-001029</a> |
      <b>CCI: </b>CCI-001849&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000341-GPOS-00132">SRG-OS-000341-GPOS-00132</a> |
      <b>Severity: </b>low
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The audit service must be configured to require records be kept for an<br />                organizational defined value before deletion, unless the system uses a central audit record storage<br />                facility.<br /><br />                When "expire-after" is set to "7d", the audit service will not delete audit logs until the log data<br />                criteria is met.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured audit retention to seven days with the following<br />                    command:<br /><br />                    /usr/bin/awk -F: '/expire-after/{print $2}' /etc/security/audit_control<br /><br />                    If the result is not "7d", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to set audit retention to seven days with<br />                the following command:<br /><br />                /usr/bin/sed -i.bak 's/^expire-after.*/expire-after:7d/' /etc/security/audit_control; /usr/sbin/audit -s<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-001030">The macOS system must configure audit capacity warning.</h2>
    <p>
    <b><a href="#APPL-14-001030">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-001030">APPL-14-001030</a> |
      <b>CCI: </b>CCI-000139&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000046-GPOS-00022">SRG-OS-000046-GPOS-00022</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The audit service must be configured to notify the system administrator<br />                when the amount of free disk space remaining reaches an organization defined value.<br /><br />                This rule ensures that the system administrator is notified in advance that action is required to free<br />                up more disk space for audit logs.<br /><br />                Satisfies: SRG-OS-000046-GPOS-00022,SRG-OS-000343-GPOS-00134
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to require a minimum of 25 percent free disk space<br />                    for audit record storage with the following command:<br /><br />                    /usr/bin/awk -F: '/^minfree/{print $2}' /etc/security/audit_control<br /><br />                    If the result is not "25", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to require a minimum of 25 percent free disk<br />                space for audit record storage with the following command:<br /><br />                /usr/bin/sed -i.bak 's/.*minfree.*/minfree:25/' /etc/security/audit_control; /usr/sbin/audit -s<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-001031">The macOS system must configure audit failure notification.</h2>
    <p>
    <b><a href="#APPL-14-001031">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-001031">APPL-14-001031</a> |
      <b>CCI: </b>CCI-000140&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000047-GPOS-00023">SRG-OS-000047-GPOS-00023</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The audit service must be configured to immediately print messages to the<br />                console or email administrator users when an auditing failure occurs.<br /><br />                It is critical for the appropriate personnel to be made aware immediately if a system is at risk of<br />                failing to process audit logs as required. Without a real-time alert, security personnel may be unaware<br />                of a potentially harmful failure in the auditing system's capability, and system operation may be<br />                adversely affected.<br /><br />                Satisfies: SRG-OS-000047-GPOS-00023,SRG-OS-000344-GPOS-00135
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to produce audit failure notification with the<br />                    following command:<br /><br />                    /usr/bin/grep -c "logger -s -p" /etc/security/audit_warn<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to produce audit failure notification with<br />                the following command:<br /><br />                /usr/bin/sed -i.bak 's/logger -p/logger -s -p/' /etc/security/audit_warn; /usr/sbin/audit -s<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-001044">The macOS system must configure system to audit all authorization and authentication events.</h2>
    <p>
    <b><a href="#APPL-14-001044">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-001044">APPL-14-001044</a> |
      <b>CCI: </b>CCI-000172&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000365-GPOS-00152">SRG-OS-000365-GPOS-00152</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The auditing system must be configured to flag authorization and<br />                authentication (aa) events.<br /><br />                Authentication events contain information about the identity of a user, server, or client. Authorization<br />                events contain information about permissions, rights, and rules. If audit records do not include aa<br />                events, it is difficult to identify incidents and to correlate incidents to subsequent events.<br /><br />                Audit records can be generated from various components within the information system (e.g., via a module<br />                or policy filter).<br /><br />                Satisfies:<br />                SRG-OS-000365-GPOS-00152,SRG-OS-000392-GPOS-00172,SRG-OS-000458-GPOS-00203,SRG-OS-000463-GPOS-00207,SRG-OS-000465-GPOS-00209,SRG-OS-000466-GPOS-00210,SRG-OS-000467-GPOS-00211,SRG-OS-000468-GPOS-00212,SRG-OS-000471-GPOS-00215,SRG-OS-000471-GPOS-00216,SRG-OS-000475-GPOS-00220,SRG-OS-000477-GPOS-00222
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to audit logon events with the following command:<br /><br />                    /usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' |<br />                    /usr/bin/grep -Ec 'aa'<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to audit logon events with the following<br />                command:<br /><br />                /usr/bin/grep -qE "^flags.*[^-]aa" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/<br />                s/$/,aa/' /etc/security/audit_control; /usr/sbin/audit -s<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-001060">The macOS system must set smart card certificate trust to moderate.</h2>
    <p>
    <b><a href="#APPL-14-001060">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-001060">APPL-14-001060</a> |
      <b>CCI: </b>CCI-000185&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000066-GPOS-00034">SRG-OS-000066-GPOS-00034</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS system must be configured to block access to users who are no<br />                longer authorized (i.e., users with revoked certificates).<br /><br />                To prevent the use of untrusted certificates, the certificates on a smart card must meet the following<br />                criteria: its issuer has a system-trusted certificate, the certificate is not expired, its "valid-after"<br />                date is in the past, and it passes Certificate Revocation List (CRL) and Online Certificate Status<br />                Protocol (OCSP) checking.<br /><br />                By setting the smart card certificate trust level to moderate, the system will execute a soft<br />                revocation, i.e., if the OCSP/CRL server is unreachable, authentication will still succeed.<br /><br />                Note: Before applying this setting, refer to the smart card supplemental guidance.<br /><br />                Satisfies:<br />                SRG-OS-000066-GPOS-00034,SRG-OS-000377-GPOS-00162,SRG-OS-000384-GPOS-00167,SRG-OS-000403-GPOS-00182
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to check the revocation status of user certificates<br />                    with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.security.smartcard')\<br />                    .objectForKey('checkCertificateTrust').js<br />                    EOS<br /><br />                    If the result is not "2", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to check the revocation status of user<br />                certificates by installing the "com.apple.security.smartcard" configuration profile.<br /><br />                Note: To ensure continued access to the operating system, consult the supplemental guidance provided<br />                with the STIG before applying the configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-001100">The macOS system must disable root logon for SSH.</h2>
    <p>
    <b><a href="#APPL-14-001100">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-001100">APPL-14-001100</a> |
      <b>CCI: </b>CCI-000770&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000109-GPOS-00056">SRG-OS-000109-GPOS-00056</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          If SSH is enabled to ensure individual accountability and prevent<br />                unauthorized access, logging in as root via SSH must be disabled.<br /><br />                The macOS system must require individuals to be authenticated with an individual authenticator prior to<br />                using a group authenticator, and administrator users must never log in directly as root.<br /><br />                Note: /etc/ssh/sshd_config will be automatically modified to its original state following any update or<br />                major upgrade to the operating system.<br /><br />                Satisfies: SRG-OS-000109-GPOS-00056,SRG-OS-000364-GPOS-00151
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable root login for SSH with the following<br />                    command:<br /><br />                    /usr/sbin/sshd -G | /usr/bin/awk '/permitrootlogin/{print $2}'<br /><br />                    If the result is not "no", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable root login for SSH with the<br />                following command:<br /><br />                include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')<br /><br />                if [[ -z $include_dir ]]; then<br />                /usr/bin/sed -i.bk "1s/.*/Include \/etc\/ssh\/sshd_config.d\/\*/" /etc/ssh/sshd_config<br />                fi<br /><br />                /usr/bin/grep -qxF 'permitrootlogin no' "${include_dir}01-mscp-sshd.conf" 2>/dev/null || echo<br />                "permitrootlogin no" >> "${include_dir}01-mscp-sshd.conf"<br /><br />                for file in $(ls ${include_dir}); do<br />                if [[ "$file" == "100-macos.conf" ]]; then<br />                continue<br />                fi<br />                if [[ "$file" == "01-mscp-sshd.conf" ]]; then<br />                break<br />                fi<br />                /bin/mv ${include_dir}${file} ${include_dir}20-${file}<br />                done<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-001110">The macOS system must configure audit_control group to wheel.</h2>
    <p>
    <b><a href="#APPL-14-001110">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-001110">APPL-14-001110</a> |
      <b>CCI: </b>CCI-000162&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000057-GPOS-00027">SRG-OS-000057-GPOS-00027</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          /etc/security/audit_control must have the group set to wheel.<br /><br />                The audit service must be configured with the correct group ownership to prevent normal users from<br />                manipulation audit log configurations.<br /><br />                Audit logs contain sensitive data about the system and users. If log files are set to be readable and<br />                writable only by system administrators, the risk is mitigated.<br /><br />                Satisfies:<br />                SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000063-GPOS-00032,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured with the audit_control group to wheel with the<br />                    following command:<br /><br />                    /bin/ls -dn /etc/security/audit_control | /usr/bin/awk '{print $4}'<br /><br />                    If the result is not "0", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system with the audit_control group to wheel with<br />                the following command:<br /><br />                /usr/bin/chgrp wheel /etc/security/audit_control<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-001120">The macOS system must configure audit_control owner to root.</h2>
    <p>
    <b><a href="#APPL-14-001120">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-001120">APPL-14-001120</a> |
      <b>CCI: </b>CCI-000162&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000057-GPOS-00027">SRG-OS-000057-GPOS-00027</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          /etc/security/audit_control must have the owner set to root.<br /><br />                The audit service must be configured with the correct ownership to prevent normal users from<br />                manipulation audit log configurations.<br /><br />                Audit logs contain sensitive data about the system and users. If log files are set to be readable and<br />                writable only by system administrators, the risk is mitigated.<br /><br />                Satisfies:<br />                SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000063-GPOS-00032,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured with the audit_control owner to root with the<br />                    following command:<br /><br />                    /bin/ls -dn /etc/security/audit_control | /usr/bin/awk '{print $3}'<br /><br />                    If the result is not "0", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system with the audit_control owner to root with<br />                the following command:<br /><br />                /usr/sbin/chown root /etc/security/audit_control<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-001130">The macOS system must configure audit_control to mode 440 or less permissive.</h2>
    <p>
    <b><a href="#APPL-14-001130">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-001130">APPL-14-001130</a> |
      <b>CCI: </b>CCI-000162&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000057-GPOS-00027">SRG-OS-000057-GPOS-00027</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          /etc/security/audit_control must be configured so that it is readable<br />                only by the root user and group wheel.<br /><br />                Satisfies:<br />                SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000063-GPOS-00032,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured audit_control to mode 440 or less with the<br />                    following command:<br /><br />                    /bin/ls -l /etc/security/audit_control | /usr/bin/awk '!/-r--[r-]-----|current|total/{print $1}' |<br />                    /usr/bin/wc -l | /usr/bin/xargs<br /><br />                    If the results are not "0", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system with the audit_control to mode 440 with the<br />                following command:<br /><br />                /bin/chmod 440 /etc/security/audit_control<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-001140">The macOS system must configure audit_control to not contain access control lists.</h2>
    <p>
    <b><a href="#APPL-14-001140">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-001140">APPL-14-001140</a> |
      <b>CCI: </b>CCI-000162&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000057-GPOS-00027">SRG-OS-000057-GPOS-00027</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          /etc/security/audit_control must not contain Access Control Lists (ACLs).<br /><br />                /etc/security/audit_control contains sensitive configuration data about the audit service. This rule<br />                ensures that the audit service is configured to be readable and writable only by system administrators<br />                in order to prevent normal users from manipulating audit logs.<br /><br />                Satisfies:<br />                SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000063-GPOS-00032,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured without ACLs applied to audit_control with the<br />                    following command:<br /><br />                    /bin/ls -le /etc/security/audit_control | /usr/bin/awk '{print $1}' | /usr/bin/grep -c ":"<br /><br />                    If the result is not "0", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system without ACLs applied to audit_control with<br />                the following command:<br /><br />                /bin/chmod -N /etc/security/audit_control<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-001150">The macOS system must disable password authentication for SSH.</h2>
    <p>
    <b><a href="#APPL-14-001150">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-001150">APPL-14-001150</a> |
      <b>CCI: </b>CCI-000186&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000067-GPOS-00035">SRG-OS-000067-GPOS-00035</a> |
      <b>Severity: </b>high
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          If remote logon through SSH is enabled, password-based authentication<br />                must be disabled for user logon.<br /><br />                All users must go through multifactor authentication to prevent unauthenticated access and potential<br />                compromise to the system.<br /><br />                Note: /etc/ssh/sshd_config will be automatically modified to its original state following any update or<br />                major upgrade to the operating system.<br /><br />                Satisfies:<br />                SRG-OS-000067-GPOS-00035,SRG-OS-000105-GPOS-00052,SRG-OS-000106-GPOS-00053,SRG-OS-000107-GPOS-00054,SRG-OS-000108-GPOS-00055,SRG-OS-000112-GPOS-00057,SRG-OS-000125-GPOS-00065,SRG-OS-000375-GPOS-00160
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable password authentication for SSH with the<br />                    following command:<br /><br />                    /usr/sbin/sshd -G | /usr/bin/grep -Ec<br />                    '^(passwordauthentication\s+no|kbdinteractiveauthentication\s+no)'<br /><br />                    If the result is not "2", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable password authentication for SSH<br />                with the following command:<br /><br />                include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')<br />                if [[ -z $include_dir ]]; then<br />                /usr/bin/sed -i.bk "1s/.*/Include \/etc\/ssh\/sshd_config.d\/\*/" /etc/ssh/sshd_config<br />                fi<br />                echo "passwordauthentication no" >> "${include_dir}01-mscp-sshd.conf"<br />                echo "kbdinteractiveauthentication no" >> "${include_dir}01-mscp-sshd.conf"<br /><br />                for file in $(ls ${include_dir}); do<br />                if [[ "$file" == "100-macos.conf" ]]; then<br />                continue<br />                fi<br />                if [[ "$file" == "01-mscp-sshd.conf" ]]; then<br />                break<br />                fi<br />                /bin/mv ${include_dir}${file} ${include_dir}20-${file}<br />                done<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002001">The macOS system must disable Server Message Block sharing.</h2>
    <p>
    <b><a href="#APPL-14-002001">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002001">APPL-14-002001</a> |
      <b>CCI: </b>CCI-000213&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000080-GPOS-00048">SRG-OS-000080-GPOS-00048</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Support for Server Message Block (SMB) file sharing is nonessential and<br />                must be disabled.<br /><br />                The information system must be configured to provide only essential capabilities.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable Server Message Block sharing with the<br />                    following command:<br /><br />                    /bin/launchctl print-disabled system | /usr/bin/grep -c '"com.apple.smbd" => disabled'<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable Server Message Block sharing with<br />                the following command:<br /><br />                /bin/launchctl disable system/com.apple.smbd<br /><br />                The system may need to be restarted for the update to take effect.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002003">The macOS system must disable Network File System service.</h2>
    <p>
    <b><a href="#APPL-14-002003">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002003">APPL-14-002003</a> |
      <b>CCI: </b>CCI-000213&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000080-GPOS-00048">SRG-OS-000080-GPOS-00048</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Support for Network File Systems (NFS) services is nonessential and,<br />                therefore, must be disabled.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable network file system service with the<br />                    following command:<br /><br />                    /bin/launchctl print-disabled system | /usr/bin/grep -c '"com.apple.nfsd" => disabled'<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable network file system service with<br />                the following command:<br /><br />                /bin/launchctl disable system/com.apple.nfsd<br /><br />                The system may need to be restarted for the update to take effect.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002004">The macOS system must disable Location Services.</h2>
    <p>
    <b><a href="#APPL-14-002004">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002004">APPL-14-002004</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The information system must be configured to provide only essential<br />                capabilities. Disabling Location Services helps prevent the unauthorized connection of devices,<br />                unauthorized transfer of information, and unauthorized tunneling.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable Location Services with the following<br />                    command:<br /><br />                    /usr/bin/sudo -u _locationd /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.locationd')\<br />                    .objectForKey('LocationServicesEnabled').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable Location Services with the<br />                following command:<br /><br />                /usr/bin/defaults write /var/db/locationd/Library/Preferences/ByHost/com.apple.locationd<br />                LocationServicesEnabled -bool false; /bin/launchctl kickstart -k system/com.apple.locationd<br /><br />                The system may need to be restarted for the update to take effect.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002005">The macOS system must disable Bonjour multicast.</h2>
    <p>
    <b><a href="#APPL-14-002005">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002005">APPL-14-002005</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Bonjour multicast advertising must be disabled to prevent the system from<br />                broadcasting its presence and available services over network interfaces.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable Bonjour multicast with the following<br />                    command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.mDNSResponder')\<br />                    .objectForKey('NoMulticastAdvertisements').js<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable Bonjour multicast by installing<br />                the "com.apple.mDNSResponder" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002006">The macOS system must disable Unix-to-Unix Copy Protocol service.</h2>
    <p>
    <b><a href="#APPL-14-002006">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002006">APPL-14-002006</a> |
      <b>CCI: </b>CCI-000213&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000080-GPOS-00048">SRG-OS-000080-GPOS-00048</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The system must not have the Unix-to-Unix Copy Protocol (UUCP) service<br />                active.<br /><br />                UUCP, a set of programs that enable the sending of files between different Unix systems as well as<br />                sending commands to be executed on another system, is not essential and must be disabled in order to<br />                prevent the unauthorized connection of devices, transfer of information, and tunneling.<br /><br />                Note: UUCP service is disabled at startup by default macOS.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable Unix-to-Unix copy protocol service with<br />                    the following command:<br /><br />                    /bin/launchctl print-disabled system | /usr/bin/grep -c '"com.apple.uucp" => disabled'<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable Unix-to-Unix copy protocol<br />                service with the following command:<br /><br />                /bin/launchctl disable system/com.apple.uucp<br /><br />                The system may need to be restarted for the update to take effect.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002007">The macOS system must disable Internet Sharing.</h2>
    <p>
    <b><a href="#APPL-14-002007">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002007">APPL-14-002007</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          If the system does not require Internet Sharing, support for it is<br />                nonessential and must be disabled.<br /><br />                The information system must be configured to provide only essential capabilities. Disabling Internet<br />                sharing helps prevent the unauthorized connection of devices, unauthorized transfer of information, and<br />                unauthorized tunneling.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable Internet Sharing with the following<br />                    command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX')\<br />                    .objectForKey('forceInternetSharingOff').js<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable Internet Sharing by installing<br />                the "com.apple.MCX" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002008">The macOS system must disable the built-in web server.</h2>
    <p>
    <b><a href="#APPL-14-002008">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002008">APPL-14-002008</a> |
      <b>CCI: </b>CCI-000213&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000080-GPOS-00048">SRG-OS-000080-GPOS-00048</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The built-in web server is a nonessential service built into macOS and<br />                must be disabled.<br /><br />                Note: The built in web server service is disabled at startup by default macOS.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable the built-in web server with the<br />                    following command:<br /><br />                    /bin/launchctl print-disabled system | /usr/bin/grep -c '"org.apache.httpd" => disabled'<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable the built-in web server with the<br />                following command:<br /><br />                /bin/launchctl disable system/org.apache.httpd<br /><br />                The system may need to be restarted for the update to take effect.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002009">The macOS system must disable AirDrop.</h2>
    <p>
    <b><a href="#APPL-14-002009">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002009">APPL-14-002009</a> |
      <b>CCI: </b>CCI-000213&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000080-GPOS-00048">SRG-OS-000080-GPOS-00048</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          AirDrop must be disabled to prevent file transfers to or from<br />                unauthorized devices. AirDrop allows users to share and receive files from other nearby Apple devices.<br /><br />                Satisfies: SRG-OS-000080-GPOS-00048,SRG-OS-000095-GPOS-00049,SRG-OS-000300-GPOS-00118
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable AirDrop with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowAirDrop').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable AirDrop by installing the<br />                "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002010">The macOS system must disable FaceTime.app.</h2>
    <p>
    <b><a href="#APPL-14-002010">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002010">APPL-14-002010</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS built-in FaceTime.app must be disabled.<br /><br />                The FaceTime.app establishes a connection to Apple's iCloud service, even when security controls have<br />                been put in place to disable iCloud access.<br /><br />                [IMPORTANT]<br />                ====<br />                Apple has deprecated the use of application restriction controls<br />                (https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.applicationaccess.new.yaml#L67-L70).<br />                Using these controls may not work as expected. Third-party software may be required to fulfill the<br />                compliance requirements.<br />                ====
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable FaceTime.app with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    function run() {<br />                    let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess.new')\<br />                    .objectForKey('familyControlsEnabled'))<br />                    let pathlist = $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess.new')\<br />                    .objectForKey('pathBlackList').js<br />                    for ( let app in pathlist ) {<br />                    if ( ObjC.unwrap(pathlist[app]) == "/Applications/FaceTime.app" && pref1 == true ){<br />                    return("true")<br />                    }<br />                    }<br />                    return("false")<br />                    }<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable FaceTime.app by installing the<br />                "com.apple.applicationaccess.new" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002012">The macOS system must disable the iCloud Calendar services.</h2>
    <p>
    <b><a href="#APPL-14-002012">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002012">APPL-14-002012</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS built-in Calendar.app connection to Apple's iCloud service must<br />                be disabled.<br /><br />                Apple's iCloud service does not provide an organization with enough control over the storage and access<br />                of data and, therefore, automated calendar synchronization must be controlled by an organization<br />                approved service.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable iCloud Calendar services with the<br />                    following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowCloudCalendar').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable iCloud Calendar services by<br />                installing the "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002013">The macOS system must disable iCloud Reminders.</h2>
    <p>
    <b><a href="#APPL-14-002013">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002013">APPL-14-002013</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS built-in Reminders.app connection to Apple's iCloud service<br />                must be disabled.<br /><br />                Apple's iCloud service does not provide an organization with enough control over the storage and access<br />                of data and, therefore, automated reminders synchronization must be controlled by an organization<br />                approved service.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable iCloud Reminders with the following<br />                    command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowCloudReminders').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable iCloud Reminders by installing<br />                the "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002014">The macOS system must disable iCloud Address Book.</h2>
    <p>
    <b><a href="#APPL-14-002014">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002014">APPL-14-002014</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS built-in Contacts.app connection to Apple's iCloud service must<br />                be disabled.<br /><br />                Apple's iCloud service does not provide an organization with enough control over the storage and access<br />                of data, and, therefore, automated contact synchronization must be controlled by an organization<br />                approved service.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable iCloud Address Book with the following<br />                    command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowCloudAddressBook').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable iCloud Address Book by installing<br />                the "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002015">The macOS system must disable iCloud Mail.</h2>
    <p>
    <b><a href="#APPL-14-002015">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002015">APPL-14-002015</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS built-in Mail.app connection to Apple's iCloud service must be<br />                disabled.<br /><br />                Apple's iCloud service does not provide an organization with enough control over the storage and access<br />                of data and, therefore, automated mail synchronization must be controlled by an organization approved<br />                service.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable iCloud Mail with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowCloudMail').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable iCloud Mail by installing the<br />                "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002016">The macOS system must disable iCloud Notes.</h2>
    <p>
    <b><a href="#APPL-14-002016">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002016">APPL-14-002016</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS built-in Notes.app connection to Apple's iCloud service must be<br />                disabled.<br /><br />                Apple's iCloud service does not provide an organization with enough control over the storage and access<br />                of data and, therefore, automated Notes synchronization must be controlled by an organization approved<br />                service.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable iCloud Notes with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowCloudNotes').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable iCloud Notes by installing the<br />                "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002017">The macOS system must disable the camera.</h2>
    <p>
    <b><a href="#APPL-14-002017">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002017">APPL-14-002017</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          macOS must be configured to disable the camera.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable the camera with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowCamera').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable the camera by installing the<br />                "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002020">The macOS system must disable Siri.</h2>
    <p>
    <b><a href="#APPL-14-002020">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002020">APPL-14-002020</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Support for Siri is nonessential and must be disabled.<br /><br />                The information system must be configured to provide only essential capabilities.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable Siri with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowAssistant').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable Siri by installing the<br />                "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002021">The macOS system must disable sending diagnostic and usage data to Apple.</h2>
    <p>
    <b><a href="#APPL-14-002021">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002021">APPL-14-002021</a> |
      <b>CCI: </b>CCI-001312&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000205-GPOS-00083">SRG-OS-000205-GPOS-00083</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The ability to submit diagnostic data to Apple must be disabled.<br /><br />                The information system must be configured to provide only essential capabilities. Disabling the<br />                submission of diagnostic and usage information will mitigate the risk of unwanted data being sent to<br />                Apple.<br /><br />                Satisfies: SRG-OS-000205-GPOS-00083,SRG-OS-000206-GPOS-00084
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable sending diagnostic and usage data to<br />                    Apple with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    function run() {<br />                    let pref1 = $.NSUserDefaults.alloc.initWithSuiteName('com.apple.SubmitDiagInfo')\<br />                    .objectForKey('AutoSubmit').js<br />                    let pref2 = $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowDiagnosticSubmission').js<br />                    if ( pref1 == false && pref2 == false ){<br />                    return("true")<br />                    } else {<br />                    return("false")<br />                    }<br />                    }<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable sending diagnostic and usage data<br />                to Apple by installing the "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002022">The macOS system must disable Remote Apple Events.</h2>
    <p>
    <b><a href="#APPL-14-002022">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002022">APPL-14-002022</a> |
      <b>CCI: </b>CCI-000213&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000080-GPOS-00048">SRG-OS-000080-GPOS-00048</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          If the system does not require Remote Apple Events, support for Apple<br />                Remote Events is nonessential and must be disabled.<br /><br />                The information system must be configured to provide only essential capabilities. Disabling Remote Apple<br />                Events helps prevent the unauthorized connection of devices, the unauthorized transfer of information,<br />                and unauthorized tunneling.<br /><br />                Satisfies: SRG-OS-000080-GPOS-00048,SRG-OS-000096-GPOS-00050
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable Remote Apple Events with the following<br />                    command:<br /><br />                    /bin/launchctl print-disabled system | /usr/bin/grep -c '"com.apple.AEServer" => disabled'<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable Remote Apple Events with the<br />                following commands:<br /><br />                /usr/sbin/systemsetup -setremoteappleevents off<br />                /bin/launchctl disable system/com.apple.AEServer<br /><br />                Note: Systemsetup with -setremoteappleevents flag will fail unless Full Disk Access to systemsetup or<br />                its parent process is granted. This requires supervision.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002035">The macOS system must disable Apple ID setup during Setup Assistant.</h2>
    <p>
    <b><a href="#APPL-14-002035">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002035">APPL-14-002035</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The prompt for Apple ID setup during Setup Assistant must be disabled.<br /><br />                macOS will automatically prompt new users to set up an Apple ID while they are going through Setup<br />                Assistant if this is not disabled, misleading new users to think they need to create Apple ID accounts<br />                upon their first log on.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable Apple ID setup during Setup Assistant<br />                    with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.SetupAssistant.managed')\<br />                    .objectForKey('SkipCloudSetup').js<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable Apple ID setup during Setup<br />                Assistant by installing the "com.apple.SetupAssistant.managed" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002036">The macOS system must disable Privacy Setup services during Setup Assistant.</h2>
    <p>
    <b><a href="#APPL-14-002036">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002036">APPL-14-002036</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The prompt for Privacy Setup services during Setup Assistant must be<br />                disabled.<br /><br />                Organizations must apply organizationwide configuration settings. The macOS Privacy Setup services<br />                prompt guides new users through enabling their own specific privacy settings; this is not essential and,<br />                therefore, must be disabled to prevent against the risk of individuals electing privacy settings with<br />                the potential to override organizationwide settings.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable Privacy Setup services during Setup<br />                    Assistant with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.SetupAssistant.managed')\<br />                    .objectForKey('SkipPrivacySetup').js<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable Privacy Setup services during<br />                Setup Assistant by installing the "com.apple.SetupAssistant.managed" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002037">The macOS system must disable iCloud Storage Setup during Setup Assistant.</h2>
    <p>
    <b><a href="#APPL-14-002037">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002037">APPL-14-002037</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The prompt to set up iCloud storage services during Setup Assistant must<br />                be disabled.<br /><br />                The default behavior of macOS is to prompt new users to set up storage in iCloud. Disabling the iCloud<br />                storage setup prompt provides organizations more control over the storage of their data.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable iCloud Storage Setup during Setup<br />                    Assistant with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.SetupAssistant.managed')\<br />                    .objectForKey('SkipiCloudStorageSetup').js<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable iCloud Storage Setup during Setup<br />                Assistant by installing the "com.apple.SetupAssistant.managed" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002038">The macOS system must disable Trivial File Transfer Protocol service.</h2>
    <p>
    <b><a href="#APPL-14-002038">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002038">APPL-14-002038</a> |
      <b>CCI: </b>CCI-000197&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000074-GPOS-00042">SRG-OS-000074-GPOS-00042</a> |
      <b>Severity: </b>high
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          If the system does not require Trivial File Transfer Protocol (TFTP),<br />                support it is nonessential and must be disabled.<br /><br />                The information system must be configured to provide only essential capabilities. Disabling TFTP helps<br />                prevent the unauthorized connection of devices and the unauthorized transfer of information.<br /><br />                Note: TFTP service is disabled at startup by default macOS.<br /><br />                Satisfies: SRG-OS-000074-GPOS-00042,SRG-OS-000080-GPOS-00048
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable trivial file transfer protocol service<br />                    with the following command:<br /><br />                    /bin/launchctl print-disabled system | /usr/bin/grep -c '"com.apple.tftpd" => disabled'<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable trivial file transfer protocol<br />                service with the following command:<br /><br />                /bin/launchctl disable system/com.apple.tftpd<br /><br />                The system may need to be restarted for the update to take effect.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002039">The macOS system must disable Siri Setup during Setup Assistant.</h2>
    <p>
    <b><a href="#APPL-14-002039">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002039">APPL-14-002039</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The prompt for Siri during Setup Assistant must be disabled.<br /><br />                Organizations must apply organizationwide configuration settings. The macOS Siri Assistant Setup prompt<br />                guides new users through enabling their own specific Siri settings; this is not essential and,<br />                therefore, must be disabled to prevent against the risk of individuals electing Siri settings with the<br />                potential to override organizationwide settings.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable Siri Setup during Setup Assistant with<br />                    the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.SetupAssistant.managed')\<br />                    .objectForKey('SkipSiriSetup').js<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable Siri Setup during Setup Assistant<br />                by installing the "com.apple.SetupAssistant.managed" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002040">The macOS system must disable iCloud Keychain synchronization.</h2>
    <p>
    <b><a href="#APPL-14-002040">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002040">APPL-14-002040</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS system's ability to automatically synchronize a user's<br />                passwords to their iCloud account must be disabled.<br /><br />                Apple's iCloud service does not provide an organization with enough control over the storage and access<br />                of data and, therefore, password management and synchronization must be controlled by an organization<br />                approved service.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable iCloud Keychain synchronization with the<br />                    following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowCloudKeychainSync').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable iCloud Keychain synchronization<br />                by installing the "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002041">The macOS system must disable iCloud Document synchronization.</h2>
    <p>
    <b><a href="#APPL-14-002041">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002041">APPL-14-002041</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS built-in iCloud document synchronization service must be<br />                disabled to prevent organizational data from being synchronized to personal or nonapproved storage.<br /><br />                Apple's iCloud service does not provide an organization with enough control over the storage and access<br />                of data and, therefore, automated document synchronization must be controlled by an organization<br />                approved service.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable iCloud Document synchronization with the<br />                    following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowCloudDocumentSync').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable iCloud Document synchronization<br />                by installing the "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002042">The macOS system must disable iCloud Bookmarks.</h2>
    <p>
    <b><a href="#APPL-14-002042">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002042">APPL-14-002042</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS built-in Safari.app bookmark synchronization via the iCloud<br />                service must be disabled.<br /><br />                Apple's iCloud service does not provide an organization with enough control over the storage and access<br />                of data and, therefore, automated bookmark synchronization must be controlled by an organization<br />                approved service.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable iCloud Bookmarks with the following<br />                    command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowCloudBookmarks').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable iCloud Bookmarks by installing<br />                the "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002043">The macOS system must disable iCloud Photo Library.</h2>
    <p>
    <b><a href="#APPL-14-002043">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002043">APPL-14-002043</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS built-in Photos.app connection to Apple's iCloud service must<br />                be disabled.<br /><br />                Apple's iCloud service does not provide an organization with enough control over the storage and access<br />                of data and, therefore, automated photo synchronization must be controlled by an organization approved<br />                service.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable the iCloud Photo Library with the<br />                    following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowCloudPhotoLibrary').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable the iCloud Photo Library by<br />                installing the "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002050">The macOS system must disable Screen Sharing and Apple Remote Desktop.</h2>
    <p>
    <b><a href="#APPL-14-002050">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002050">APPL-14-002050</a> |
      <b>CCI: </b>CCI-000213&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000080-GPOS-00048">SRG-OS-000080-GPOS-00048</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Support for both Screen Sharing and Apple Remote Desktop (ARD) is<br />                nonessential and must be disabled.<br /><br />                The information system must be configured to provide only essential capabilities. Disabling screen<br />                sharing and ARD helps prevent the unauthorized connection of devices, the unauthorized transfer of<br />                information, and unauthorized tunneling.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable Screen Sharing and Apple Remote Desktop<br />                    with the following command:<br /><br />                    /bin/launchctl print-disabled system | /usr/bin/grep -c '"com.apple.screensharing" => disabled'<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable Screen Sharing and Apple Remote<br />                Desktop with the following command:<br /><br />                /bin/launchctl disable system/com.apple.screensharing<br /><br />                The system may need to be restarted for the update to take effect.<br />                Note: This will apply to the whole system.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002051">The macOS system must disable the TouchID System Settings pane.</h2>
    <p>
    <b><a href="#APPL-14-002051">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002051">APPL-14-002051</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The System Settings pane for TouchID must be disabled.<br /><br />                Disabling the System Settings pane prevents the users from configuring TouchID.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable the TouchID System Settings pane with<br />                    the following command:<br /><br />                    /usr/bin/profiles show -output stdout-xml | /usr/bin/xmllint --xpath<br />                    '//key[text()="DisabledSystemSettings"]/following-sibling::*[1]' - | /usr/bin/grep -c<br />                    "com.apple.Touch-ID-Settings.extension"<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable the TouchID System Settings pane<br />                by installing the "com.apple.systempreferences" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002052">The macOS system must disable the System Settings pane for Wallet and Apple Pay.</h2>
    <p>
    <b><a href="#APPL-14-002052">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002052">APPL-14-002052</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The System Settings pane for Wallet and Apple Pay must be disabled.<br /><br />                Disabling the System Settings pane prevents the users from configuring Wallet and Apple Pay.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable the System Settings pane for Wallet and<br />                    Apple Pay with the following command:<br /><br />                    /usr/bin/profiles show -output stdout-xml | /usr/bin/xmllint --xpath<br />                    '//key[text()="DisabledSystemSettings"]/following-sibling::*[1]' - | /usr/bin/grep -c<br />                    "com.apple.WalletSettingsExtension"<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable the System Settings pane for<br />                Wallet and Apple Pay by installing the "com.apple.systempreferences" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002053">The macOS system must disable the system settings pane for Siri.</h2>
    <p>
    <b><a href="#APPL-14-002053">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002053">APPL-14-002053</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The System Settings pane for Siri must be hidden.<br /><br />                Hiding the System Settings pane prevents the users from configuring Siri.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable the system settings pane for Siri with<br />                    the following command:<br /><br />                    /usr/bin/profiles show -output stdout-xml | /usr/bin/xmllint --xpath<br />                    '//key[text()="DisabledSystemSettings"]/following-sibling::*[1]' - | /usr/bin/grep -c<br />                    com.apple.Siri-Settings.extension<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable the system settings pane for Siri<br />                by installing the "com.apple.systempreferences" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002060">The macOS system must apply gatekeeper settings to block applications from unidentified developers.
            </h2>
    <p>
    <b><a href="#APPL-14-002060">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002060">APPL-14-002060</a> |
      <b>CCI: </b>CCI-001749&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000366-GPOS-00153">SRG-OS-000366-GPOS-00153</a> |
      <b>Severity: </b>high
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The information system implements cryptographic mechanisms to<br />                authenticate software prior to installation.<br /><br />                Gatekeeper settings must be configured correctly to only allow the system to run applications downloaded<br />                from the Mac App Store or applications signed with a valid Apple Developer ID code. Administrator users<br />                will still have the option to override these settings on a per-app basis. Gatekeeper is a security<br />                feature that ensures that applications must be digitally signed by an Apple-issued certificate in order<br />                to run. Digital signatures allow the macOS to verify that the application has not been modified by a<br />                malicious third party.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to apply gatekeeper settings to block applications<br />                    from unidentified developers with the following command:<br /><br />                    /usr/sbin/spctl --status --verbose | /usr/bin/grep -c "developer id enabled"<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to apply gatekeeper settings to block<br />                applications from unidentified developers with the following command:<br /><br />                /usr/sbin/spctl --global-enable; /usr/sbin/spctl --enable<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002062">The macOS system must disable Bluetooth when no approved device is connected.</h2>
    <p>
    <b><a href="#APPL-14-002062">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002062">APPL-14-002062</a> |
      <b>CCI: </b>CCI-002418&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000423-GPOS-00187">SRG-OS-000423-GPOS-00187</a> |
      <b>Severity: </b>high
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS system must be configured to disable Bluetooth unless an<br />                approved device is connected.<br /><br />                [IMPORTANT]<br />                ====<br />                Information system security officers (ISSOs) may make the risk-based decision not to disable Bluetooth<br />                to maintain necessary functionality, but they are advised to first fully weigh the potential risks posed<br />                to their organization.<br />                ====<br /><br />                Satisfies: SRG-OS-000423-GPOS-00187,SRG-OS-000481-GPOS-00481
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable Bluetooth with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCXBluetooth')\<br />                    .objectForKey('DisableBluetooth').js<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable Bluetooth by installing the<br />                "com.apple.MCXBluetooth" configuration profiles.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002063">The macOS system must disable the guest account.</h2>
    <p>
    <b><a href="#APPL-14-002063">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002063">APPL-14-002063</a> |
      <b>CCI: </b>CCI-001813&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000364-GPOS-00151">SRG-OS-000364-GPOS-00151</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Guest access must be disabled.<br /><br />                Turning off guest access prevents anonymous users from accessing files.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable the guest account with the following<br />                    command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    function run() {<br />                    let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX')\<br />                    .objectForKey('DisableGuestAccount'))<br />                    let pref2 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX')\<br />                    .objectForKey('EnableGuestAccount'))<br />                    if ( pref1 == true && pref2 == false ) {<br />                    return("true")<br />                    } else {<br />                    return("false")<br />                    }<br />                    }<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable the guest account by installing<br />                the "com.apple.MCX" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002064">The macOS system must enable Gatekeeper.</h2>
    <p>
    <b><a href="#APPL-14-002064">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002064">APPL-14-002064</a> |
      <b>CCI: </b>CCI-001749&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000366-GPOS-00153">SRG-OS-000366-GPOS-00153</a> |
      <b>Severity: </b>high
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Gatekeeper must be enabled.<br /><br />                Gatekeeper is a security feature that ensures applications are digitally signed by an Apple-issued<br />                certificate before they are permitted to run. Digital signatures allow the macOS host to verify that the<br />                application has not been modified by a malicious third party.<br /><br />                Administrator users will still have the option to override these settings on a case-by-case basis.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to enable gatekeeper with the following command:<br /><br />                    /usr/sbin/spctl --status | /usr/bin/grep -c "assessments enabled"<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to enable gatekeeper with the following<br />                command:<br /><br />                /usr/sbin/spctl --global-enable<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002066">The macOS system must disable unattended or automatic log on to the system.</h2>
    <p>
    <b><a href="#APPL-14-002066">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002066">APPL-14-002066</a> |
      <b>CCI: </b>CCI-000366&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000480-GPOS-00229">SRG-OS-000480-GPOS-00229</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Automatic logon must be disabled.<br /><br />                When automatic logons are enabled, the default user account is automatically logged on at boot time<br />                without prompting the user for a password. Even if the screen is later locked, a malicious user would be<br />                able to reboot the computer and find it already logged in. Disabling automatic logons mitigates this<br />                risk.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable unattended or automatic logon to the<br />                    system with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\<br />                    .objectForKey('com.apple.login.mcx.DisableAutoLoginClient').js<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable unattended or automatic logon to<br />                the system by installing the "com.apple.loginwindow" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002068">The macOS system must secure user's home folders.</h2>
    <p>
    <b><a href="#APPL-14-002068">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002068">APPL-14-002068</a> |
      <b>CCI: </b>CCI-000366&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000480-GPOS-00230">SRG-OS-000480-GPOS-00230</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The system must be configured to prevent access to other user's home<br />                folders.<br /><br />                The default behavior of macOS is to allow all valid users access to the top level of every other user's<br />                home folder while restricting access only to the Apple default folders within.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured so that permissions are set correctly on user home<br />                    directories with the following command:<br /><br />                    /usr/bin/find /System/Volumes/Data/Users -mindepth 1 -maxdepth 1 -type d ! \( -perm 700 -o -perm 711<br />                    \) | /usr/bin/grep -v "Shared" | /usr/bin/grep -v "Guest" | /usr/bin/wc -l | /usr/bin/xargs<br /><br />                    If the result is not "0", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to set the appropriate permissions for each<br />                user on the system with the following command:<br /><br />                IFS=$'\n'<br />                for userDirs in $( /usr/bin/find /System/Volumes/Data/Users -mindepth 1 -maxdepth 1 -type d ! \( -perm<br />                700 -o -perm 711 \) | /usr/bin/grep -v "Shared" | /usr/bin/grep -v "Guest" ); do<br />                /bin/chmod og-rwx "$userDirs"<br />                done<br />                unset IFS<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002069">The macOS system must require administrator privileges to modify systemwide settings.</h2>
    <p>
    <b><a href="#APPL-14-002069">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002069">APPL-14-002069</a> |
      <b>CCI: </b>CCI-002235&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000324-GPOS-00125">SRG-OS-000324-GPOS-00125</a> |
      <b>Severity: </b>high
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The system must be configured to require an administrator password in<br />                order to modify the systemwide preferences in System Settings.<br /><br />                Some Preference Panes in System Settings contain settings that affect the entire system. Requiring a<br />                password to unlock these systemwide settings reduces the risk of a nonauthorized user modifying system<br />                configurations.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to require administrator privileges to modify<br />                    systemwide settings with the following command:<br /><br />                    authDBs=("system.preferences" "system.preferences.energysaver" "system.preferences.network"<br />                    "system.preferences.printing" "system.preferences.sharing" "system.preferences.softwareupdate"<br />                    "system.preferences.startupdisk" "system.preferences.timemachine")<br />                    result="1"<br />                    for section in ${authDBs[@]}; do<br />                    if [[ $(/usr/bin/security -q authorizationdb read "$section" | /usr/bin/xmllint -xpath<br />                    'name(//*[contains(text(), "shared")]/following-sibling::*[1])' -) != "false" ]]; then<br />                    result="0"<br />                    fi<br />                    done<br />                    echo $result<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to require administrator privileges to<br />                modify systemwide settings with the following command:<br /><br />                authDBs=("system.preferences" "system.preferences.energysaver" "system.preferences.network"<br />                "system.preferences.printing" "system.preferences.sharing" "system.preferences.softwareupdate"<br />                "system.preferences.startupdisk" "system.preferences.timemachine")<br /><br />                for section in ${authDBs[@]}; do<br />                /usr/bin/security -q authorizationdb read "$section" > "/tmp/$section.plist"<br />                key_value=$(/usr/libexec/PlistBuddy -c "Print :shared" "/tmp/$section.plist" 2>&1)<br />                if [[ "$key_value" == *"Does Not Exist"* ]]; then<br />                /usr/libexec/PlistBuddy -c "Add :shared bool false" "/tmp/$section.plist"<br />                else<br />                /usr/libexec/PlistBuddy -c "Set :shared false" "/tmp/$section.plist"<br />                fi<br />                /usr/bin/security -q authorizationdb write "$section" < "/tmp/$section.plist"<br />                done<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002080">The macOS system must disable Airplay Receiver.</h2>
    <p>
    <b><a href="#APPL-14-002080">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002080">APPL-14-002080</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Airplay Receiver allows users to send content from another Apple device<br />                to be displayed on the screen as it is being played from another device.<br /><br />                Support for Airplay Receiver is nonessential and must be disabled.<br /><br />                The information system must be configured to provide only essential capabilities.<br /><br />                Satisfies: SRG-OS-000095-GPOS-00049,SRG-OS-000300-GPOS-00118
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable Airplay Receiver with the following<br />                    command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowAirPlayIncomingRequests').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable Airplay Receiver by installing<br />                the "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002090">The macOS system must disable TouchID for unlocking the device.</h2>
    <p>
    <b><a href="#APPL-14-002090">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002090">APPL-14-002090</a> |
      <b>CCI: </b>CCI-000056&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000028-GPOS-00009">SRG-OS-000028-GPOS-00009</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          TouchID enables the ability to unlock a macOS system with a user's<br />                fingerprint.<br /><br />                TouchID must be disabled for "Unlocking your Mac" on all macOS devices that are capable of using<br />                TouchID.<br /><br />                The system must remain locked until the user establishes access using an authorized identification and<br />                authentication method.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable TouchID for unlocking the device with<br />                    the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowFingerprintForUnlock').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable TouchID for unlocking the device<br />                by installing the "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002100">The macOS system must disable Media Sharing.</h2>
    <p>
    <b><a href="#APPL-14-002100">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002100">APPL-14-002100</a> |
      <b>CCI: </b>CCI-000213&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000080-GPOS-00048">SRG-OS-000080-GPOS-00048</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Media sharing must be disabled.<br /><br />                When Media Sharing is enabled, the computer starts a network listening service that shares the contents<br />                of the user's music collection with other users in the same subnet.<br /><br />                The information system must be configured to provide only essential capabilities. Disabling Media<br />                Sharing helps prevent the unauthorized connection of devices and the unauthorized transfer of<br />                information. Disabling Media Sharing mitigates this risk.<br /><br />                Note: The Media Sharing preference panel will still allow "Home Sharing" and "Share media with guests"<br />                to be checked but the service will not be enabled.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable media sharing with the following<br />                    command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    function run() {<br />                    let pref1 =<br />                    ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.preferences.sharing.SharingPrefsExtension')\<br />                    .objectForKey('homeSharingUIStatus'))<br />                    let pref2 =<br />                    ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.preferences.sharing.SharingPrefsExtension')\<br />                    .objectForKey('legacySharingUIStatus'))<br />                    let pref3 =<br />                    ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.preferences.sharing.SharingPrefsExtension')\<br />                    .objectForKey('mediaSharingUIStatus'))<br />                    if ( pref1 == 0 && pref2 == 0 && pref3 == 0 ) {<br />                    return("true")<br />                    } else {<br />                    return("false")<br />                    }<br />                    }<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable media sharing by installing the<br />                "com.apple.preferences.sharing.SharingPrefsExtension" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002110">The macOS system must disable Bluetooth sharing.</h2>
    <p>
    <b><a href="#APPL-14-002110">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002110">APPL-14-002110</a> |
      <b>CCI: </b>CCI-000213&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000080-GPOS-00048">SRG-OS-000080-GPOS-00048</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Bluetooth Sharing must be disabled.<br /><br />                Bluetooth Sharing allows users to wirelessly transmit files between the macOS and Bluetooth-enabled<br />                devices, including personally owned cellphones and tablets. A malicious user might introduce viruses or<br />                malware onto the system or extract sensitive files via Bluetooth Sharing. When Bluetooth Sharing is<br />                disabled, this risk is mitigated.<br /><br />                [NOTE]<br />                ====<br />                The check and fix are for the currently logged on user. To get the currently logged on user, run the<br />                following.<br />                [source,bash]<br />                ----<br />                CURRENT_USER=$( /usr/sbin/scutil <<< "show State:/Users/ConsoleUser" | /usr/bin/awk '/Name :/<br />                && ! /loginwindow/ { print $3 }' )<br />                ----<br />                ====<br /><br />                Satisfies: SRG-OS-000080-GPOS-00048,SRG-OS-000095-GPOS-00049
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable Bluetooth sharing with the following<br />                    command:<br /><br />                    /usr/bin/sudo -u "$CURRENT_USER" /usr/bin/defaults -currentHost read com.apple.Bluetooth<br />                    PrefKeyServicesEnabled<br /><br />                    If the result is not "0", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable Bluetooth sharing with the<br />                following command:<br /><br />                /usr/bin/sudo -u "$CURRENT_USER" /usr/bin/defaults -currentHost write com.apple.Bluetooth<br />                PrefKeyServicesEnabled -bool false<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002120">The macOS system must disable AppleID and Internet Account modifications.</h2>
    <p>
    <b><a href="#APPL-14-002120">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002120">APPL-14-002120</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The system must disable account modification.<br /><br />                Account modification includes adding additional or modifying internet accounts in Apple Mail, Calendar,<br />                Contacts, in the Internet Account System Setting Pane, or the AppleID System Setting Pane.<br /><br />                This prevents the addition of unauthorized accounts.<br /><br />                [IMPORTANT]<br />                ====<br />                Some organizations may allow the use and configuration of the built-in Mail.app, Calendar.app, and<br />                Contacts.app for organizational communication. Information system security officers (ISSOs) may make the<br />                risk-based decision not to disable the Internet Accounts System Preference pane to avoid losing this<br />                functionality, but they are advised to first fully weigh the potential risks posed to their<br />                organization.<br />                ====
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable account modification with the following<br />                    command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowAccountModification').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable account modification by<br />                installing the "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002130">The macOS system must disable CD/DVD Sharing.</h2>
    <p>
    <b><a href="#APPL-14-002130">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002130">APPL-14-002130</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          CD/DVD Sharing must be disabled.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable CD/DVD Sharing with the following<br />                    command:<br /><br />                    /usr/bin/pgrep -q ODSAgent; /bin/echo $?<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable CD/DVD Sharing with the following<br />                command:<br /><br />                /bin/launchctl unload /System/Library/LaunchDaemons/com.apple.ODSAgent.plist<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002140">The macOS system must disable content caching service.</h2>
    <p>
    <b><a href="#APPL-14-002140">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002140">APPL-14-002140</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Content caching must be disabled.<br /><br />                Content caching is a macOS service that helps reduce internet data usage and speed up software<br />                installation on Mac computers. It is not recommended for devices furnished to employees to act as a<br />                caching server.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable content caching service with the<br />                    following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowContentCaching').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable content caching service by<br />                installing the "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002150">The macOS system must disable iCloud desktop and document folder synchronization.</h2>
    <p>
    <b><a href="#APPL-14-002150">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002150">APPL-14-002150</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS system's ability to automatically synchronize a user's desktop<br />                and documents folder to their iCloud Drive must be disabled.<br /><br />                Apple's iCloud service does not provide an organization with enough control over the storage and access<br />                of data and, therefore, automated file synchronization must be controlled by an organization approved<br />                service.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable iCloud desktop and document folder<br />                    synchronization with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowCloudDesktopAndDocuments').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable iCloud desktop and document<br />                folder synchronization by installing the "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002160">The macOS system must disable iCloud Game Center.</h2>
    <p>
    <b><a href="#APPL-14-002160">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002160">APPL-14-002160</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          This works only with supervised devices (MDM) and allows Apple Game<br />                Center to be disabled. The rationale is Game Center is using Apple ID and will share data on<br />                AppleID-based services; therefore, Game Center must be disabled. This setting also prohibits the<br />                functionality of adding friends to Game Center.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable iCloud Game Center with the following<br />                    command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowGameCenter').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable iCloud Game Center by installing<br />                the "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002170">The macOS system must disable iCloud Private Relay.</h2>
    <p>
    <b><a href="#APPL-14-002170">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002170">APPL-14-002170</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Enterprise networks may be required to audit all network traffic by<br />                policy; therefore, iCloud Private Relay must be disabled.<br /><br />                Network administrators can also prevent the use of this feature by blocking DNS resolution of<br />                mask.icloud.com and mask-h2.icloud.com.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable the iCloud Private Relay with the<br />                    following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowCloudPrivateRelay').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable the iCloud Private Relay by<br />                installing the "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002180">The macOS system must disable Find My service.</h2>
    <p>
    <b><a href="#APPL-14-002180">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002180">APPL-14-002180</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The Find My service must be disabled.<br /><br />                A Mobile Device Management (MDM) solution must be used to carry out remote locking and wiping instead of<br />                Apple's Find My service.<br /><br />                Apple's Find My service uses a personal AppleID for authentication. Organizations should rely on MDM<br />                solutions, which have much more secure authentication requirements, to perform remote lock and remote<br />                wipe.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable Find My service with the following<br />                    command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    function run() {<br />                    let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowFindMyDevice'))<br />                    let pref2 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowFindMyFriends'))<br />                    let pref3 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.icloud.managed')\<br />                    .objectForKey('DisableFMMiCloudSetting'))<br />                    if ( pref1 == false && pref2 == false && pref3 == true ) {<br />                    return("true")<br />                    } else {<br />                    return("false")<br />                    }<br />                    }<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable Find My service by installing the<br />                "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002190">The macOS system must disable password autofill.</h2>
    <p>
    <b><a href="#APPL-14-002190">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002190">APPL-14-002190</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Password Autofill must be disabled.<br /><br />                macOS allows users to save passwords and use the Password Autofill feature in Safari and compatible<br />                apps. To protect against malicious users gaining access to the system, this feature must be disabled to<br />                prevent users from being prompted to save passwords in applications.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable password autofill with the following<br />                    command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowPasswordAutoFill').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable password autofill by installing<br />                the "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002200">The macOS system must disable personalized advertising.</h2>
    <p>
    <b><a href="#APPL-14-002200">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002200">APPL-14-002200</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Ad tracking and targeted ads must be disabled.<br /><br />                The information system must be configured to provide only essential capabilities. Disabling ad tracking<br />                ensures that applications and advertisers are unable to track users' interests and deliver targeted<br />                advertisements.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable personalized advertising with the<br />                    following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowApplePersonalizedAdvertising').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable personalized advertising by<br />                installing the "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002210">The macOS system must disable sending Siri and Dictation information to Apple.</h2>
    <p>
    <b><a href="#APPL-14-002210">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002210">APPL-14-002210</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The ability for Apple to store and review audio of Siri and Dictation<br />                interactions must be disabled.<br /><br />                The information system must be configured to provide only essential capabilities. Disabling the<br />                submission of Siri and Dictation information will mitigate the risk of unwanted data being sent to<br />                Apple.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable sending Siri and Dictation information<br />                    to Apple with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.assistant.support')\<br />                    .objectForKey('Siri Data Sharing Opt-In Status').js<br />                    EOS<br /><br />                    If the result is not "2", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable sending Siri and Dictation<br />                information to Apple by installing the "com.apple.assistant.support" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002220">The macOS system must enforce on device dictation.</h2>
    <p>
    <b><a href="#APPL-14-002220">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002220">APPL-14-002220</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Dictation must be restricted to on device only to prevent potential data<br />                exfiltration.<br /><br />                The information system must be configured to provide only essential capabilities.
        </div>
        <div class="span1">
          <h3>Check</h3>
          For Intel-based systems, this is not applicable.<br /><br />                    Verify the macOS system is configured to enforce on device dictation with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('forceOnDeviceOnlyDictation').js<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to enforce on device dictation by installing<br />                the "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002230">The macOS system must disable dictation.</h2>
    <p>
    <b><a href="#APPL-14-002230">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002230">APPL-14-002230</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Dictation must be disabled on Intel-based Macs as the feature On Device<br />                Dictation is only available on Apple Silicon devices.
        </div>
        <div class="span1">
          <h3>Check</h3>
          For Apple Silicon-based systems, this is not applicable.<br /><br />                    Verify the macOS system is configured to disable dictation with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowDictation').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable dictation by installing the<br />                "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002240">The macOS system must disable Printer Sharing.</h2>
    <p>
    <b><a href="#APPL-14-002240">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002240">APPL-14-002240</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Printer Sharing must be disabled.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable Printer Sharing with the following<br />                    command:<br /><br />                    /usr/sbin/cupsctl | /usr/bin/grep -c "_share_printers=0"<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable Printer Sharing with the<br />                following commands:<br /><br />                /usr/sbin/cupsctl --no-share-printers<br />                /usr/bin/lpstat -p | awk '{print $2}'| /usr/bin/xargs -I{} lpadmin -p {} -o printer-is-shared=false<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002250">The macOS system must disable Remote Management.</h2>
    <p>
    <b><a href="#APPL-14-002250">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002250">APPL-14-002250</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Remote Management must be disabled.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable Remote Management with the following<br />                    command:<br /><br />                    /usr/libexec/mdmclient QuerySecurityInfo | /usr/bin/grep -c "RemoteDesktopEnabled = 0"<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable Remote Management with the<br />                following commands:<br /><br />                /System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/Resources/kickstart -deactivate<br />                -stop<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002260">The macOS system must disable the Bluetooth system settings pane.</h2>
    <p>
    <b><a href="#APPL-14-002260">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002260">APPL-14-002260</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The Bluetooth System Setting pane must be disabled to prevent access to<br />                the Bluetooth configuration.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable the Bluetooth system settings pane with<br />                    the following command:<br /><br />                    /usr/bin/profiles show -output stdout-xml | /usr/bin/xmllint --xpath<br />                    '//key[text()="DisabledSystemSettings"]/following-sibling::*[1]' - | /usr/bin/grep -c<br />                    com.apple.BluetoothSettings<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable the Bluetooth system settings<br />                pane by installing the "com.apple.systempreferences" configuration profiles.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-002270">The macOS system must disable the iCloud Freeform services.</h2>
    <p>
    <b><a href="#APPL-14-002270">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-002270">APPL-14-002270</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS built-in Freeform.app connection to Apple's iCloud service must<br />                be disabled.<br /><br />                Apple's iCloud service does not provide an organization with enough control over the storage and access<br />                of data and, therefore, automated calendar synchronization must be controlled by an organization<br />                approved service.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable iCloud Freeform services with the<br />                    following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowCloudFreeform').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable iCloud Freeform services by<br />                installing the "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-003001">The macOS system must issue or obtain public key certificates from an approved service provider.
            </h2>
    <p>
    <b><a href="#APPL-14-003001">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-003001">APPL-14-003001</a> |
      <b>CCI: </b>CCI-002470&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000403-GPOS-00182">SRG-OS-000403-GPOS-00182</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The organization must issue or obtain public key certificates from an<br />                organization-approved service provider and ensure only approved trust anchors are in the System<br />                Keychain.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to issue or obtain public key certificates from an<br />                    approved service provider with the following command:<br /><br />                    /usr/bin/security dump-keychain /Library/Keychains/System.keychain | /usr/bin/awk -F'"' '/labl/<br />                    {print $4}'<br /><br />                    If the result does not contain a list of approved certificate authorities, this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to issue or obtain public key certificates<br />                from an approved service provider by obtaining the approved certificates from the appropriate authority<br />                and install them to the System Keychain.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-003007">The macOS system must require passwords contain a minimum of one numeric character.</h2>
    <p>
    <b><a href="#APPL-14-003007">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-003007">APPL-14-003007</a> |
      <b>CCI: </b>CCI-000194&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000071-GPOS-00039">SRG-OS-000071-GPOS-00039</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS must be configured to require at least one numeric character be<br />                used when a password is created.<br /><br />                This rule enforces password complexity by requiring users to set passwords that are less vulnerable to<br />                malicious users.<br /><br />                Note: The guidance for password-based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that<br />                complexity rules should be organizationally defined. The values defined are based on common complexity<br />                values, but an organization may define its own password complexity rules.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to require passwords contain a minimum of one<br />                    numeric character with the following command:<br /><br />                    /usr/bin/pwpolicy -getaccountpolicies 2> /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath<br />                    '//dict/key[text()="policyIdentifier"]/following-sibling::*[1]/text()' - | /usr/bin/grep<br />                    "requireAlphanumeric" -c<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to require passwords contain a minimum of<br />                one numeric character by installing the "com.apple.mobiledevice.passwordpolicy" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-003008">The macOS system must restrict maximum password lifetime to 60 days.</h2>
    <p>
    <b><a href="#APPL-14-003008">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-003008">APPL-14-003008</a> |
      <b>CCI: </b>CCI-000199&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000076-GPOS-00044">SRG-OS-000076-GPOS-00044</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS must be configured to enforce a maximum password lifetime limit<br />                of at least 60 days.<br /><br />                This rule ensures that users are forced to change their passwords frequently enough to prevent malicious<br />                users from gaining and maintaining access to the system.<br /><br />                Note: The guidance for password-based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that<br />                complexity rules should be organizationally defined. The values defined are based on common complexity<br />                values, but an organization may define its own password complexity rules.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to restrict maximum password lifetime to 60 days<br />                    with the following command:<br /><br />                    /usr/bin/pwpolicy -getaccountpolicies 2> /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath<br />                    '//dict/key[text()="policyAttributeExpiresEveryNDays"]/following-sibling::*[1]/text()' -<br /><br />                    If the result is not "60" or less, this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to restrict maximum password lifetime to 60<br />                days by installing the "com.apple.mobiledevice.passwordpolicy" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-003009">The macOS system must prohibit password reuse for a minimum of five generations.</h2>
    <p>
    <b><a href="#APPL-14-003009">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-003009">APPL-14-003009</a> |
      <b>CCI: </b>CCI-000200&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000077-GPOS-00045">SRG-OS-000077-GPOS-00045</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS must be configured to enforce a password history of at least<br />                five previous passwords when a password is created.<br /><br />                This rule ensures that users are not allowed to reuse a password that was used in any of the five<br />                previous password generations.<br /><br />                Limiting password reuse protects against malicious users attempting to gain access to the system via<br />                brute-force hacking methods.<br /><br />                Note: The guidance for password-based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that<br />                complexity rules should be organizationally defined. The values defined are based on common complexity<br />                values, but an organization may define its own password complexity rules.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to prohibit password reuse for a minimum of five<br />                    generations with the following command:<br /><br />                    /usr/bin/pwpolicy -getaccountpolicies 2> /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath<br />                    '//dict/key[text()="policyAttributePasswordHistoryDepth"]/following-sibling::*[1]/text()' - |<br />                    /usr/bin/awk '{ if ($1 >= 5 ) {print "yes"} else {print "no"}}'<br /><br />                    If the result is not "yes", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to prohibit password reuse for five<br />                generations by installing the "com.apple.mobiledevice.passwordpolicy" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-003010">The macOS system must require a minimum password length of 14 characters.</h2>
    <p>
    <b><a href="#APPL-14-003010">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-003010">APPL-14-003010</a> |
      <b>CCI: </b>CCI-000205&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000078-GPOS-00046">SRG-OS-000078-GPOS-00046</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS must be configured to require a minimum of 14 characters be<br />                used when a password is created.<br /><br />                This rule enforces password complexity by requiring users to set passwords that are less vulnerable to<br />                malicious users.<br /><br />                Note: The guidance for password-based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that<br />                complexity rules should be organizationally defined. The values defined are based on common complexity<br />                values, but an organization may define its own password complexity rules.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to enforce a minimum 14-character password length<br />                    with the following command:<br /><br />                    /usr/bin/pwpolicy -getaccountpolicies 2> /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath<br />                    'boolean(//*[contains(text(),"policyAttributePassword matches '\''.{14,}'\''")])' -<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to enforce a 14-character password length by<br />                installing the "com.apple.mobiledevice.passwordpolicy" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-003011">The macOS system must require passwords contain a minimum of one special character.</h2>
    <p>
    <b><a href="#APPL-14-003011">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-003011">APPL-14-003011</a> |
      <b>CCI: </b>CCI-001619&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000266-GPOS-00101">SRG-OS-000266-GPOS-00101</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS must be configured to require at least one special character be<br />                used when a password is created.<br /><br />                Special characters are those characters that are not alphanumeric. Examples include: ~ ! @ # $ % ^ *.<br /><br />                This rule enforces password complexity by requiring users to set passwords that are less vulnerable to<br />                malicious users.<br /><br />                Note: The guidance for password-based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that<br />                complexity rules should be organizationally defined. The values defined are based on common complexity<br />                values, but an organization may define its own password complexity rules.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to require passwords contain a minimum of one<br />                    special character with the following command:<br /><br />                    /usr/bin/pwpolicy -getaccountpolicies 2> /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath<br />                    'boolean(//*[contains(text(),"policyAttributePassword matches '\''(.*[^a-zA-Z0-9].*){1,}'\''")])' -<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to require passwords contain a minimum of<br />                one special character by installing the "com.apple.mobiledevice.passwordpolicy" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-003012">The macOS system must disable password hints.</h2>
    <p>
    <b><a href="#APPL-14-003012">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-003012">APPL-14-003012</a> |
      <b>CCI: </b>CCI-000206&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000079-GPOS-00047">SRG-OS-000079-GPOS-00047</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Password hints must be disabled.<br /><br />                Password hints leak information about passwords that are currently in use and can lead to loss of<br />                confidentiality.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable password hints with the following<br />                    command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\<br />                    .objectForKey('RetriesUntilHint').js<br />                    EOS<br /><br />                    If the result is not "0", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable password hints by installing the<br />                "com.apple.loginwindow" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-003013">The macOS system must enable firmware password.</h2>
    <p>
    <b><a href="#APPL-14-003013">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-003013">APPL-14-003013</a> |
      <b>CCI: </b>CCI-000366&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000480-GPOS-00227">SRG-OS-000480-GPOS-00227</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          A firmware password must be enabled and set.<br /><br />                Single user mode, recovery mode, the Startup Manager, and several other tools are available on macOS by<br />                holding the "Option" key down during startup. Setting a firmware password restricts access to these<br />                tools.<br /><br />                To set a firmware passcode use the following command:<br /><br />                [source,bash]<br />                ----<br />                /usr/sbin/firmwarepasswd -setpasswd<br />                ----<br /><br />                Note: If firmware password or passcode is forgotten, the only way to reset the forgotten password is<br />                through the use of a machine specific binary generated and provided by Apple. Schedule a support call<br />                and provide proof of purchase before the firmware binary will be generated.<br /><br />                Note: Firmware passwords are not supported on Apple Silicon devices. This rule is only applicable to<br />                Intel devices.
        </div>
        <div class="span1">
          <h3>Check</h3>
          For Apple Silicon systems, this is not applicable.<br /><br />                    Verify the macOS system is configured with a firmware password with the following command:<br /><br />                    /usr/sbin/firmwarepasswd -check | /usr/bin/grep -c "Password Enabled: Yes"<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system with a firmware password with the following<br />                command:<br /><br />                /usr/sbin/firmwarepasswd -setpasswd<br /><br />                Note: If firmware password or passcode is forgotten, the only way to reset the forgotten password is<br />                through a machine-specific binary generated and provided by Apple. Users must schedule a support call<br />                and provide proof of purchase before the firmware binary will be generated.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-003014">The macOS system must remove password hints from user accounts.</h2>
    <p>
    <b><a href="#APPL-14-003014">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-003014">APPL-14-003014</a> |
      <b>CCI: </b>CCI-000206&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000079-GPOS-00047">SRG-OS-000079-GPOS-00047</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          User accounts must not contain password hints. Password hints leak<br />                information about passwords that are currently in use and can lead to loss of confidentiality.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to remove password hints from user accounts with<br />                    the following command:<br /><br />                    /usr/bin/dscl . -list /Users hint | /usr/bin/awk '{print $2}' | /usr/bin/wc -l | /usr/bin/xargs<br /><br />                    If the result is not "0", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to remove password hints from user accounts<br />                with the following command:<br /><br />                for u in $(/usr/bin/dscl . -list /Users UniqueID | /usr/bin/awk '$2 > 500 {print $1}'); do<br />                /usr/bin/dscl . -delete /Users/$u hint<br />                done<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-003020">The macOS system must enforce smart card authentication.</h2>
    <p>
    <b><a href="#APPL-14-003020">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-003020">APPL-14-003020</a> |
      <b>CCI: </b>CCI-000186&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000067-GPOS-00035">SRG-OS-000067-GPOS-00035</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Smart card authentication must be enforced.<br /><br />                The use of smart card credentials facilitates standardization and reduces the risk of unauthorized<br />                access.<br /><br />                When enforceSmartCard is set to "true", the smart card must be used for logon, authorization, and<br />                unlocking the screensaver.<br /><br />                CAUTION: enforceSmartCard will apply to the whole system. No users will be able to log on with their<br />                password unless the profile is removed or a user is exempt from smart card enforcement.<br /><br />                Note: enforceSmartcard requires allowSmartcard to be set to true in order to work.<br /><br />                Satisfies:<br />                SRG-OS-000067-GPOS-00035,SRG-OS-000105-GPOS-00052,SRG-OS-000106-GPOS-00053,SRG-OS-000107-GPOS-00054,SRG-OS-000108-GPOS-00055,SRG-OS-000112-GPOS-00057,SRG-OS-000375-GPOS-00160,SRG-OS-000376-GPOS-00161
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to enforce multifactor authentication with the<br />                    following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.security.smartcard')\<br />                    .objectForKey('enforceSmartCard').js<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to enforce multifactor authentication by<br />                installing the "com.apple.security.smartcard" configuration profile.<br /><br />                Note: To ensure continued access to the operating system, consult the supplemental guidance provided<br />                with the STIG before applying the configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-003030">The macOS system must allow smart card authentication.</h2>
    <p>
    <b><a href="#APPL-14-003030">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-003030">APPL-14-003030</a> |
      <b>CCI: </b>CCI-000187&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000068-GPOS-00036">SRG-OS-000068-GPOS-00036</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Smart card authentication must be allowed.<br /><br />                The use of smart card credentials facilitates standardization and reduces the risk of unauthorized<br />                access.<br /><br />                When enabled, the smart card can be used for logon, authorization, and screen saver unlocking.<br /><br />                Satisfies:<br />                SRG-OS-000068-GPOS-00036,SRG-OS-000105-GPOS-00052,SRG-OS-000106-GPOS-00053,SRG-OS-000107-GPOS-00054,SRG-OS-000108-GPOS-00055,SRG-OS-000112-GPOS-00057,SRG-OS-000376-GPOS-00161
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to allow smart card authentication with the<br />                    following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.security.smartcard')\<br />                    .objectForKey('allowSmartCard').js<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to enforce multifactor authentication by<br />                installing the "com.apple.security.smartcard" configuration profile.<br /><br />                Note: To ensure continued access to the operating system, consult the supplemental guidance provided<br />                with the STIG before applying the configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-003050">The macOS system must enforce multifactor authentication for logon.</h2>
    <p>
    <b><a href="#APPL-14-003050">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-003050">APPL-14-003050</a> |
      <b>CCI: </b>CCI-000765&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000105-GPOS-00052">SRG-OS-000105-GPOS-00052</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The system must be configured to enforce multifactor authentication.<br /><br />                All users must go through multifactor authentication to prevent unauthenticated access and potential<br />                compromise to the system.<br /><br />                IMPORTANT: Modification of Pluggable Authentication Modules (PAM) now requires user authorization or use<br />                of a Privacy Preferences Policy Control (PPPC) profile from MDM that authorizes modifying system<br />                administrator files or full disk access.<br /><br />                Note: /etc/pam.d/login will be automatically modified to its original state following any update or<br />                major upgrade to the operating system.<br /><br />                Satisfies:<br />                SRG-OS-000105-GPOS-00052,SRG-OS-000106-GPOS-00053,SRG-OS-000107-GPOS-00054,SRG-OS-000108-GPOS-00055,SRG-OS-000112-GPOS-00057
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to enforce multifactor authentication for login<br />                    with the following command:<br /><br />                    /usr/bin/grep -Ec '^(auth\s+sufficient\s+pam_smartcard.so|auth\s+required\s+pam_deny.so)'<br />                    /etc/pam.d/login<br /><br />                    If the result is not "2", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to enforce multifactor authentication for<br />                login with the following commands:<br /><br />                /bin/cat > /etc/pam.d/login << LOGIN_END<br />                # login: auth account password session<br />                auth sufficient pam_smartcard.so<br />                auth optional pam_krb5.so use_kcminit<br />                auth optional pam_ntlm.so try_first_pass<br />                auth optional pam_mount.so try_first_pass<br />                auth required pam_opendirectory.so try_first_pass<br />                auth required pam_deny.so<br />                account required pam_nologin.so<br />                account required pam_opendirectory.so<br />                password required pam_opendirectory.so<br />                session required pam_launchd.so<br />                session required pam_uwtmp.so<br />                session optional pam_mount.so<br />                LOGIN_END<br /><br />                /bin/chmod 644 /etc/pam.d/login<br />                /usr/sbin/chown root:wheel /etc/pam.d/login<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-003051">The macOS system must enforce multifactor authentication for the su command.</h2>
    <p>
    <b><a href="#APPL-14-003051">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-003051">APPL-14-003051</a> |
      <b>CCI: </b>CCI-000765&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000105-GPOS-00052">SRG-OS-000105-GPOS-00052</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The system must be configured such that, when the su command is used,<br />                multifactor authentication is enforced.<br /><br />                All users must go through multifactor authentication to prevent unauthenticated access and potential<br />                compromise to the system.<br /><br />                IMPORTANT: Modification of Pluggable Authentication Modules (PAM) now requires user authorization or use<br />                of a Privacy Preferences Policy Control (PPPC) profile from MDM that authorizes modifying system<br />                administrator files or full disk access.<br /><br />                Note: /etc/pam.d/su will be automatically modified to its original state following any update or major<br />                upgrade to the operating system.<br /><br />                Satisfies:<br />                SRG-OS-000105-GPOS-00052,SRG-OS-000106-GPOS-00053,SRG-OS-000107-GPOS-00054,SRG-OS-000108-GPOS-00055,SRG-OS-000112-GPOS-00057
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to enforce multifactor authentication for the su<br />                    command with the following command:<br /><br />                    /usr/bin/grep -Ec '^(auth\s+sufficient\s+pam_smartcard.so|auth\s+required\s+pam_rootok.so)'<br />                    /etc/pam.d/su<br /><br />                    If the result is not "2", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to enforce multifactor authentication for<br />                the su command with the following commands:<br /><br />                /bin/cat > /etc/pam.d/su << SU_END<br />                # su: auth account password session<br />                auth sufficient pam_smartcard.so<br />                auth required pam_rootok.so<br />                auth required pam_group.so no_warn group=admin,wheel ruser root_only fail_safe<br />                account required pam_permit.so<br />                account required pam_opendirectory.so no_check_shell<br />                password required pam_opendirectory.so<br />                session required pam_launchd.so<br />                SU_END<br /><br />                # Fix new file ownership and permissions<br />                /bin/chmod 644 /etc/pam.d/su<br />                /usr/sbin/chown root:wheel /etc/pam.d/su<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-003052">The macOS system must enforce multifactor authentication for privilege escalation through the sudo
                command.
            </h2>
    <p>
    <b><a href="#APPL-14-003052">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-003052">APPL-14-003052</a> |
      <b>CCI: </b>CCI-000765&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000105-GPOS-00052">SRG-OS-000105-GPOS-00052</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The system must be configured to enforce multifactor authentication when<br />                the sudo command is used to elevate privilege.<br /><br />                All users must go through multifactor authentication to prevent unauthenticated access and potential<br />                compromise to the system.<br /><br />                IMPORTANT: Modification of Pluggable Authentication Modules (PAM) now requires user authorization, or<br />                use of a Privacy Preferences Policy Control (PPPC) profile from MDM that authorizes modifying system<br />                administrator files or full disk access.<br /><br />                Note: /etc/pam.d/sudo will be automatically modified to its original state following any update or major<br />                upgrade to the operating system.<br /><br />                Satisfies:<br />                SRG-OS-000105-GPOS-00052,SRG-OS-000106-GPOS-00053,SRG-OS-000107-GPOS-00054,SRG-OS-000108-GPOS-00055,SRG-OS-000112-GPOS-00057
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to enforce multifactor authentication for privilege<br />                    escalation through the sudo command with the following command:<br /><br />                    /usr/bin/grep -Ec '^(auth\s+sufficient\s+pam_smartcard.so|auth\s+required\s+pam_deny.so)'<br />                    /etc/pam.d/sudo<br /><br />                    If the result is not "2", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to enforce multifactor authentication for<br />                privilege escalation through the sudo command with the following commands:<br /><br />                /bin/cat > /etc/pam.d/sudo << SUDO_END<br />                # sudo: auth account password session<br />                auth sufficient pam_smartcard.so<br />                auth required pam_opendirectory.so<br />                auth required pam_deny.so<br />                account required pam_permit.so<br />                password required pam_deny.so<br />                session required pam_permit.so<br />                SUDO_END<br /><br />                /bin/chmod 444 /etc/pam.d/sudo<br />                /usr/sbin/chown root:wheel /etc/pam.d/sudo<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-003060">The macOS system must require passwords contain a minimum of one lowercase character and one
                uppercase character.
            </h2>
    <p>
    <b><a href="#APPL-14-003060">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-003060">APPL-14-003060</a> |
      <b>CCI: </b>CCI-000192&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000069-GPOS-00037">SRG-OS-000069-GPOS-00037</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS be configured to require at least one lowercase character and<br />                one uppercase character be used when a password is created.<br /><br />                This rule enforces password complexity by requiring users to set passwords that are less vulnerable to<br />                malicious users.<br /><br />                Note: The guidance for password-based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that<br />                complexity rules should be organizationally defined. The values defined are based on common complexity<br />                values, but an organization may define its own password complexity rules.<br /><br />                Note: The configuration profile generated must be installed from an MDM server.<br /><br />                Satisfies: SRG-OS-000069-GPOS-00037,SRG-OS-000070-GPOS-00038
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to require passwords contain a minimum of one<br />                    lowercase character and one uppercase character with the following command:<br /><br />                    /usr/bin/pwpolicy -getaccountpolicies 2> /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath<br />                    'boolean(//*[contains(text(),"policyAttributePassword matches '\''.*[A-Z]{1,}[a-z]{1,}.*'\''")])' -<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to require at least one lowercase character<br />                and one uppercase character in password complexity by installing the<br />                "com.apple.mobiledevice.passwordpolicy" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-003070">The macOS system must set minimum password lifetime to 24 hours.</h2>
    <p>
    <b><a href="#APPL-14-003070">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-003070">APPL-14-003070</a> |
      <b>CCI: </b>CCI-000198&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000075-GPOS-00043">SRG-OS-000075-GPOS-00043</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS must be configured to enforce a minimum password lifetime limit<br />                of 24 hours.<br /><br />                This rule discourages users from cycling through their previous passwords to get back to a preferred<br />                one.<br /><br />                Note: The guidance for password-based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that<br />                complexity rules should be organizationally defined. The values defined are based on common complexity<br />                values, but an organization may define its own password complexity rules.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to set minimum password lifetime to 24 hours with<br />                    the following command:<br /><br />                    /usr/bin/pwpolicy -getaccountpolicies 2> /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath<br />                    '//dict/key[text()="policyAttributeMinimumLifetimeHours"]/following-sibling::integer[1]/text()' - |<br />                    /usr/bin/awk '{ if ($1 >= 24 ) {print "yes"} else {print "no"}}'<br /><br />                    If the result is not "yes", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to set minimum password lifetime to 24<br />                hours.<br /><br />                This setting may be enforced using local policy or by a directory service.<br /><br />                To set local policy to require a minimum password lifetime, edit the current password policy to contain<br />                the following <dict> within the "policyCategoryPasswordContent":<br /><br />                [source,xml]<br />                ----<br />                <dict><br />                <key>policyContent</key><br />                <string>policyAttributeLastPasswordChangeTime &lt; policyAttributeCurrentTime -<br />                (policyAttributeMinimumLifetimeHours * 60 * 60)</string><br />                <key>policyIdentifier</key><br />                <string>Minimum Password Lifetime</string><br />                <key>policyParameters</key><br />                <dict><br />                <key>policyAttributeMinimumLifetimeHours</key><br />                <integer>24</integer><br />                </dict><br />                </dict><br />                ----<br />                After saving the file and exiting to the command prompt, run the following command to load the new<br />                policy file, substituting the path to the file in place of "$pwpolicy_file".<br /><br />                [source,bash]<br />                ----<br />                /usr/bin/pwpolicy setaccountpolicies $pwpolicy_file<br />                ----<br />                Note: Refer to the password policy supplemental on more information on how to implement password<br />                policies on macOS.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-003080">The macOS system must disable accounts after 35 days of inactivity.</h2>
    <p>
    <b><a href="#APPL-14-003080">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-003080">APPL-14-003080</a> |
      <b>CCI: </b>CCI-000795&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000118-GPOS-00060">SRG-OS-000118-GPOS-00060</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS must be configured to disable accounts after 35 days of<br />                inactivity.<br /><br />                This rule prevents malicious users from making use of unused accounts to gain access to the system while<br />                avoiding detection.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable accounts after 35 days of inactivity<br />                    with the following command:<br /><br />                    /usr/bin/pwpolicy -getaccountpolicies 2> /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath<br />                    '//dict/key[text()="policyAttributeInactiveDays"]/following-sibling::integer[1]/text()' -<br /><br />                    If the result is not "35", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable accounts after 35 days of<br />                inactivity with the following command:<br /><br />                This setting may be enforced using local policy or by a directory service.<br /><br />                To set local policy to disable an inactive user after 35 days, edit the current password policy to<br />                contain the following <dict> within the "policyCategoryAuthentication":<br /><br />                [source,xml]<br />                ----<br />                <dict><br />                <key>policyContent</key><br />                <string>policyAttributeLastAuthenticationTime &gt; policyAttributeCurrentTime -<br />                (policyAttributeInactiveDays * 24 * 60 * 60)</string><br />                <key>policyIdentifier</key><br />                <string>Inactive Account</string><br />                <key>policyParameters</key><br />                <dict><br />                <key>policyAttributeInactiveDays</key><br />                <integer>35</integer><br />                </dict><br />                </dict><br />                ----<br />                After saving the file and exiting to the command prompt, run the following command to load the new<br />                policy file, substituting the path to the file in place of "$pwpolicy_file".<br /><br />                [source,bash]<br />                ----<br />                /usr/bin/pwpolicy setaccountpolicies $pwpolicy_file<br />                ----<br />                Note: Refer to the password policy supplemental on more information on how to implement password<br />                policies on macOS.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-004001">The macOS system must configure Apple System Log files to be owned by root and group to wheel.
            </h2>
    <p>
    <b><a href="#APPL-14-004001">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-004001">APPL-14-004001</a> |
      <b>CCI: </b>CCI-001312&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000205-GPOS-00083">SRG-OS-000205-GPOS-00083</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The Apple System Logs (ASL) must be owned by root.<br /><br />                ASL logs contain sensitive data about the system and users. If ASL log files are set to only be readable<br />                and writable by system administrators, the risk is mitigated.<br /><br />                Satisfies: SRG-OS-000205-GPOS-00083,SRG-OS-000206-GPOS-00084
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured with Apple System Log files owned by root and group<br />                    to wheel with the following command:<br /><br />                    /usr/bin/stat -f '%Su:%Sg:%N' $(/usr/bin/grep -e '^>' /etc/asl.conf /etc/asl/* | /usr/bin/awk '{<br />                    print $2 }') 2> /dev/null | /usr/bin/awk '!/^root:wheel:/{print $1}' | /usr/bin/wc -l |<br />                    /usr/bin/tr -d ' '<br /><br />                    If the result is not "0", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system with Apple System Log files owned by root<br />                and group to wheel with the following command:<br /><br />                /usr/sbin/chown root:wheel $(/usr/bin/stat -f '%Su:%Sg:%N' $(/usr/bin/grep -e '^>' /etc/asl.conf<br />                /etc/asl/* | /usr/bin/awk '{ print $2 }') 2> /dev/null | /usr/bin/awk '!/^root:wheel:/{print $1}' |<br />                /usr/bin/awk -F":" '!/^root:wheel:/{print $3}')<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-004002">The macOS system must configure Apple System Log files to mode 640 or less permissive.</h2>
    <p>
    <b><a href="#APPL-14-004002">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-004002">APPL-14-004002</a> |
      <b>CCI: </b>CCI-001312&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000205-GPOS-00083">SRG-OS-000205-GPOS-00083</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The Apple System Logs (ASL) must be configured to be writable by root and<br />                readable only by the root user and group wheel. To achieve this, ASL log files must be configured to<br />                mode 640 permissive or less; thereby preventing normal users from reading, modifying, or deleting audit<br />                logs. System logs frequently contain sensitive information that could be used by an attacker. Setting<br />                the correct permissions mitigates this risk.<br /><br />                Satisfies: SRG-OS-000205-GPOS-00083,SRG-OS-000206-GPOS-00084
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured with Apple System Log files to mode 640 or less<br />                    permissive with the following command:<br /><br />                    /usr/bin/stat -f '%A:%N' $(/usr/bin/grep -e '^>' /etc/asl.conf /etc/asl/* | /usr/bin/awk '{ print<br />                    $2 }') 2> /dev/null | /usr/bin/awk '!/640/{print $1}' | /usr/bin/wc -l | /usr/bin/tr -d ' '<br /><br />                    If the result is not "0", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system with Apple System Log files to mode 640 with<br />                the following command:<br /><br />                /bin/chmod 640 $(/usr/bin/stat -f '%A:%N' $(/usr/bin/grep -e '^>' /etc/asl.conf /etc/asl/* |<br />                /usr/bin/awk '{ print $2 }') 2> /dev/null | /usr/bin/awk -F":" '!/640/{print $2}')<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-004022">The macOS system must require users to reauthenticate for privilege escalation when using the "sudo"
                command.
            </h2>
    <p>
    <b><a href="#APPL-14-004022">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-004022">APPL-14-004022</a> |
      <b>CCI: </b>CCI-002038&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000373-GPOS-00156">SRG-OS-000373-GPOS-00156</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The file /etc/sudoers must include a timestamp_timout of 0.<br /><br />                Without reauthentication, users may access resources or perform tasks for which they do not have<br />                authorization. When operating systems provide the capability to escalate a functional capability or<br />                change user authenticators, it is critical the user reauthenticate.<br /><br />                Satisfies: SRG-OS-000373-GPOS-00156,SRG-OS-000373-GPOS-00157,SRG-OS-000373-GPOS-00158
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system requires reauthentication when using the "sudo" command to<br />                    elevate privileges with the following command:<br /><br />                    /usr/bin/sudo /usr/bin/sudo -V | /usr/bin/grep -c "Authentication timestamp timeout: 0.0 minutes"<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to require reauthentication when using<br />                "sudo" with the following command:<br /><br />                /usr/bin/find /etc/sudoers* -type f -exec sed -i '' '/timestamp_timeout/d' '{}' \;<br />                /bin/echo "Defaults timestamp_timeout=0" >> /etc/sudoers.d/mscp<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-004030">The macOS system must configure system log files to be owned by root and group to wheel.</h2>
    <p>
    <b><a href="#APPL-14-004030">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-004030">APPL-14-004030</a> |
      <b>CCI: </b>CCI-001312&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000205-GPOS-00083">SRG-OS-000205-GPOS-00083</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The system log files must be owned by root.<br /><br />                System logs contain sensitive data about the system and users. If log files are set to only be readable<br />                and writable by system administrators, the risk is mitigated.<br /><br />                Satisfies: SRG-OS-000205-GPOS-00083,SRG-OS-000206-GPOS-00084
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured with system log files owned by root and group to<br />                    wheel with the following command:<br /><br />                    /usr/bin/stat -f '%Su:%Sg:%N' $(/usr/bin/grep -v '^#' /etc/newsyslog.conf | /usr/bin/awk '{ print $1<br />                    }') 2> /dev/null | /usr/bin/awk '!/^root:wheel:/{print $1}' | /usr/bin/wc -l | /usr/bin/tr -d ' '<br /><br />                    If the result is not "0", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system with system log files owned by root and<br />                group to wheel with the following command:<br /><br />                /usr/sbin/chown root:wheel $(/usr/bin/stat -f '%Su:%Sg:%N' $(/usr/bin/grep -v '^#' /etc/newsyslog.conf |<br />                /usr/bin/awk '{ print $1 }') 2> /dev/null | /usr/bin/awk -F":" '!/^root:wheel:/{print $3}')<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-004040">The macOS system must configure system log files to mode 640 or less permissive.</h2>
    <p>
    <b><a href="#APPL-14-004040">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-004040">APPL-14-004040</a> |
      <b>CCI: </b>CCI-001312&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000205-GPOS-00083">SRG-OS-000205-GPOS-00083</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The system logs must be configured to be writable by root and readable<br />                only by the root user and group wheel. To achieve this, system log files must be configured to mode 640<br />                permissive or less; thereby preventing normal users from reading, modifying, or deleting audit logs.<br />                System logs frequently contain sensitive information that could be used by an attacker. Setting the<br />                correct permissions mitigates this risk.<br /><br />                Satisfies: SRG-OS-000205-GPOS-00083,SRG-OS-000206-GPOS-00084
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured with system log files set to mode 640 or less<br />                    permissive with the following command:<br /><br />                    /usr/bin/stat -f '%A:%N' $(/usr/bin/grep -v '^#' /etc/newsyslog.conf | /usr/bin/awk '{ print $1 }')<br />                    2> /dev/null | /usr/bin/awk '!/640/{print $1}' | /usr/bin/wc -l | /usr/bin/tr -d ' '<br /><br />                    If the result is not "0", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system with system log files set to mode 640 or<br />                less permissive with the following command:<br /><br />                /bin/chmod 640 $(/usr/bin/stat -f '%A:%N' $(/usr/bin/grep -v '^#' /etc/newsyslog.conf | /usr/bin/awk '{<br />                print $1 }') 2> /dev/null | /usr/bin/awk '!/640/{print $1}' | awk -F":" '!/640/{print $2}')<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-004050">The macOS system must configure install.log retention to 365.</h2>
    <p>
    <b><a href="#APPL-14-004050">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-004050">APPL-14-004050</a> |
      <b>CCI: </b>CCI-001849&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000341-GPOS-00132">SRG-OS-000341-GPOS-00132</a> |
      <b>Severity: </b>low
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The install.log must be configured to require records be kept for an<br />                organizational-defined value before deletion, unless the system uses a central audit record storage<br />                facility.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured with install.log retention to 365 with the<br />                    following command:<br /><br />                    /usr/sbin/aslmanager -dd 2>&1 | /usr/bin/awk '/\/var\/log\/install.log/ {count++} /Processing<br />                    module com.apple.install/,/Finished/ { for (i=1;i<=NR;i++) { if ($i == "TTL" && $(i+2)<br />                    >= 365) { ttl="True" }; if ($i == "MAX") {max="True"}}} END{if (count > 1) { print "Multiple<br />                    config files for /var/log/install, manually remove"} else if (ttl != "True") { print "TTL not<br />                    configured" } else if (max == "True") { print "Max Size is configured, must be removed" } else {<br />                    print "Yes" }}'<br /><br />                    If the result is not "yes", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system with install.log retention to 365 with the<br />                following command:<br /><br />                /usr/bin/sed -i '' "s/\* file \/var\/log\/install.log.*/\* file \/var\/log\/install.log<br />                format='\$\(\(Time\)\(JZ\)\) \$Host \$\(Sender\)\[\$\(PID\\)\]: \$Message' rotate=utc compress<br />                file_max=50M size_only ttl=365/g" /etc/asl/com.apple.install<br /><br />                Note: If there are multiple configuration files in /etc/asl that are set to process the file<br />                /var/log/install.log, these files will have to be manually removed.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-004060">The macOS system must configure sudoers timestamp type.</h2>
    <p>
    <b><a href="#APPL-14-004060">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-004060">APPL-14-004060</a> |
      <b>CCI: </b>CCI-002038&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000373-GPOS-00156">SRG-OS-000373-GPOS-00156</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The file /etc/sudoers must be configured to not include a timestamp_type<br />                of global or ppid and be configured for timestamp record types of tty.<br /><br />                This rule ensures that the "sudo" command will prompt for the administrator's password at least once in<br />                each newly opened terminal window. This prevents a malicious user from taking advantage of an unlocked<br />                computer or an abandoned logon session by bypassing the normal password prompt requirement.<br /><br />                Satisfies: SRG-OS-000373-GPOS-00156,SRG-OS-000373-GPOS-00157
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured with sudoers timestamp type with the following<br />                    command:<br /><br />                    /usr/bin/sudo /usr/bin/sudo -V | /usr/bin/awk -F": " '/Type of authentication timestamp<br />                    record/{print $2}'<br /><br />                    If the result is not "tty", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system with sudoers timestamp type with the<br />                following command:<br /><br />                /usr/bin/find /etc/sudoers* -type f -exec sed -i '' '/timestamp_type/d; /!tty_tickets/d' '{}' \;<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-005001">The macOS system must ensure System Integrity Protection is enabled.</h2>
    <p>
    <b><a href="#APPL-14-005001">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-005001">APPL-14-005001</a> |
      <b>CCI: </b>CCI-000154&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000051-GPOS-00024">SRG-OS-000051-GPOS-00024</a> |
      <b>Severity: </b>high
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          System Integrity Protection (SIP) must be enabled.<br /><br />                SIP is vital to protecting the integrity of the system as it prevents malicious users and software from<br />                making unauthorized and/or unintended modifications to protected files and folders; ensures the presence<br />                of an audit record generation capability for defined auditable events for all operating system<br />                components; protects audit tools from unauthorized access, modification, and deletion; restricts the<br />                root user account and limits the actions that the root user can perform on protected parts of the macOS;<br />                and prevents nonprivileged users from granting other users direct access to the contents of their home<br />                directories and folders.<br /><br />                Note: SIP is enabled by default in macOS.<br /><br />                Satisfies:<br />                SRG-OS-000051-GPOS-00024,SRG-OS-000054-GPOS-00025,SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000062-GPOS-00031,SRG-OS-000080-GPOS-00048,SRG-OS-000122-GPOS-00063,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099,SRG-OS-000259-GPOS-00100,SRG-OS-000278-GPOS-00108,SRG-OS-000350-GPOS-00138
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to enable System Integrity Protection with the<br />                    following command:<br /><br />                    /usr/bin/csrutil status | /usr/bin/grep -c 'System Integrity Protection status: enabled.'<br /><br />                    If the result is not "1", this is a finding.<br /><br />                    /usr/bin/grep -c "logger -s -p" /etc/security/audit_warn<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to enable "System Integrity Protection" by<br />                booting into "Recovery" mode, launch "Terminal" from the "Utilities" menu, and run the following<br />                command:<br /><br />                /usr/bin/csrutil enable<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-005020">The macOS system must enforce FileVault.</h2>
    <p>
    <b><a href="#APPL-14-005020">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-005020">APPL-14-005020</a> |
      <b>CCI: </b>CCI-001199&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000185-GPOS-00079">SRG-OS-000185-GPOS-00079</a> |
      <b>Severity: </b>high
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          FileVault must be enforced.<br /><br />                The information system implements cryptographic mechanisms to protect the confidentiality and integrity<br />                of information stored on digital media during transport outside of controlled areas.<br /><br />                Satisfies: SRG-OS-000185-GPOS-00079,SRG-OS-000404-GPOS-00183,SRG-OS-000405-GPOS-00184
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to enforce FileVault with the following command:<br /><br />                    dontAllowDisable=$(/usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX')\<br />                    .objectForKey('dontAllowFDEDisable').js<br />                    EOS<br />                    )<br />                    fileVault=$(/usr/bin/fdesetup status | /usr/bin/grep -c "FileVault is On.")<br />                    if [[ "$dontAllowDisable" == "true" ]] && [[ "$fileVault" == 1 ]]; then<br />                    echo "1"<br />                    else<br />                    echo "0"<br />                    fi<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Note: Refer to the FileVault supplemental to implement this rule.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-005050">The macOS system must enable the application firewall.</h2>
    <p>
    <b><a href="#APPL-14-005050">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-005050">APPL-14-005050</a> |
      <b>CCI: </b>CCI-000366&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000480-GPOS-00232">SRG-OS-000480-GPOS-00232</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The macOS Application Firewall is the built-in firewall that comes with<br />                macOS, and it must be enabled.<br /><br />                When the macOS Application Firewall is enabled, the flow of information within the information system<br />                and between interconnected systems will be controlled by approved authorizations.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to enable the application firewall with the<br />                    following command:<br /><br />                    profile="$(/usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.security.firewall')\<br />                    .objectForKey('EnableFirewall').js<br />                    EOS<br />                    )"<br /><br />                    plist="$(/usr/bin/defaults read /Library/Preferences/com.apple.alf globalstate 2>/dev/null)"<br /><br />                    if [[ "$profile" == "true" ]] && [[ "$plist" =~ [1,2] ]]; then<br />                    echo "true"<br />                    else<br />                    echo "false"<br />                    fi<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to enable the application firewall with the<br />                following command:<br /><br />                /usr/bin/defaults write /Library/Preferences/com.apple.alf globalstate -int 1<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-005052">The macOS system must configure login window to prompt for username and password.</h2>
    <p>
    <b><a href="#APPL-14-005052">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-005052">APPL-14-005052</a> |
      <b>CCI: </b>CCI-000764&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000104-GPOS-00051">SRG-OS-000104-GPOS-00051</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The login window must be configured to prompt all users for both a<br />                username and a password.<br /><br />                By default, the system displays a list of known users on the login window, which can make it easier for<br />                a malicious user to gain access to someone else's account. Requiring users to type in both their<br />                username and password mitigates the risk of unauthorized users gaining access to the information system.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to prompt for username and password at the login<br />                    window with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\<br />                    .objectForKey('SHOWFULLNAME').js<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to prompt for username and password at the<br />                logon window by installing the "com.apple.loginwindow" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-005054">The macOS system must disable TouchID prompt during Setup Assistant.</h2>
    <p>
    <b><a href="#APPL-14-005054">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-005054">APPL-14-005054</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The prompt for TouchID during Setup Assistant must be disabled.<br /><br />                macOS prompts new users through enabling TouchID during Setup Assistant; this is not essential, and<br />                therefore must be disabled to prevent against the risk of individuals electing to enable TouchID to<br />                override organizationwide settings.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable TouchID prompt during Setup Assistant<br />                    with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.SetupAssistant.managed')\<br />                    .objectForKey('SkipTouchIDSetup').js<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable TouchID prompt during Setup<br />                Assistant by installing the "com.apple.SetupAssistant.managed" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-005055">The macOS system must disable Screen Time prompt during Setup Assistant.</h2>
    <p>
    <b><a href="#APPL-14-005055">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-005055">APPL-14-005055</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The prompt for Screen Time setup during Setup Assistant must be disabled.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable Screen Time prompt during Setup<br />                    Assistant with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.SetupAssistant.managed')\<br />                    .objectForKey('SkipScreenTime').js<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable Screen Time prompt during Setup<br />                Assistant by installing the "com.apple.SetupAssistant.managed" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-005056">The macOS system must disable Unlock with Apple Watch during Setup Assistant.</h2>
    <p>
    <b><a href="#APPL-14-005056">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-005056">APPL-14-005056</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The prompt for Apple Watch unlock setup during Setup Assistant must be<br />                disabled.<br /><br />                Disabling Apple watches is a necessary step to ensuring that the information system retains a session<br />                lock until the user reestablishes access using an authorized identification and authentication<br />                procedures.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable Unlock with Apple Watch during Setup<br />                    Assistant with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.SetupAssistant.managed')\<br />                    .objectForKey('SkipUnlockWithWatch').js<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable Unlock with Apple Watch during<br />                Setup Assistant by installing the "com.apple.SetupAssistant.managed" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-005058">The macOS system must disable Handoff.</h2>
    <p>
    <b><a href="#APPL-14-005058">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-005058">APPL-14-005058</a> |
      <b>CCI: </b>CCI-000213&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000080-GPOS-00048">SRG-OS-000080-GPOS-00048</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Handoff must be disabled.<br /><br />                Handoff allows users to continue working on a document or project when the user switches from one Apple<br />                device to another. Disabling Handoff prevents data transfers to unauthorized devices.<br /><br />                Satisfies: SRG-OS-000080-GPOS-00048,SRG-OS-000095-GPOS-00049,SRG-OS-000300-GPOS-00118
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable handoff with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowActivityContinuation').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable handoff by installing the<br />                "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-005060">The macOS system must disable proximity-based password sharing requests.</h2>
    <p>
    <b><a href="#APPL-14-005060">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-005060">APPL-14-005060</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Proximity-based password sharing requests must be disabled.<br /><br />                The default behavior of macOS is to allow users to request passwords from other known devices (macOS and<br />                iOS). This feature must be disabled to prevent passwords from being shared.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable proximity-based password sharing<br />                    requests with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowPasswordProximityRequests').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable proximity-based password sharing<br />                requests by installing the "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-005061">The macOS system must disable Erase Content and Settings.</h2>
    <p>
    <b><a href="#APPL-14-005061">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-005061">APPL-14-005061</a> |
      <b>CCI: </b>CCI-000381&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000095-GPOS-00049">SRG-OS-000095-GPOS-00049</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Erase Content and Settings must be disabled.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to disable Erase Content and Settings with the<br />                    following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowEraseContentAndSettings').js<br />                    EOS<br /><br />                    If the result is not "false", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to disable Erase Content and Settings by<br />                installing the "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-005070">The macOS system must enable Authenticated Root.</h2>
    <p>
    <b><a href="#APPL-14-005070">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-005070">APPL-14-005070</a> |
      <b>CCI: </b>CCI-000213&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000080-GPOS-00048">SRG-OS-000080-GPOS-00048</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Authenticated Root must be enabled.<br /><br />                When Authenticated Root is enabled the macOS is booted from a signed volume that is cryptographically<br />                protected to prevent tampering with the system volume.<br /><br />                Note: Authenticated Root is enabled by default on macOS systems.<br /><br />                WARNING: If more than one partition with macOS is detected, the csrutil command will hang awaiting<br />                input.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to enable authenticated root with the following<br />                    command:<br /><br />                    /usr/bin/csrutil authenticated-root | /usr/bin/grep -c 'enabled'<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to enable authenticated root with the<br />                following command:<br /><br />                /usr/bin/csrutil authenticated-root enable<br /><br />                Note: To reenable "Authenticated Root", boot the affected system into "Recovery" mode, launch "Terminal"<br />                from the "Utilities" menu, and run the command.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-005080">The macOS system must prohibit user installation of software into /users/.</h2>
    <p>
    <b><a href="#APPL-14-005080">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-005080">APPL-14-005080</a> |
      <b>CCI: </b>CCI-001812&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000362-GPOS-00149">SRG-OS-000362-GPOS-00149</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Users must not be allowed to install software into /users/.<br /><br />                Allowing users who do not possess explicit privileges to install software presents the risk of untested<br />                and potentially malicious software being installed on the system. Explicit privileges (escalated or<br />                administrative privileges) provide the regular user with explicit capabilities and control that exceeds<br />                the rights of a regular user.<br /><br />                [IMPORTANT]<br />                ====<br />                Apple has deprecated the use of application restriction controls<br />                (https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.applicationaccess.new.yaml#L67-L70).<br />                Using these controls may not work as expected. Third-party software may be required to fulfill the<br />                compliance requirements.<br />                ====
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to prohibit user installation of software into<br />                    /users/ with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    function run() {<br />                    let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess.new')\<br />                    .objectForKey('familyControlsEnabled'))<br />                    let pathlist = $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess.new')\<br />                    .objectForKey('pathBlackList').js<br />                    for ( let app in pathlist ) {<br />                    if ( ObjC.unwrap(pathlist[app]) == "/Users/" && pref1 == true ){<br />                    return("true")<br />                    }<br />                    }<br />                    return("false")<br />                    }<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to prohibit user installation of software<br />                into /users/ by installing the "com.apple.applicationaccess.new" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-005090">The macOS system must authorize USB devices before allowing connection.</h2>
    <p>
    <b><a href="#APPL-14-005090">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-005090">APPL-14-005090</a> |
      <b>CCI: </b>CCI-001958&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000378-GPOS-00163">SRG-OS-000378-GPOS-00163</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          USB devices connected to a Mac must be authorized.<br /><br />                [IMPORTANT]<br />                ====<br />                This feature is removed if a smart card is paired or smart card attribute mapping is configured.<br />                ====
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to authorize USB devices before allowing connection<br />                    with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    function run() {<br />                    let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\<br />                    .objectForKey('allowUSBRestrictedMode'))<br />                    if ( pref1 == false ) {<br />                    return("false")<br />                    } else {<br />                    return("true")<br />                    }<br />                    }<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to authorize USB devices before allowing<br />                connection by installing the "com.apple.applicationaccess" configuration profile.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-005100">The macOS system must ensure secure boot level set to full.</h2>
    <p>
    <b><a href="#APPL-14-005100">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-005100">APPL-14-005100</a> |
      <b>CCI: </b>CCI-002696&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000445-GPOS-00199">SRG-OS-000445-GPOS-00199</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          The Secure Boot security setting must be set to full.<br /><br />                Full security is the default Secure Boot setting in macOS. During startup, when Secure Boot is set to<br />                full security, the Mac will verify the integrity of the operating system before allowing the operating<br />                system to boot.<br /><br />                Note: This will only return a proper result on T2 or Apple Silicon Macs.<br /><br />                Satisfies: SRG-OS-000445-GPOS-00199,SRG-OS-000446-GPOS-00200,SRG-OS-000447-GPOS-00201
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to ensure secure boot level set to full using the<br />                    following command:<br /><br />                    /usr/libexec/mdmclient QuerySecurityInfo | /usr/bin/grep -c "SecureBootLevel = full"<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to ensure secure boot level set to full by<br />                booting into Recovery Mode and enable Full Secure Boot.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-005110">The macOS system must enforce enrollment in mobile device management.</h2>
    <p>
    <b><a href="#APPL-14-005110">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-005110">APPL-14-005110</a> |
      <b>CCI: </b>CCI-000366&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000480-GPOS-00227">SRG-OS-000480-GPOS-00227</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Users must enroll their Mac in a Mobile Device Management (MDM) software.<br /><br />                User Approved MDM (UAMDM) enrollment or enrollment via Apple Business Manager (ABM)/Apple School Manager<br />                (ASM) is required to manage certain security settings. Currently these include:<br /><br />                * Allowed Kernel Extensions<br />                * Allowed Approved System Extensions<br />                * Privacy Preferences Policy Control Payload<br />                * ExtensibleSingleSignOn<br />                * FDEFileVault<br /><br />                In macOS 11, UAMDM grants Supervised status on a Mac, unlocking the following MDM features, which were<br />                previously locked behind ABM:<br /><br />                * Activation Lock Bypass<br />                * Access to Bootstrap Tokens<br />                * Scheduling Software Updates<br />                * Query list and delete local users
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to enforce enrollment in mobile device management<br />                    with the following command:<br /><br />                    /usr/bin/profiles status -type enrollment | /usr/bin/awk -F: '/MDM enrollment/ {print $2}' |<br />                    /usr/bin/grep -c "Yes (User Approved)"<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system by ensuring that system is enrolled via<br />                UAMDM.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-005120">The macOS system must enable recovery lock.</h2>
    <p>
    <b><a href="#APPL-14-005120">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-005120">APPL-14-005120</a> |
      <b>CCI: </b>CCI-000366&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000480-GPOS-00227">SRG-OS-000480-GPOS-00227</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          A recovery lock password must be enabled and set.<br /><br />                Single user mode, recovery mode, the Startup Manager, and several other tools are available on macOS by<br />                holding down specific key combinations during startup. Setting a recovery lock restricts access to these<br />                tools.<br /><br />                IMPORTANT: Recovery lock passwords are not supported on Intel devices. This rule is only applicable to<br />                Apple Silicon devices.
        </div>
        <div class="span1">
          <h3>Check</h3>
          For non-Apple Silicon systems, this is not applicable.<br /><br />                    Verify the macOS system is configured with recovery lock with the following command:<br /><br />                    /usr/libexec/mdmclient QuerySecurityInfo | /usr/bin/grep -c "IsRecoveryLockEnabled = 1"<br /><br />                    If the result is not "1", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system with recovery lock with the SetRecoveryLock<br />                command. This can be used to set a Recovery Lock password and must be from the MDM.<br />            
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APPL-14-005130">The macOS system must enforce installation of XProtect Remediator and Gatekeeper updates
                automatically.
            </h2>
    <p>
    <b><a href="#APPL-14-005130">STIG ID</a>:</b>
      <a href="/products/macos14/v1r1/APPL-14-005130">APPL-14-005130</a> |
      <b>CCI: </b>CCI-000366&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-OS-000480-GPOS-00227">SRG-OS-000480-GPOS-00227</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Software Update must be configured to update XProtect Remediator and<br />                Gatekeeper automatically.<br /><br />                This setting enforces definition updates for XProtect Remediator and Gatekeeper; with this setting in<br />                place, new malware and adware that Apple has added to the list of malware or untrusted software will not<br />                execute. These updates do not require the computer to be restarted.<br /><br />                https://support.apple.com/en-us/HT207005<br /><br />                Note: Software update will automatically update XProtect Remediator and Gatekeeper by default in the<br />                macOS.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Verify the macOS system is configured to enforce installation of XProtect Remediator and<br />                    Gatekeeper updates automatically with the following command:<br /><br />                    /usr/bin/osascript -l JavaScript << EOS<br />                    $.NSUserDefaults.alloc.initWithSuiteName('com.apple.SoftwareUpdate')\<br />                    .objectForKey('ConfigDataInstall').js<br />                    EOS<br /><br />                    If the result is not "true", this is a finding.<br />                
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Configure the macOS system to enforce installation of XProtect<br />                Remediator and Gatekeeper updates automatically by installing the "com.apple.SoftwareUpdate"<br />                configuration profile.<br />            
        </div>
      </div>
    </div>
  

</div>
<div class="footer">
  <hr/>
  This website is not created by, run, approved, or endorsed by the U.S. Department of Defense.
  Use at your own risk. This website is created by
  <a href="https://github.com/Mab879/stigaview-static" target="_blank">open-source</a> software.
</div>
</body>
</html>