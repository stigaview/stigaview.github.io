<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="x-ua-compatible" content="ie=edge"/>
  <title>APPL-14-002100 - V2R2 - STIG-A-View</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Online STIG viewer"/>
  <meta name="generator" content="STIG-A-View Static - 4331b91"/>
  <link href="/static/css/style.css" rel="stylesheet" />
  <link href="/favicon.png" rel="shortcut icon" />
</head>
<body>
<nav class="navbar">
  <a class="navbar-brand" href="/">STIG-A-View</a>
  <ul>
    <li><a href="/">Home</a></li>
    <li><a class="nav-link" href="/stigs">STIGs</a></li>
    <li><a class="nav-link" href="/products">Products</a></li>
  </ul>
</nav>
<div class="container">

  <h2>The macOS system must disable Media Sharing.</h2>
  <p>
  <b>STIG ID:</b> APPL-14-002100 &nbsp;|&nbsp;
  <b>SRG: </b><a href="/srgs/SRG-OS-000080-GPOS-00048">SRG-OS-000080-GPOS-00048</a>&nbsp;|&nbsp;
  <b>Severity: </b>medium&nbsp;|&nbsp;
  <b>CCI: </b>CCI-000213&nbsp;|&nbsp;
  <b>Vulnerability Id:</b> V-259518
  </p>
  <div class="container-fluid">
   <div class="row">
     <div class="span1">
       <h3>Vulnerability Discussion</h3>
       Media sharing must be disabled.<br /><br />When Media Sharing is enabled, the computer starts a network listening service that shares the contents of the user's music collection with other users in the same subnet.<br /><br />The information system must be configured to provide only essential capabilities. Disabling Media Sharing helps prevent the unauthorized connection of devices and the unauthorized transfer of information. Disabling Media Sharing mitigates this risk.<br /><br />Note: The Media Sharing preference panel will still allow "Home Sharing" and "Share media with guests" to be checked but the service will not be enabled.
     </div>
     <div class="span1">
       <h3>Check</h3>
       Verify the macOS system is configured to disable media sharing with the following command:<br /><br />/usr/bin/osascript -l JavaScript << EOS<br />function run() {<br />  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.preferences.sharing.SharingPrefsExtension')\<br />  .objectForKey('homeSharingUIStatus'))<br />  let pref2 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.preferences.sharing.SharingPrefsExtension')\<br />  .objectForKey('legacySharingUIStatus'))<br />  let pref3 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.preferences.sharing.SharingPrefsExtension')\<br />  .objectForKey('mediaSharingUIStatus'))<br />  if ( pref1 == 0 && pref2 == 0 && pref3 == 0 ) {<br />    return("true")<br />  } else {<br />    return("false")<br />  }<br />}<br />EOS<br /><br />If the result is not "true", this is a finding.
     </div>
     <div class="span1">
       <h3>Fix</h3>
       Configure the macOS system to disable media sharing by installing the "com.apple.preferences.sharing.SharingPrefsExtension" configuration profile.
     </div>
   </div>
  </div>

</div>
<div class="footer">
  <hr/>
  This website is not created by, run, approved, or endorsed by the U.S. Department of Defense.
  Use at your own risk. This website is created by
  <a href="https://github.com/Mab879/stigaview-static" target="_blank">open-source</a> software.
</div>
</body>
</html>