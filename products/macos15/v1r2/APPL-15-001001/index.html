<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="x-ua-compatible" content="ie=edge"/>
  <title>APPL-15-001001 - V1R2 - STIG-A-View</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Online STIG viewer"/>
  <meta name="generator" content="STIG-A-View Static - e5455da"/>
  <link href="/static/css/style.css" rel="stylesheet" />
  <link href="/favicon.png" rel="shortcut icon" />
</head>
<body>
<nav class="navbar">
  <a class="navbar-brand" href="/">STIG-A-View</a>
  <ul>
    <li><a href="/">Home</a></li>
    <li><a class="nav-link" href="/stigs">STIGs</a></li>
    <li><a class="nav-link" href="/products">Products</a></li>
  </ul>
</nav>
<div class="container">

  <h2>The macOS system must be configured to audit all administrative action events.</h2>
  <p>
  <b>STIG ID:</b> APPL-15-001001 &nbsp;|&nbsp;
  <b>SRG: </b><a href="/srgs/SRG-OS-000004-GPOS-00004">SRG-OS-000004-GPOS-00004</a>&nbsp;|&nbsp;
  <b>Severity: </b>medium&nbsp;|&nbsp;
  <b>CCI: </b>CCI-000018,CCI-001403,CCI-001404,CCI-001405,CCI-002130,CCI-002234,CCI-003938,CCI-002884,CCI-000172&nbsp;|&nbsp;
  <b>Vulnerability Id:</b> V-268452
  </p>
  <div class="container-fluid">
   <div class="row">
     <div class="span1">
       <h3>Vulnerability Discussion</h3>
       The auditing system must be configured to flag administrative action (ad) events.<br /><br />Administrative action events include changes made to the system (e.g., modifying authentication policies). If audit records do not include ad events, it is difficult to identify incidents and to correlate incidents to subsequent events.<br /><br />Audit records can be generated from various components within the information system (e.g., via a module or policy filter).<br /><br />The information system audits the execution of privileged functions.<br /><br />NOTE: Changing the line "43127:AUE_MAC_SYSCALL:mac_syscall(2):ad" to "43127:AUE_MAC_SYSCALL:mac_syscall(2):zz" in the file /etc/security/audit_event is recommended. This will prevent sandbox violations from being audited by the ad flag.<br /><br />Satisfies: SRG-OS-000004-GPOS-00004, SRG-OS-000239-GPOS-00089, SRG-OS-000240-GPOS-00090, SRG-OS-000241-GPOS-00091, SRG-OS-000303-GPOS-00120, SRG-OS-000327-GPOS-00127, SRG-OS-000365-GPOS-00152, SRG-OS-000392-GPOS-00172, SRG-OS-000458-GPOS-00203, SRG-OS-000471-GPOS-00215, SRG-OS-000471-GPOS-00216, SRG-OS-000476-GPOS-00221
     </div>
     <div class="span1">
       <h3>Check</h3>
       Verify the macOS system is configured to audit privileged access with the following command:<br /><br />/usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' | /usr/bin/grep -Ec 'ad'<br /><br />If "ad" is not listed in the output, this is a finding.
     </div>
     <div class="span1">
       <h3>Fix</h3>
       Configure the macOS system to audit privileged access with the following command:<br /><br />/usr/bin/grep -qE "^flags.*[^-]ad" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,ad/' /etc/security/audit_control; /usr/sbin/audit -s<br /><br />A text editor may also be used to implement the required updates to the "/etc/security/audit_control" file.
     </div>
   </div>
  </div>

</div>
<div class="footer">
  <hr/>
  This website is not created by, run, approved, or endorsed by the U.S. Department of Defense.
  Use at your own risk. This website is created by
  <a href="https://github.com/Mab879/stigaview-static" target="_blank">open-source</a> software.
</div>
</body>
</html>