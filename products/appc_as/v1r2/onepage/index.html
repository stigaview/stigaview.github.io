<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="x-ua-compatible" content="ie=edge"/>
  <title>Red Hat Ansible Automation Controller App Server STIG V1R2 - STIG-A-View</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Online STIG viewer"/>
  <meta name="generator" content="STIG-A-View Static - 1db1445"/>
  <link href="/static/css/style.css" rel="stylesheet" />
  <link href="/favicon.png" rel="shortcut icon" />
</head>
<body>
<nav class="navbar">
  <a class="navbar-brand" href="/">STIG-A-View</a>
  <ul>
    <li><a class="nav-link" href="/stigs">STIGs</a></li>
    <li><a class="nav-link" href="/products">Products</a></li>
  </ul>
</nav>
<div class="container">

    <h2>Red Hat Ansible Automation Controller App Server STIG V1R2</h2>
  <a href="/products/appc_as/v1r2">View as table</a>
  
    <hr>
    <h2 id="APAS-AT-000010">Automation Controller must limit the number of concurrent sessions to an organization-defined number for all accounts and/or account types.</h2>
    <p>
    <b><a href="#APAS-AT-000010">STIG ID</a>:</b>
      <a href="/products/appc_as/v1r2/APAS-AT-000010">APAS-AT-000010</a> |
      <b>CCI: </b>CCI-000054&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-APP-000001-AS-000001">SRG-APP-000001-AS-000001</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Application management includes the ability to control the number of sessions that utilize an application by all accounts and/or account types. Limiting the number of allowed sessions is helpful in limiting risks related to denial-of-service attacks.<br /><br />Automation Controllers host and expose business logic and application processes.<br /><br />Automation Controller limits the maximum number of concurrent sessions in a manner that affects the entire application server or on an individual application basis.<br /><br />The settings must follow DOD-recommended values, but the settings should be configurable to allow for future DOD direction.<br /><br />While the DOD will specify recommended values, the values can be adjusted to accommodate the operational requirement of a given system.<br /><br />Satisfies: SRG-APP-000001-AS-000001, SRG-APP-000295-AS-000263
        </div>
        <div class="span1">
          <h3>Check</h3>
          As a System Administrator for each Automation Controller host, navigate to the Automation Controller web administrator console:<br />Settings >> System >> Miscellaneous Authentication settings.<br /><br />Verify the "Maximum Number of simultaneous logged in sessions" field is set according to policy.<br /><br />If this configuration setting does not match the organizationally defined maximum, or is set to -1 (negative one), this is a finding.
        </div>
        <div class="span1">
          <h3>Fix</h3>
          As a System Administrator for each Automation Controller host, navigate to the Automation Controller web administrator console:<br />Settings >> System >> Miscellaneous Authentication settings.<br /><br />Click "Edit".<br /><br />Change "Maximum Number of simultaneous logged in sessions" to match the organizationally defined maximum or greater than 0.<br /><br />Click "Save".
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APAS-AT-000011">Automation Controller must use encryption strength in accordance with the categorization of the management data during remote access management sessions.</h2>
    <p>
    <b><a href="#APAS-AT-000011">STIG ID</a>:</b>
      <a href="/products/appc_as/v1r2/APAS-AT-000011">APAS-AT-000011</a> |
      <b>CCI: </b>CCI-000068&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-APP-000014-AS-000009">SRG-APP-000014-AS-000009</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Remote management access is accomplished by leveraging common communication protocols and establishing a remote connection to the application server via a network for the purposes of managing Automation Controller. If cryptography is not used, then the session data traversing the remote connection could be intercepted and compromised.<br /><br />Automation Controller is accessed via standard HTTP (redirect)/HTTPS on standard ports, provided by NGINX. A self-signed certificate/key is installed by default; however, a user can provide a locally appropriate certificate and key per their organizational policy. SSL/TLS algorithm support is configured in the /etc./nginx/nginx.conf configuration file.<br /><br />Satisfies: SRG-APP-000014-AS-000009, SRG-APP-000142-AS-000014, SRG-APP-000172-AS-000120, SRG-APP-000441-AS-000258, SRG-APP-000442-AS-000259
        </div>
        <div class="span1">
          <h3>Check</h3>
          As an unauthenticated user, open a new web browser and go to http://<Automation Controller HOST><br /><br />If not redirected to https://<Automation Controller HOST>, this is a finding.
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Enable HTTPS by running the following command:<br /><br />./setup.sh -e nginx_disable_https=false<br /><br />The "nginx_disable_https" variable disables HTTPS traffic through NGINX, this is useful if offloading HTTPS to a load balancer.<br /><br />By default, this variable is set to false in the installers "roles/nginx/defaults/main.yml" file. If a load balancer is not needed, ensure this value has not been set to true.
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APAS-AT-000012">Automation Controller must implement cryptography mechanisms to protect the integrity of information.</h2>
    <p>
    <b><a href="#APAS-AT-000012">STIG ID</a>:</b>
      <a href="/products/appc_as/v1r2/APAS-AT-000012">APAS-AT-000012</a> |
      <b>CCI: </b>CCI-000803&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-APP-000015-AS-000010">SRG-APP-000015-AS-000010</a> |
      <b>Severity: </b>high
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Encryption is critical for protection of remote access sessions. If encryption is not being used for integrity, malicious users may gain the ability to modify Automation Controller configuration. The use of cryptography for ensuring integrity of remote access sessions mitigates that risk.<br /><br />Automation Controller utilizes a web management interface and scripted commands when allowing remote access. Web access requires the use of TLS and scripted access requires using SSH or some other form of approved cryptography. Automation Controller must have the ability to enable a secure remote admin capability.<br /><br />FIPS 140-2 approved TLS versions must be enabled and non-FIPS-approved SSL versions must be disabled.<br /><br />Automation Controller requires the use of Red Hat Enterprise Linux as an operating system and its underlying FIPS validated  cryptographic modules to ensure it meets FIPS 140-2 criteria.<br /><br />Satisfies: SRG-APP-000015-AS-000010, SRG-APP-000179-AS-000129, SRG-APP-000224-AS-000152, SRG-APP-000231-AS-000133, SRG-APP-000231-AS-000156, SRG-APP-000416-AS-000140, SRG-APP-000428-AS-000265, SRG-APP-000429-AS-000157, SRG-APP-000439-AS-000274, SRG-APP-000440-AS-000167, SRG-APP-000514-AS-000136
        </div>
        <div class="span1">
          <h3>Check</h3>
          As a System administrator for each Automation Controller host, check if the Operating System is FIPS enabled:<br /><br />sysctl crypto.fips_enabled<br /><br />If fips_enabled is not 1, this is a finding.<br /><br />Verify the installed volume for Automation Controller is on a LUKS encrypted volume command:<br /><br />AAPROOT='/var/lib/awx' && cryptsetup status `df -T ${AAPROOT} | cut -d ' ' -f 1 | tail -n 1 `  | grep type | grep -i luks || echo "FAILED"<br /><br />If "FAILED" is displayed, this is a finding.<br /><br />Verify this LUKS encrypted volume is using FIPS-compliant cryptographic functions command:<br /><br />allowed_FIPS_ciphers=('aes.*\(256\|384\|512\)') ; echo "${allowed_FIPS_ciphers[*]}"  | tr ' ' '\n' >tempfile && cryptsetup status `df -T ${AAPROOT} | cut -d ' ' -f 1 | tail -n 1 ` | grep -e '\(cipher\|keysize\)' | awk '{print $2}' | paste -s -d '-' | grep -f tempfile 1>/dev/null || echo "FAILED" && rm -f tempfile<br /><br />If the output is not 1, this is a finding.
        </div>
        <div class="span1">
          <h3>Fix</h3>
          As an administrator for each Automation Controller host, configure the Operating System to be FIPS enabled command:<br /><br />sudo fips-mode-setup --enable<br /><br />Reboot each system.<br /><br />Configure Ansible Automation Platform installation location to reside on a LUKS encrypted volume:<br /><br />Add a LUKS volume using default or other encrypted volume in accordance with organizationally defined policy. The '/var/lib/awx' filesystem must reside on this volume.<br /><br />Reinstall the Ansible Automation Platform. <br /><br />Note: The phrasing "Reinstall the Ansible Automation Platform." is applicable here; the installer cannot just be rerun on the same system.<br /><br />Reinstall the operating system on the Automation Controller server with FIPS mode enabled at install time by following the guidance located here:<br />https://access.redhat.com/solutions/5416081<br />OR <br />Enable FIPS mode without reinstalling the operating system by following the guidance located here:<br />https://access.redhat.com/solutions/137833<br /><br />If the operating system was reinstalled, reinstall Automation Controller by following the guidance located here:<br />https://docs.ansible.com/ansible-tower/latest/html/installandreference/index.html
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APAS-AT-000015">The Automation Controller management interface must display the Standard Mandatory DOD Notice and Consent Banner before granting access to the system.</h2>
    <p>
    <b><a href="#APAS-AT-000015">STIG ID</a>:</b>
      <a href="/products/appc_as/v1r2/APAS-AT-000015">APAS-AT-000015</a> |
      <b>CCI: </b>CCI-000048&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-APP-000068-AS-000035">SRG-APP-000068-AS-000035</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Automation Controller is required to display the Standard Mandatory DOD Notice and Consent Banner before granting access to the system management interface, providing privacy and security notices consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance that states that:<br /><br />(i) users are accessing a U.S. Government information system; <br />(ii) system usage may be monitored, recorded, and subject to audit; <br />(iii) unauthorized use of the system is prohibited and subject to criminal and civil penalties; and <br />(iv) the use of the system indicates consent to monitoring and recording.<br /><br />System use notification messages can be implemented in the form of warning banners displayed when individuals log on to the information system.<br /><br />System use notification is intended only for information system access including an interactive logon interface with a human user, and is not required when an interactive interface does not exist.<br /><br />Automation Controller supports displaying the Standard Mandatory DOD Notice and Consent Banner prior to logging in via the web console.<br /><br />Satisfies: SRG-APP-000068-AS-000035, SRG-APP-000069-AS-000036
        </div>
        <div class="span1">
          <h3>Check</h3>
          Navigate to the Automation Controller login page.<br /><br />Verify that the Standard Mandatory DOD Notice and Consent Banner is displayed with the following text:<br /><br />"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.<br /><br />By using this IS (which includes any device attached to this IS), you consent to the following conditions:<br /><br />-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.<br /><br />-At any time, the USG may inspect and seize data stored on this IS.<br /><br />-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.<br /><br />-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.<br /><br />-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details."<br /><br />If the required DOD banner is not displayed on the login page or the CUSTOM_LOGIN_INFO does not contain the correct text, this is a finding.<br /><br />Alternatively, verify the setting CUSTOM_LOGIN_INFO setting in the REST API at /api/v2/settings/ui by running the following command:<br /><br />curl https://<Automation Controller HOST>/api/v2/settings/ui
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Navigate to the Automation Controller web administrator console: <br /><br />Settings >> System >> User Interface settings.<br /><br />Click "Edit".<br /><br />In the Custom Login Info field, set the following text:<br /><br />"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.<br /><br />By using this IS (which includes any device attached to this IS), you consent to the following conditions:<br /><br />-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.<br /><br />-At any time, the USG may inspect and seize data stored on this IS.<br /><br />-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.<br /><br />-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.<br /><br />-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details." <br /><br />Click "Save".
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APAS-AT-000017">Automation Controller must use external log providers that can collect user activity logs in independent, protected repositories to prevent modification or repudiation.</h2>
    <p>
    <b><a href="#APAS-AT-000017">STIG ID</a>:</b>
      <a href="/products/appc_as/v1r2/APAS-AT-000017">APAS-AT-000017</a> |
      <b>CCI: </b>CCI-000139&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-APP-000080-AS-000045">SRG-APP-000080-AS-000045</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Automation Controller must be configured to use external logging to compile log records from multiple components within the server. The events occurring must be time-correlated in order to conduct accurate forensic analysis. In addition, the correlation must meet certain tolerance criteria. For instance, DOD may define that the time stamps of different logged events must not differ by any amount greater than ten seconds. Automation Controller must utilize an external logging tool that provides this capability.<br /><br />Satisfies: SRG-APP-000080-AS-000045, SRG-APP-000086-AS-000048, SRG-APP-000108-AS-000067, SRG-APP-000125-AS-000084, SRG-APP-000181-AS-000255, SRG-APP-000358-AS-000064, SRG-APP-000505-AS-000230, SRG-APP-000506-AS-000231, SRG-APP-000515-AS-000203
        </div>
        <div class="span1">
          <h3>Check</h3>
          Log in to Automation Controller as an administrator.<br /><br />Navigate to Settings >> System >> Logging setting.<br /><br />The following parameters must be set:<br /><br />Enable External Logging = On<br /><br />Logging Aggregator Level Threshold = DEBUG<br /><br />TCP Connection Timeout = 5 (default) or the organizational timeout<br /><br />Enable/disable HTTPS certificate verification = On<br /><br />Logging Aggregator <> (Default) "Not configured"<br /><br />If any of these settings are incorrect, this is a finding.
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Log in to Automation Controller as an administrator.<br /><br />Navigate to Settings >> System >> Logging setting.<br /><br />Click "Edit" and set the following fields:<br /><br />Enable External Logging = On<br /><br />Logging Aggregator Level Threshold = DEBUG<br /><br />TCP Connection Timeout = 5 (default) or the organizational timeout<br /><br />Enable/disable HTTPS certificate verification = On<br /><br />Logging Aggregator <> (Default) "Not configured"<br /><br />Click "Save".
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APAS-AT-000031">Automation Controller must allocate log record storage capacity and shut down by default upon log failure (unless availability is an overriding concern).</h2>
    <p>
    <b><a href="#APAS-AT-000031">STIG ID</a>:</b>
      <a href="/products/appc_as/v1r2/APAS-AT-000031">APAS-AT-000031</a> |
      <b>CCI: </b>CCI-000140&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-APP-000109-AS-000068">SRG-APP-000109-AS-000068</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          It is critical that when a system is at risk of failing to process logs, it detects and takes action to mitigate the failure. Log processing failures include software/hardware errors, failures in the log capturing mechanisms, and log storage capacity being reached or exceeded. During a failure, the application server must be configured to shut down unless the application server is part of a high availability system.<br /><br />When availability is an overriding concern, other approved actions in response to a log failure are as follows: <br /><br />(i) If the failure was caused by the lack of log record storage capacity, the application must continue generating log records if possible (automatically restarting the log service if necessary), overwriting the oldest log records in a first-in-first-out manner.<br /><br />(ii) If log records are sent to a centralized collection server and communication with this server is lost or the server fails, the application must queue log records locally until communication is restored or until the log records are retrieved manually. Upon restoration of the connection to the centralized collection server, action must be taken to synchronize the local log data with the collection server.<br /><br />Satisfies: SRG-APP-000109-AS-000068, SRG-APP-000357-AS-000038
        </div>
        <div class="span1">
          <h3>Check</h3>
          Administrator must check, for each Automation Controller host, the rsyslog configuration to verify the log rollover against an organizationally defined log capture size.<br /><br />Check LOG_AGGREGATOR_MAX_DISK_USAGE_GB field in the Automation Controller configuration.<br /><br />On the host, execute:<br /><br />awx-manage print_settings LOG_AGGREGATOR_MAX_DISK_USAGE_GB<br /><br />If this field is not set to the organizationally defined log capture size, this is a finding.<br /><br />Check LOG_AGGREGATOR_MAX_DISK_USAGE_PATH field in the Automation Controller configuration for the log file location to "/var/lib/awx".<br /><br />On the host, execute:<br />awx-manage print_settings LOG_AGGREGATOR_MAX_DISK_USAGE_PATH <br /><br />If this field is not set to "/var/lib/awx", this is a finding.
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Open a web browser and navigate to: https://<Automation Controller server>/api/v2/settings/logging/<br /><br />(If the "Log In" button is displayed, click it, enter an Automation Controller administrator's credentials, and continue.)<br /><br />In the Content section, modify the following values:<br /><br />LOG_AGGREGATOR_MAX_DISK_USAGE_GB  = organization-defined requirement for log buffering.<br /><br />LOG_AGGREGATOR_MAX_DISK_USAGE_PATH  = "/var/lib/awx"<br /><br />Click "PUT".
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APAS-AT-000032">Automation Controller must be configured to fail over to another system in the event of log subsystem failure.</h2>
    <p>
    <b><a href="#APAS-AT-000032">STIG ID</a>:</b>
      <a href="/products/appc_as/v1r2/APAS-AT-000032">APAS-AT-000032</a> |
      <b>CCI: </b>CCI-000140&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-APP-000109-AS-000070">SRG-APP-000109-AS-000070</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Automation Controller hosts must be capable of failing over to another Automation Controller host which can handle application and logging functions upon detection of an application log processing failure. This will allow continual operation of the application and logging functions while minimizing the loss of operation for the users and loss of log data.<br /><br />Satisfies: SRG-APP-000109-AS-000070, SRG-APP-000225-AS-000154, SRG-APP-000435-AS-000069
        </div>
        <div class="span1">
          <h3>Check</h3>
          The Administrator must check the Automation Controller is deployed in an HA configuration. <br /><br />Administrator must check Automation Controller host via the REST API at api/v2/ping/ HA field for HA configuration. <br /><br />If this field is not true, indicating Automation Controller is in an HA configuration, this is a finding.
        </div>
        <div class="span1">
          <h3>Fix</h3>
          If Automation Controller is not in an HA configuration, the administrator must reinstall Automation Controller.
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APAS-AT-000034">Automation Controller's log files must be accessible by explicitly defined privilege.</h2>
    <p>
    <b><a href="#APAS-AT-000034">STIG ID</a>:</b>
      <a href="/products/appc_as/v1r2/APAS-AT-000034">APAS-AT-000034</a> |
      <b>CCI: </b>CCI-000162&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-APP-000118-AS-000078">SRG-APP-000118-AS-000078</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          A failure of the confidentiality of Automation Controller log files would enable an attacker to identify key information about the system that they might not otherwise be able to obtain that would enable them to enumerate more information to enable escalation or lateral movement.<br /><br />Satisfies: SRG-APP-000118-AS-000078, SRG-APP-000119-AS-000079, SRG-APP-000120-AS-000080, SRG-APP-000121-AS-000081, SRG-APP-000122-AS-000082, SRG-APP-000123-AS-000083, SRG-APP-000267-AS-000170
        </div>
        <div class="span1">
          <h3>Check</h3>
          As an administrator, log into each Automation Controller host. Inspect the current permissions and owner of Automation Controller's NGINX log directory:<br />stat -c "%a %U %G" /var/log/nginx/ | grep "770 nginx root" || echo "FAILED"<br /><br />If "FAILED" is displayed, this is a finding.<br /><br />Inspect the current permissions and owner of Automation Controller's log directory:<br />$ stat -c "%a %U %G" /var/log/tower/ | grep "750 awx awx" || echo "FAILED"<br /><br />If "FAILED" is displayed, this is a finding.<br /><br />Inspect the current permissions and owner of Automation Controller's supervisor log directory:<br />stat -c "%a %U %G" /var/log/supervisor/ | grep "770 root root" || echo "FAILED"<br /><br />If "FAILED" is displayed, this is a finding.
        </div>
        <div class="span1">
          <h3>Fix</h3>
          As a system administrator for each Automation Controller host, set the permissions and owner of Automation Controller's NGINX log directory:<br />chmod 770 /var/log/nginx<br />chown nginx:root /var/log/nginx<br /><br />Set the permissions and owner of Automation Controller's log directory: <br />chmod 770 /var/log/tower<br />chown awx:awx /var/log/tower<br /><br />Set the permissions and owner of Automation Controller's supervisor log directory:<br />chmod 770 /var/log/supervisor/<br />chown root:root /var/log/supervisor/
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APAS-AT-000044">Automation Controller must be capable of reverting to the last known good configuration in the event of failed installations and upgrades.</h2>
    <p>
    <b><a href="#APAS-AT-000044">STIG ID</a>:</b>
      <a href="/products/appc_as/v1r2/APAS-AT-000044">APAS-AT-000044</a> |
      <b>CCI: </b>CCI-001499&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-APP-000133-AS-000093">SRG-APP-000133-AS-000093</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Any changes to the components of Automation Controller can have significant effects on the overall security of the system.<br /><br />In order to ensure a prompt response to failed application installations and application server upgrades, Automation Controller must provide an automated rollback capability that allows Automation Controller to be restored to a previous known good configuration state prior to the application installation or application server upgrade.
        </div>
        <div class="span1">
          <h3>Check</h3>
          The administrator must make a backup of the last known good configuration of the Automation Controller on each host.<br /><br />Locate the installer bundle directory that contains the inventory file used to install Ansible Automation Platform.<br /><br />Verify a backup of the last known good configuration has been made and stored in accordance with the Automation Controller Documentation and organizationally defined policy:<br />https://docs.ansible.com/automation-controller/latest/html/administration/backup_restore.html<br /><br />If no such backup has been made, this is a finding.
        </div>
        <div class="span1">
          <h3>Fix</h3>
          As System Administrator login to the Controller. Locate the installer bundle directory that contains the inventory file used to install Ansible Automation Platform. From there, run the setup.sh command with the "-b" option to perform a backup.<br /> Example: "[[installation directory]]/setup.sh -b"<br /><br />Note: To revert from a backup, refer to:<br />https://docs.ansible.com/automation-controller/latest/html/administration/backup_restore.html
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APAS-AT-000047">Automation Controller must be configured to use an enterprise user management system.</h2>
    <p>
    <b><a href="#APAS-AT-000047">STIG ID</a>:</b>
      <a href="/products/appc_as/v1r2/APAS-AT-000047">APAS-AT-000047</a> |
      <b>CCI: </b>CCI-000187&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-APP-000148-AS-000101">SRG-APP-000148-AS-000101</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Unauthenticated application servers render the organization subject to exploitation. Therefore, application servers must be uniquely identified and authenticated to prevent unauthorized access.<br /><br />Satisfies: SRG-APP-000148-AS-000101, SRG-APP-000149-AS-000102, SRG-APP-000151-AS-000103, SRG-APP-000177-AS-000126, SRG-APP-000389-AS-000253, SRG-APP-000390-AS-000254, SRG-APP-000391-AS-000239, SRG-APP-000392-AS-000240, SRG-APP-000400-AS-000246, SRG-APP-000401-AS-000243, SRG-APP-000402-AS-000247, SRG-APP-000403-AS-000248, SRG-APP-000404-AS-000249, SRG-APP-000405-AS-000250
        </div>
        <div class="span1">
          <h3>Check</h3>
          The Administrator must check the Automation Controller web administrator console and verify the appropriate authentication provider is configured and the associated fields are complete and accurate.<br /><br />Log in to Automation Controller as an administrator and navigate to Settings >> Authentication.<br /><br />If the organization-defined identity provider is not configured, or any associated fields are incomplete or inaccurate, this is a finding.
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Log in to Automation Controller as an administrator and navigate to Settings >> Authentication.<br /><br />Configure the appropriate authentication provider and associated fields for the organization-defined identity provider:<br /><br />Click on LDAP settings.<br /><br />Click "Edit".<br /><br />Configure/complete the fields.<br /><br />Click "Save".
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APAS-AT-000050">Automation Controller must be configured to authenticate users individually, prior to using a group authenticator.</h2>
    <p>
    <b><a href="#APAS-AT-000050">STIG ID</a>:</b>
      <a href="/products/appc_as/v1r2/APAS-AT-000050">APAS-AT-000050</a> |
      <b>CCI: </b>CCI-000770&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-APP-000153-AS-000104">SRG-APP-000153-AS-000104</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Default superuser accounts, such as "root", are considered group authenticators. In the case of Automation Controller this is the "admin" account.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Log in to the Automation Controller web console as an administrator and navigate to Access >> Users.<br /><br />The only local user allowed is the default/breakglass "admin". All other users need to come from an external authentication source. If any other local users exist, this is a finding.
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Log in to the Automation Controller web console as an administrator and navigate to Access >> Users.<br /><br />Click the Username to be removed.<br /><br />Select "Delete" and confirm.
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APAS-AT-000055">Automation Controller must utilize encryption when using LDAP for authentication.</h2>
    <p>
    <b><a href="#APAS-AT-000055">STIG ID</a>:</b>
      <a href="/products/appc_as/v1r2/APAS-AT-000055">APAS-AT-000055</a> |
      <b>CCI: </b>CCI-000197&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-APP-000172-AS-000121">SRG-APP-000172-AS-000121</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          To avoid access with malicious intent, passwords will need to be protected at all times. This includes transmission where passwords must be encrypted for security.
        </div>
        <div class="span1">
          <h3>Check</h3>
          Log in to Automation Controller as an administrator and navigate to Settings >> Authentication >> LDAP settings.<br /><br />If an LDAP server is configured but the "LDAP SERVER URI" field does not start with "ldaps://", this is a finding.
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Log in to Automation Controller as an administrator and navigate to Settings >> Authentication >> LDAP settings.<br /><br />Click "Edit".<br /><br />Modify the "LDAP SERVER URI" field so that it begins with "ldaps://".<br /><br />Click "Save".
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APAS-AT-000078">Automation Controller must use cryptographic mechanisms to protect the integrity of log tools.</h2>
    <p>
    <b><a href="#APAS-AT-000078">STIG ID</a>:</b>
      <a href="/products/appc_as/v1r2/APAS-AT-000078">APAS-AT-000078</a> |
      <b>CCI: </b>CCI-001496&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-APP-000290-AS-000174">SRG-APP-000290-AS-000174</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Protecting the integrity of the tools used for logging purposes is a critical step in ensuring the integrity of log data. Log data includes all information (e.g., log records, log settings, and log reports) needed to successfully log information system activity.<br /><br />It is not uncommon for attackers to replace the log tools or inject code into the existing tools for the purpose of providing the capability to hide or erase system activity from the logs.<br /><br />To address this risk, log tools must be cryptographically signed in order to provide the capability to identify when the log tools have been modified, manipulated, or replaced. An example is a checksum hash of the file or files.<br /><br />Automation Controller server log tools must use cryptographic mechanisms to protect the integrity of the tools or allow cryptographic protection mechanisms to be applied to their tools.
        </div>
        <div class="span1">
          <h3>Check</h3>
          As an administrator, log in to each Automation Controller host.<br /><br />Verify the correct Red Hat RPM signing key is available on each host by listing the keys using the following command:<br /><br />rpm -qa gpg-pubkey*<br /><br />Manually inspect against publicly listed keys on https://www.redhat.com. If the keys do not match, this is a finding.<br /><br />Import the key using the following command:<br /><br />rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release<br /><br />Verify the signatures of installed RPMs necessary for Automation Controller:<br /><br />For RPM in $(rpm -qa); do rpm -K --nosignature ${RPM} | grep "NOT OK" && return 1; done ; echo "FAILED"<br /><br />If this outputs "FAILED", this is a finding.
        </div>
        <div class="span1">
          <h3>Fix</h3>
          The administrator must reinstall all Automation Controller hosts and Automation Controller.
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APAS-AT-000093">Automation Controller must compare internal application server clocks at least every 24 hours with an authoritative time source.</h2>
    <p>
    <b><a href="#APAS-AT-000093">STIG ID</a>:</b>
      <a href="/products/appc_as/v1r2/APAS-AT-000093">APAS-AT-000093</a> |
      <b>CCI: </b>CCI-001891&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-APP-000371-AS-000077">SRG-APP-000371-AS-000077</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          When conducting forensic analysis and investigating system events, it is critical that timestamps accurately reflect the time of application events. If timestamps are not deemed to be accurate, the integrity of the forensic analysis and the associated determinations are at stake. This leaves the organization and the system vulnerable to intrusions.<br /><br />Satisfies: SRG-APP-000371-AS-000077, SRG-APP-000372-AS-000212
        </div>
        <div class="span1">
          <h3>Check</h3>
          As a system administrator for each Automation Controller host, ensure the NTP client is configured to synchronize to an organizationally defined NTP server:<br /><br />chronyc sources<br /><br />If the Automation Controller host is not configured to use an organizationally defined NTP server, this is a finding.<br /><br />Ensure the NTP time synchronization is operational:<br /><br />chronyc activity | head -n 1 | grep "200 OK" >/dev/null || echo "FAILED"<br />sudo systemctl is-active chrony > /dev/null|| echo "FAILED"<br /><br />If "FAILED" is displayed, this is a finding.
        </div>
        <div class="span1">
          <h3>Fix</h3>
          As a system administrator, for each Automation Controller host, configure the NTP client to synchronize to an organizationally defined NTP server:<br /><br />vi /etc/chrony.conf<br /><br />Restart the Automation Controller host:<br /><br />$ shutdown -r
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APAS-AT-000110">Automation Controller must only allow the use of DOD PKI-established certificate authorities for verification of the establishment of protected sessions.</h2>
    <p>
    <b><a href="#APAS-AT-000110">STIG ID</a>:</b>
      <a href="/products/appc_as/v1r2/APAS-AT-000110">APAS-AT-000110</a> |
      <b>CCI: </b>CCI-002450&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-APP-000427-AS-000264">SRG-APP-000427-AS-000264</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          An untrusted source may leave the system vulnerable to issues such as unauthorized access, reduced data integrity, loss of confidentiality, etc.<br /><br />Satisfies: SRG-APP-000427-AS-000264, SRG-APP-000514-AS-000137
        </div>
        <div class="span1">
          <h3>Check</h3>
          The Administrator must check the Automation Controller configuration. <br /><br />Download the latest DOD PKI CA certificate bundle:<br /><br />curl https://dl.dod.cyber.mil/wp-content/uploads/pki-pke/zip/certificates_pkcs7_DOD.zip > /root/certificates_pkcs7_DOD.zip && gunzip /root/certificates_pkcs7_DOD.zip<br /><br />Check the certificate at /etc/tower/tower.cert:<br /><br />openssl verify -verbose -x509_strict -CAfile /root/certificates_pkcs7_DOD.pem -CApath nosuchdir <(cat  /etc/tower/tower.cert >><organizationally defined intermediate certificate file in PEM format>>>)<br /><br />If the >><organizationally defined intermediate certificate file in PEM format>>> does not exist, this is a finding.<br /><br />Check the certificate at /etc/tower/tower.key:<br />openssl verify -CAfile /root/certificates_pkcs7_DOD.pem /etc/tower/tower.cert  <br /><br />If the >><organizationally defined intermediate certificate file in PEM format>>> does not exist, this is a finding.<br /><br />Check the trusted ca certificate:<br /><br />openssl x509 -in /etc/pki/ca-trust/tls-ca-bundle.pam custom_ca_cert<br /><br />If the >><organizationally defined intermediate certificate file in PEM format>>> does not exist, this is a finding.<br /><br />If the >><organizationally defined intermediate certificate file in PEM format>>> does not exist, this is a finding.
        </div>
        <div class="span1">
          <h3>Fix</h3>
          For each Automation Controller host, the administrator must:<br /><br />Download the >><organizationally defined intermediate certificate file in PEM format>>>;<br /><br />Generate the appropriate /etc/tower/tower.key files, certificates, and CSRs and have the organizationally defined PKI authority issue a certificate signed by the >><organizationally defined intermediate certificate file in PEM format>>>;<br /><br />Place the signed certificate in /etc/tower/tower.cert.<br /><br />Place the >><organizationally defined intermediate certificate file in PEM format>>> in /etc/pki/ca-trust/source/anchors.<br /><br />Execute:<br />update-ca-trust extract && update-ca-trust;<br /><br />Download the latest DOD PKI CA certificate bundle:<br /><br />curl https://dl.dod.cyber.mil/wp-content/uploads/pki-pke/zip/certificates_pkcs7_DOD.zip > /root/certificates_pkcs7_DOD.z && gunzip /root/certificates_pkcs7_DOD.z > /etc/pki/ca-trust/source/anchors<br /><br />Install trusted root and intermediate CA certificates:<br /><br />update-ca-trust extract && update-ca-trust;
        </div>
      </div>
    </div>
  
    <hr>
    <h2 id="APAS-AT-000122">Automation Controller must install security-relevant software updates within the time period directed by an authoritative source (e.g. IAVM, CTOs, DTMs, and STIGs).</h2>
    <p>
    <b><a href="#APAS-AT-000122">STIG ID</a>:</b>
      <a href="/products/appc_as/v1r2/APAS-AT-000122">APAS-AT-000122</a> |
      <b>CCI: </b>CCI-002605&nbsp;|&nbsp;
      <b>SRG: </b><a href="/srgs/SRG-APP-000456-AS-000266">SRG-APP-000456-AS-000266</a> |
      <b>Severity: </b>medium
    </p>
    <div class="container-fluid">
      <div class="row">
        <div class="span1">
          <h3>Vulnerability Discussion</h3>
          Security relevant software updates must be installed within the timeframes directed by an authoritative source in order to maintain the integrity and confidentiality of the system and its organizational assets.
        </div>
        <div class="span1">
          <h3>Check</h3>
          As a system administrator for each Automation Controller host inspect the status of the DNF Automatic timer:<br /><br />systemctl status dnf-automatic.timer<br /><br />If "Active: active" is not included in the output, this is a finding.<br /><br />Inspect the configuration of DNF Automatic:<br /><br /> grep apply_updates /etc/dnf/automatic.conf<br /><br />If "apply_updates = yes" is not displayed, this is a finding.
        </div>
        <div class="span1">
          <h3>Fix</h3>
          Install and enable DNF Automatic:<br /><br />dnf install dnf-automatic<br />(run the install)<br />systemctl enable --now dnf-automatic.timer<br /><br />Modify /etc/dnf/automatic.conf and set "apply_updates = yes".
        </div>
      </div>
    </div>
  

</div>
<div class="footer">
  <hr/>
  This website is not created by, run, approved, or endorsed by the U.S. Department of Defense.
  Use at your own risk. This website is created by
  <a href="https://github.com/Mab879/stigaview-static" target="_blank">open-source</a> software.
</div>
</body>
</html>