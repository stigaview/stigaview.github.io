<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="x-ua-compatible" content="ie=edge"/>
  <title>APAS-AT-000034 - V1R1 - STIG-A-View</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Online STIG viewer"/>
  <meta name="generator" content="STIG-A-View Static - d33aec4"/>
  <link href="/static/css/style.css" rel="stylesheet" />
  <link href="/favicon.png" rel="shortcut icon" />
</head>
<body>
<nav class="navbar">
  <a class="navbar-brand" href="/">STIG-A-View</a>
  <ul>
    <li><a href="/">Home</a></li>
    <li><a class="nav-link" href="/stigs">STIGs</a></li>
    <li><a class="nav-link" href="/products">Products</a></li>
  </ul>
</nav>
<div class="container">

  <h2>Automation Controller's log files must be accessible by explicitly defined privilege.</h2>
  <p>
  <b>STIG ID:</b> APAS-AT-000034 &nbsp;|&nbsp;
  <b>SRG: </b><a href="/srgs/SRG-APP-000118-AS-000078">SRG-APP-000118-AS-000078</a>&nbsp;|&nbsp;
  <b>Severity: </b>medium&nbsp;|&nbsp;
  <b>CCI: </b>CCI-000162,CCI-000163,CCI-000164,CCI-001314,CCI-001493,CCI-001494,CCI-001495&nbsp;|&nbsp;
  <b>Vulnerability Id:</b> V-256903&nbsp;|&nbsp;
  </p>
  <div class="container-fluid">
   <div class="row">
     <div class="span1">
       <h3>Vulnerability Discussion</h3>
       A failure of the confidentiality of Automation Controller log files would enable an attacker to identify key information about the system that they might not otherwise be able to obtain that would enable them to enumerate more information to enable escalation or lateral movement.<br /><br />Satisfies: SRG-APP-000118-AS-000078, SRG-APP-000119-AS-000079, SRG-APP-000120-AS-000080, SRG-APP-000121-AS-000081, SRG-APP-000122-AS-000082, SRG-APP-000123-AS-000083, SRG-APP-000267-AS-000170
     </div>
     <div class="span1">
       <h3>Check</h3>
       As an administrator, log into each Automation Controller host. Inspect the current permissions and owner of Automation Controller's NGINX log directory:<br />stat -c "%a %U %G" /var/log/nginx/ | grep "770 nginx root" || echo "FAILED"<br /><br />If "FAILED" is displayed, this is a finding.<br /><br />Inspect the current permissions and owner of Automation Controller's log directory:<br />$ stat -c "%a %U %G" /var/log/tower/ | grep "750 awx awx" || echo "FAILED"<br /><br />If "FAILED" is displayed, this is a finding.<br /><br />Inspect the current permissions and owner of Automation Controller's supervisor log directory:<br />stat -c "%a %U %G" /var/log/supervisor/ | grep "770 root root" || echo "FAILED"<br /><br />If "FAILED" is displayed, this is a finding.
     </div>
     <div class="span1">
       <h3>Fix</h3>
       As a system administrator for each Automation Controller host, set the permissions and owner of Automation Controller's NGINX log directory:<br />chmod 770 /var/log/nginx<br />chown nginx:root /var/log/nginx<br /><br />Set the permissions and owner of Automation Controller's log directory: <br />chmod 770 /var/log/tower<br />chown awx:awx /var/log/tower<br /><br />Set the permissions and owner of Automation Controller's supervisor log directory:<br />chmod 770 /var/log/supervisor/<br />chown root:root /var/log/supervisor/
     </div>
   </div>
  </div>

</div>
<div class="footer">
  <hr/>
  This website is not created by, run, approved, or endorsed by the U.S. Department of Defense.
  Use at your own risk. This website is created by
  <a href="https://github.com/Mab879/stigaview-static" target="_blank">open-source</a> software.
</div>
</body>
</html>