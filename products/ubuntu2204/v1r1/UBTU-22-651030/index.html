<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="x-ua-compatible" content="ie=edge"/>
  <title>UBTU-22-651030 - V1R1 - STIG-A-View</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Online STIG viewer"/>
  <meta name="generator" content="STIG-A-View Static - f5b54a5"/>
  <link href="/static/css/style.css" rel="stylesheet" />
  <link href="/favicon.png" rel="shortcut icon" />
</head>
<body>
<nav class="navbar">
  <a class="navbar-brand" href="/">STIG-A-View</a>
  <ul>
    <li><a href="/">Home</a></li>
    <li><a class="nav-link" href="/stigs">STIGs</a></li>
    <li><a class="nav-link" href="/products">Products</a></li>
  </ul>
</nav>
<div class="container">

  <h2>Ubuntu 22.04 LTS must use cryptographic mechanisms to protect the integrity of audit tools.</h2>
  <p>
  <b>STIG ID:</b> UBTU-22-651030 &nbsp;|&nbsp;
  <b>SRG: </b><a href="/srgs/SRG-OS-000278-GPOS-00108">SRG-OS-000278-GPOS-00108</a>&nbsp;|&nbsp;
  <b>Severity: </b>medium&nbsp;|&nbsp;
  <b>CCI: </b>CCI-001496&nbsp;|&nbsp;
  <b>Vulnerability Id:</b> V-260586&nbsp;|&nbsp;
  </p>
  <div class="container-fluid">
   <div class="row">
     <div class="span1">
       <h3>Vulnerability Discussion</h3>
       Protecting the integrity of the tools used for auditing purposes is a critical step toward ensuring the integrity of audit information. Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.  <br />  <br />Audit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.  <br />  <br />It is not uncommon for attackers to replace the audit tools or inject code into the existing tools with the purpose of providing the capability to hide or erase system activity from the audit logs.  <br />  <br />To address this risk, audit tools must be cryptographically signed in order to provide the capability to identify when the audit tools have been modified, manipulated, or replaced. An example is a checksum hash of the file or files.
     </div>
     <div class="span1">
       <h3>Check</h3>
       Verify that Advanced Intrusion Detection Environment (AIDE) is properly configured to use cryptographic mechanisms to protect the integrity of audit tools by using the following command:  <br />  <br />     $ grep -E '(\/sbin\/(audit|au))' /etc/aide/aide.conf <br />     /sbin/auditctl p+i+n+u+g+s+b+acl+xattrs+sha512  <br />     /sbin/auditd p+i+n+u+g+s+b+acl+xattrs+sha512  <br />     /sbin/ausearch p+i+n+u+g+s+b+acl+xattrs+sha512  <br />     /sbin/aureport p+i+n+u+g+s+b+acl+xattrs+sha512  <br />     /sbin/autrace p+i+n+u+g+s+b+acl+xattrs+sha512  <br />     /sbin/audispd p+i+n+u+g+s+b+acl+xattrs+sha512  <br />     /sbin/augenrules p+i+n+u+g+s+b+acl+xattrs+sha512  <br />  <br />If any of the seven lines do not appear as shown, are commented out, or are missing, this is a finding.
     </div>
     <div class="span1">
       <h3>Fix</h3>
       Configure AIDE to protect the integrity of audit tools: <br /> <br />Add or modify the following lines in the "/etc/aide/aide.conf" file: <br /> <br /># Audit Tools  <br />/sbin/auditctl p+i+n+u+g+s+b+acl+xattrs+sha512  <br />/sbin/auditd p+i+n+u+g+s+b+acl+xattrs+sha512  <br />/sbin/ausearch p+i+n+u+g+s+b+acl+xattrs+sha512  <br />/sbin/aureport p+i+n+u+g+s+b+acl+xattrs+sha512  <br />/sbin/autrace p+i+n+u+g+s+b+acl+xattrs+sha512  <br />/sbin/audispd p+i+n+u+g+s+b+acl+xattrs+sha512  <br />/sbin/augenrules p+i+n+u+g+s+b+acl+xattrs+sha512
     </div>
   </div>
  </div>

</div>
<div class="footer">
  <hr/>
  This website is not created by, run, approved, or endorsed by the U.S. Department of Defense.
  Use at your own risk. This website is created by
  <a href="https://github.com/Mab879/stigaview-static" target="_blank">open-source</a> software.
</div>
</body>
</html>